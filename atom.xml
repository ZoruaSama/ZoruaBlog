<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Zorua&#39;s Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://zoruasama.gitee.io/"/>
  <updated>2021-11-14T10:21:12.942Z</updated>
  <id>https://zoruasama.gitee.io/</id>
  
  <author>
    <name>Zorua</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>算法笔记 | 差分数组</title>
    <link href="https://zoruasama.gitee.io/2021/11/14/algorithm_1/"/>
    <id>https://zoruasama.gitee.io/2021/11/14/algorithm_1/</id>
    <published>2021-11-14T11:05:00.000Z</published>
    <updated>2021-11-14T10:21:12.942Z</updated>
    
    <content type="html"><![CDATA[<h1 id="定义"><a class="markdownIt-Anchor" href="#定义"></a> 定义</h1><p>对于一个数组<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">n</span><span class="mclose">]</span></span></span></span>，如果对它有着频繁的区间操作（例如第5个到第60个数增加2，或第6个到第40个数减去2）。这个时候，暴力的做法时，直接用循环去操作，但是这样做的时间复杂度很大。所以对于这样的问题，可以使用<strong>差分数组</strong>。</p><h1 id="具体做法"><a class="markdownIt-Anchor" href="#具体做法"></a> 具体做法</h1><p><code>差分</code>其实就是数据之间的差，什么数据的差呢？就是上面所给的原始数组<code>a[n]</code>的相邻元素之间的差值，我们令<code>d[i]=a[i+1]-a[i]</code>，一遍for循环即可将差分数组求出来。例如下面这个数组。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20211114164848.PNG" alt="" /><br />据此，可以发现两条差分数组的性质：</p><ul><li><code>a[i]</code>等于<code>d[i]</code>的前缀和</li><li><code>a[i]</code>的前缀和可以通过如下公式来求得：<ul><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>u</mi><msub><mi>m</mi><mi>x</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>x</mi></msubsup><msub><mi>a</mi><mi>x</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>x</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>i</mi></msubsup><msub><mi>d</mi><mi>i</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>x</mi></msubsup><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>×</mo><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">sum_x=\sum_{i=1}^{x}a_x=\sum_{i=1}^{x}\sum_{j=1}^{i}d_i=\sum_{i=1}^{x}(x-i+1)\times d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.400382em;vertical-align:-0.43581800000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.964564em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li></ul></li></ul><h1 id="用途"><a class="markdownIt-Anchor" href="#用途"></a> 用途</h1><p>差分数组主要支持两种操作：<strong>1、区间修改；2、单点查询</strong><br />根据性质一，可以得到若对某个区间<code>[L, R]</code> 增加一个数 <code>x</code>，只需要使 <code>d[L] += x; d[R + 1] -= x;</code> 即可实现对区间的批量修改，而查询时只需要<strong>求前缀和查询单个元素</strong>，或者通过上述性质二的公式查询<strong>前缀和/区间和</strong>即可</p><h2 id="区间修改"><a class="markdownIt-Anchor" href="#区间修改"></a> 区间修改</h2><p>对上面那个表的数组作下面两个操作：</p><ul><li>将区间 [1,4] 的数值全部加上3</li><li>将区间 [3,5] 的数值全部减去5<br />其实<strong>当你将原始数组中元素同时加上或者减掉某个数，那么他们的差分数组其实是不会变化的。</strong><br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20211114170247.PNG" alt="" /><br />只有 d[1]和d[5]发生了变化，而d[2],d[3],d[4]却保持着原样。</li></ul><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20211114170311.PNG" alt="" /></p><blockquote><p>当对一个区间进行增减某个值的时候，它的差分数组对应的区间左端点的值会同步变化，而它的右端点的后一个值则会相反地变化，其实这个很好理解</p></blockquote><h2 id="更新原数组"><a class="markdownIt-Anchor" href="#更新原数组"></a> 更新原数组</h2><p>因为我们的差分数组是由原始数组的相邻两项作差求出来的，即 d[i]=a[i]-a[i-1]；那么我们能不能反过来，求得一下修改过后的a[i]呢？</p><p><strong>直接反过来即得  a[i]=a[i-1]+d[i]</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">    a[i]=a[i<span class="number">-1</span>]+d[i];</span><br></pre></td></tr></table></figure><h1 id="参考资料"><a class="markdownIt-Anchor" href="#参考资料"></a> 参考资料</h1><p>[1] <a href="https://blog.csdn.net/qq_31601743/article/details/105352885" target="_blank" rel="noopener">https://blog.csdn.net/qq_31601743/article/details/105352885</a><br />[2] <a href="https://blog.csdn.net/qq_44786250/article/details/100056975" target="_blank" rel="noopener">https://blog.csdn.net/qq_44786250/article/details/100056975</a><br />[3] <a href="https://www.jianshu.com/p/2a4e861b44ae" target="_blank" rel="noopener">https://www.jianshu.com/p/2a4e861b44ae</a><br />[4] <a href="https://www.cnblogs.com/COLIN-LIGHTNING/p/8436624.html" target="_blank" rel="noopener">https://www.cnblogs.com/COLIN-LIGHTNING/p/8436624.html</a></p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/zoruasama/zoruasama.github.io@latest/css/mindmap.css">]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;定义&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#定义&quot;&gt;&lt;/a&gt; 定义&lt;/h1&gt;
&lt;p&gt;对于一个数组&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;m
      
    
    </summary>
    
    
      <category term="算法" scheme="https://zoruasama.gitee.io/categories/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="算法" scheme="https://zoruasama.gitee.io/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="差分数组" scheme="https://zoruasama.gitee.io/tags/%E5%B7%AE%E5%88%86%E6%95%B0%E7%BB%84/"/>
    
  </entry>
  
  <entry>
    <title>算法笔记 | 前缀和</title>
    <link href="https://zoruasama.gitee.io/2021/11/11/algorithm_0/"/>
    <id>https://zoruasama.gitee.io/2021/11/11/algorithm_0/</id>
    <published>2021-11-11T11:05:00.000Z</published>
    <updated>2021-11-11T11:15:04.955Z</updated>
    
    <content type="html"><![CDATA[<h1 id="定义"><a class="markdownIt-Anchor" href="#定义"></a> 定义</h1><p>给定某个数组 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">n</span><span class="mclose">]</span></span></span></span>，给定区间<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l,r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>，计算这个数组，从下标<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span></span>到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span></span>的加和。如果直接加和，需要作<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>r</mi><mo>−</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(r-l+1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>次加法。如果有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>次询问，复杂度就是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nm)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span>。引入<strong>前缀和数组</strong><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">s[n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault">n</span><span class="mclose">]</span></span></span></span>，可以将复杂度降到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo>+</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(m+n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>。</p><h1 id="具体做法"><a class="markdownIt-Anchor" href="#具体做法"></a> 具体做法</h1><h2 id="预处理"><a class="markdownIt-Anchor" href="#预处理"></a> 预处理</h2><p>定义一个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">s[n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault">n</span><span class="mclose">]</span></span></span></span>数组，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">s[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span>表示<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">n</span><span class="mclose">]</span></span></span></span>数组中前<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>项之和。</p><blockquote><p>就和数组<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><msub><mi>a</mi><mi>n</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{a_n\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>的前<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>项和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">S_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>一样。</p></blockquote><p>先用一次<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mi>o</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">for</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span></span>循环，对<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">s[n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault">n</span><span class="mclose">]</span></span></span></span>进行预处理。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">  s[i]=s[i<span class="number">-1</span>]+a[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>此过程复杂度为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>。</p><h2 id="查询"><a class="markdownIt-Anchor" href="#查询"></a> 查询</h2><p>对于每次查询，只需执行<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo><mo>−</mo><mi>s</mi><mo stretchy="false">[</mo><mi>l</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">s[r]-s[l-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>，时间复杂度为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>。</p><blockquote><p><strong>原理</strong><br />s[r] =a[1]+a[2]+a[3]+a[l-1]+a[l]+a[l+1]…a[r];<br />s[l-1]=a[1]+a[2]+a[3]+a[l-1];<br />s[r]-s[l-1]=a[l]+a[l+1]+…+a[r];</p></blockquote><p>此过程复杂度为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span>。</p><h1 id="二维前缀和"><a class="markdownIt-Anchor" href="#二维前缀和"></a> 二维前缀和</h1><p>输入一个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n\times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>的整数矩阵，再输入<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span>个询问，每个询问包含四个整数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mn>1</mn><mo separator="true">,</mo><mi>y</mi><mn>1</mn><mo separator="true">,</mo><mi>x</mi><mn>2</mn><mo separator="true">,</mo><mi>y</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">x1, y1, x2, y2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">x</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">x</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">2</span></span></span></span>，表示一个子矩阵的左上角坐标和右下角坐标。对于每个询问输出子矩阵中所有数的和。</p><p>同一维前缀和一样，先定义一个二维数组<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">s[n][m]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault">n</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault">m</span><span class="mclose">]</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">s[i][j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span>，表示二维数组中，左上角<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>到右下角<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">( i,j )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>所包围的矩阵元素的和。<br />接下来推导二维前缀和的公式。</p><h2 id="预处理-2"><a class="markdownIt-Anchor" href="#预处理-2"></a> 预处理</h2><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20211111165631.png" alt="" /></p><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20211111165825.png" alt="" /><br />注：最后一项是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[i][j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span>，和一维前缀和一样。<br />由上图可知，二维前缀和的预处理公式为：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s[i][j] = s[i<span class="number">-1</span>][j] + s[i][j<span class="number">-1</span>] + a[i][j] - s[i<span class="number">-1</span>][j<span class="number">-1</span>];</span><br></pre></td></tr></table></figure><hr /><p>也可以一维、一维来求进行预处理。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)</span><br><span class="line">        a[i][j] += a[i - <span class="number">1</span>][j];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)</span><br><span class="line">        a[i][j] += a[i][j - <span class="number">1</span>];</span><br></pre></td></tr></table></figure><h2 id="查询-2"><a class="markdownIt-Anchor" href="#查询-2"></a> 查询</h2><p>接下来如何去求以<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mn>1</mn><mo separator="true">,</mo><mi>y</mi><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x1,y1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>为左上角和以<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mn>2</mn><mo separator="true">,</mo><mi>y</mi><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x2,y2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">2</span><span class="mclose">)</span></span></span></span>为右下角的矩阵的元素的和呢？<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20211111170341.png" alt="" /><br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20211111170439.png" alt="" /><br />即<code>s[x2][y2]-s[x1-1][y2]-s[x2][y1-1] + s[x1-1][y1-1]</code></p><h1 id="高维前缀和"><a class="markdownIt-Anchor" href="#高维前缀和"></a> 高维前缀和</h1><p>暂时还看不懂这玩意儿……。先mark一下。<br /><a href="https://www.cnblogs.com/heyuhhh/p/11585358.html" target="_blank" rel="noopener">https://www.cnblogs.com/heyuhhh/p/11585358.html</a></p><h1 id="参考资料"><a class="markdownIt-Anchor" href="#参考资料"></a> 参考资料</h1><p>[1] <a href="https://blog.csdn.net/weixin_45629285/article/details/111146240" target="_blank" rel="noopener">https://blog.csdn.net/weixin_45629285/article/details/111146240</a></p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/zoruasama/zoruasama.github.io@latest/css/mindmap.css">]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;定义&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#定义&quot;&gt;&lt;/a&gt; 定义&lt;/h1&gt;
&lt;p&gt;给定某个数组 &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;
      
    
    </summary>
    
    
      <category term="算法" scheme="https://zoruasama.gitee.io/categories/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="算法" scheme="https://zoruasama.gitee.io/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="前缀和" scheme="https://zoruasama.gitee.io/tags/%E5%89%8D%E7%BC%80%E5%92%8C/"/>
    
  </entry>
  
  <entry>
    <title>Works | 标签夹 Tab Clamp</title>
    <link href="https://zoruasama.gitee.io/2021/10/26/TabClamp/"/>
    <id>https://zoruasama.gitee.io/2021/10/26/TabClamp/</id>
    <published>2021-10-26T11:30:00.000Z</published>
    <updated>2021-10-26T07:41:28.206Z</updated>
    
    <content type="html"><![CDATA[<h1 id="标签夹-tabclamp-是什么"><a class="markdownIt-Anchor" href="#标签夹-tabclamp-是什么"></a> 标签夹 TabClamp 是什么</h1><p>试想您是否有这样的一个需求？</p><blockquote><p>有时候进行某项工作/学习时打开了若干个网页，但是后来中断去做别的事情了，在下一次进行这项工作/学习时又要回到历史记录里一个个点开。这样非常麻烦。</p></blockquote><p>「标签夹 TabClamp」就是为了解决这样的需求而被开发的。它是一款用于<strong>任一基于Chromium开源项目webkit内核的浏览器</strong>插件，这款插件可以帮助您一次性打开多个网页，以方便您随时恢复之前的工作环境。</p><p>如果您不知道您的浏览器是否是<strong>基于Chromium开源项目webkit内核</strong>的，您可以参考下面这个列表：</p><ul><li>Google Chrome</li><li>Microsoft Edge</li><li>360安全浏览器</li><li>360极速浏览器</li><li>搜狗高速浏览器</li><li>QQ浏览器</li><li>猎豹安全浏览器</li><li>傲游浏览器</li><li>……</li></ul><h1 id="安装教程"><a class="markdownIt-Anchor" href="#安装教程"></a> 安装教程</h1><h1 id="使用说明"><a class="markdownIt-Anchor" href="#使用说明"></a> 使用说明</h1><h2 id="名词术语解释"><a class="markdownIt-Anchor" href="#名词术语解释"></a> 名词术语解释</h2><ul><li><strong>标签 Tabs</strong>，准确称法是“标签页”，也称作“选项卡”，简称为“标签”。通常标签页栏所处的是浏览器窗体的上方，您可以通过点击标签来切换当前要浏览的网页。</li><li><strong>窗体 Windows</strong>，您运行浏览器时打开的整个浏览器程序界面被称作窗体，您可以打开多个窗体，也可以在每个窗体上打开多个标签。</li><li><strong>标签夹 Tab Clamp</strong>，即本插件的名称，亦是本插件中引入的概念。顾名思义地，标签夹是将复数数量的标签打包在一起后的物体。</li></ul><h2 id="界面功能解释"><a class="markdownIt-Anchor" href="#界面功能解释"></a> 界面功能解释</h2><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20211026142613.png" alt="" /></p><h3 id="保存当前所有标签页到标签夹"><a class="markdownIt-Anchor" href="#保存当前所有标签页到标签夹"></a> 保存当前所有标签页到标签夹</h3><ol><li>输入标签夹名字，注意不要和已有的标签夹名字重复，否则会直接覆盖内容。虽然没有对标签夹名字长度进行限制，但是仍然不建议使用过长的标签夹名字。</li><li>点击“保存当前所有标签页到标签夹”按钮，将会保存<strong>当前浏览器上打开的所有标签</strong>到指定标签夹中。由于后续的“打开”功能是一次性全部打开并加载网页，出于对您的机器性能负担考虑，一个标签夹内最好不要放过多的标签。</li></ol><h3 id="打开该标签夹内所有的标签"><a class="markdownIt-Anchor" href="#打开该标签夹内所有的标签"></a> 打开该标签夹内所有的标签</h3><ol><li>输入标签夹名字，注意应该输入已有的标签夹。</li><li>点击“打开该标签夹内所有的标签”按钮，将会在<strong>当前浏览器窗口上</strong>打开该标签夹内的所有网页。</li></ol><h3 id="删除该标签夹"><a class="markdownIt-Anchor" href="#删除该标签夹"></a> 删除该标签夹</h3><ol><li>输入标签夹名字，注意应该输入已有的标签夹。</li><li>点击“删除该标签夹”按钮，将会<strong>永久删除</strong>该标签夹和该标签夹下所有的标签。</li></ol><h3 id="点击标签夹"><a class="markdownIt-Anchor" href="#点击标签夹"></a> 点击标签夹</h3><ol><li>当您已经拥有标签夹时，界面上将会显示其按钮。按钮文本为标签夹名字，括号内部数字表示标签夹内的标签数量。</li><li>单击这些标签夹按钮，将会在下方显示该标签夹内的标签，您可以点击这些标签，就能打开指定的单个标签页。</li><li>单击标签夹按钮后，标签夹名字会自动输入到输入框中，而不需要自己手动输入，方便您的后续操作（例如保存、打开、删除）。</li></ol><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20211026144533.png" alt="" /></p><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20211026144549.png" alt="" /></p><h1 id="环境要求"><a class="markdownIt-Anchor" href="#环境要求"></a> 环境要求</h1><p>本插件使用了localStorage特性作为存储，</p><h1 id="版本更新日志"><a class="markdownIt-Anchor" href="#版本更新日志"></a> 版本更新日志</h1><h2 id="10020211026"><a class="markdownIt-Anchor" href="#10020211026"></a> 1.0.0(2021/10/26)</h2><ul><li>产品上线</li></ul><h1 id="打赏"><a class="markdownIt-Anchor" href="#打赏"></a> 打赏</h1><p>如果您对这个小插件满意的话，您可以通过下面两种方式给予任意金额的打赏鼓励嗷~~。非常感谢您请我的一杯咖啡~。<br />感谢少侠打赏，来杯咖啡提提神，大战到天亮。</p><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20211026152954.png" alt="" /></p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/zoruasama/zoruasama.github.io@latest/css/mindmap.css">]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;标签夹-tabclamp-是什么&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#标签夹-tabclamp-是什么&quot;&gt;&lt;/a&gt; 标签夹 TabClamp 是什么&lt;/h1&gt;
&lt;p&gt;试想您是否有这样的一个需求？&lt;/p&gt;
&lt;blockquote
      
    
    </summary>
    
    
      <category term="Works" scheme="https://zoruasama.gitee.io/categories/Works/"/>
    
    
      <category term="Works" scheme="https://zoruasama.gitee.io/tags/Works/"/>
    
      <category term="效率" scheme="https://zoruasama.gitee.io/tags/%E6%95%88%E7%8E%87/"/>
    
      <category term="浏览器" scheme="https://zoruasama.gitee.io/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>书读 | 初读东野圭吾《白夜行》</title>
    <link href="https://zoruasama.gitee.io/2021/06/14/reading_0/"/>
    <id>https://zoruasama.gitee.io/2021/06/14/reading_0/</id>
    <published>2021-06-14T12:19:00.000Z</published>
    <updated>2021-10-26T08:47:47.164Z</updated>
    
    <content type="html"><![CDATA[<div class="snote bug"><p>本文可能含一定程度的剧透，提前浏览可能会影响阅读体验。</p></div><p>熟悉东野圭吾的朋友必定知道作为其代表作之一的《白夜行》，一直以来我都很喜爱阅读东野圭吾的作品，但是大学期间好像很容易浮躁，很难沉下心去阅读。终于在百无聊赖（忙里偷闲）的时候，捧起兼有阅读功能的Kindle牌泡面盖，开始阅读起来。</p><p>在读《白夜行》前，在高中有读过其姊妹篇《幻夜》。到底说是姊妹篇，作者写作风格和角色人设隐隐约约间总有些相似。<br />整篇小说叙事的不同人物视角的分镜手法，黑色系、老到辛辣的语言，含蓄深刻的内容。</p><p>雪穗和美冬很像，亮司也和雅也很像。</p><p>不过阅读《幻夜》的时候到今天已经有两三个年头了，不少故事里的情节我都几乎忘得一干二净，所以应该不会在这篇随笔里提到什么了。</p><p>阅读这本书，总共花了四天时间（2021/06/10~2021/06/13）。读得很快，囫囵吞枣，有一些地方可能说得不对，请书友海涵。此外，故事想表达的内容的确有些晦涩难懂，看完书的我五味杂陈，有很多话想说，但凭我拙劣的语言，恐怕难以说清其中一二。</p><p>先简要介绍书中故事吧，当然毕竟这不是在写小说，我会用全知视角来说明这个故事内容。不想看剧透的，可以直接往下找到另一条剧透分割线。</p><p>首先有两个家庭，桐原亮司和西本雪穗。</p><p>桐原亮司家里是开当铺的，父母似乎都没有尽其教育责任。母亲和当铺店员有染。</p><p>西本雪穗家庭贫苦，父亲早逝，母亲独自抚养其长大，但在当时的历史背景，其生活并不乐观。</p><p>他们打小起，就很要好的样子。会一起去图书馆看书（比如：《飘》）、剪纸（是桐原亮司的强项）。</p><p>似乎是，生活所迫之下，西本雪穗的母亲将西本雪穗卖给了有恋童癖的桐原亮司的父亲。</p><p>桐原亮司偶然之下看到了正在对西本雪穗实施猥亵行为的父亲，在愤怒和绝望之下，11岁的他用剪刀杀死了父亲。</p><p>这个案子由于各种原因，没有被立马查明。作为故事的线索一直延续了20年。</p><p>后来，西本雪穗伪造了其母亲自杀的情形，同样地，这个案子也成了悬案。在生母离世后，她被她的表亲唐泽礼子收养，唐泽礼子教会了她茶道和插花等等非常修身养性的知识，使得旁人眼中的西本雪穗有如一个优雅的名门大小姐。</p><p>接下来的亮司和雪穗，像是两个没有交点的平行线，一个就读大学，一个辍学干着各种勾当。但在背地里，他们在互相帮助。</p><p>例如，雪穗嫉妒另一个长相漂亮的女同学，而且女同学在散播雪穗过去的事情。于是，亮司帮助雪穗制造了该女同学被强暴了的假象，令其一丝不挂地昏在路边，然后雪穗按预先的安排假装发现并救助了她。雪穗对她说，会帮她保守这个秘密的，以此来收买这个女同学的心。</p><p>另一方面，亮司在做盗版游戏、软件时，雪穗通过她的社会关系偷到了不少知名人士的程序传给了亮司。</p><p>雪穗注意到有私家侦探在追查她，亮司帮她杀害了那个侦探。</p><p>这样的犯罪数不胜数。</p><p>亮司帮着雪穗除掉了一个又一个她成功路上的障碍，她如愿以偿地娶到了第一任丈夫，攀上了豪门。利用更高的社会关系，不断地积累财富。</p><p>开了一家奢侈的衣服精品店：R&amp;Y。</p><p>后来又故意与第一任丈夫吵架离婚，加上亮司的暗中协助，攀上第二任名门贵族丈夫。</p><p>R&amp;Y开了一家又一家分店。</p><p>雪穗在旁人的眼里就是年轻有为、长相漂亮端庄、做生意强势果断的女强人形象。</p><p>但是二十年前的刑警一直在追查那个案件，即使那个案件已经快过了时效期。他始终认为这个女人可没有表面上那么简单，眼神中隐藏着难以察觉的险恶和卑劣。</p><p>在R&amp;Y第三家分店的开张仪式上，刑警敏锐地判断亮司一定会出现。</p><p>亮司果然出现了，并且奋力逃避追捕，但终究是无力回天。</p><p>为了自己不被抓捕而暴露雪穗，他选择从楼上跃下然后用那把剪刀自尽。</p><p>刑警问雪穗：你认识这个人吗？</p><p>雪穗说：我不认识。然后头也不回地离开了。</p><p>正义不仅迟到了，而且没有发挥出它的力量。两人犯下这么多的罪行，因为亮司的牺牲式自尽，并没有大白于天下。他们的邪恶仍然在世间嚣张，在精品店的招牌上闪烁。</p><p>雪穗成功地获得了人生的幸福。从灰姑娘变成了大有可为的女青年。</p><p>======== 剧透线 ========<br />看完这本书，我心情沉重又复杂，非常矛盾。</p><p>既觉得亮司和雪穗之间是有爱情的，又觉得雪穗是个无情的女性，对亮司也是像对其他男人利用罢了。</p><p>既替他们的爱情悲剧感到惋惜，又觉得他们犯下了太多罪行活该。</p><p>他们俩之间有爱情吗？好像是没有的，整篇作品里，长大后的雪穗和亮司几乎没在小说里直接见过面，唯一一次见面就是最后一章的生死永隔，而且雪穗望着亮司的尸体，说着不认识便永远回了头。</p><p>他们俩之间有爱情吗？又好像是有的，雪穗累积财富后，开了一家店，名字叫R&amp;Y，是亮司和雪穗两个人名字的缩写。为了能过上幸福的生活，他们相辅相成，如果警方再迟一些，案件有效期就过了，他们俩就能永远走在白天下了。虽然亮司和雪穗有着各自的恋人，但是与他们似乎是有性无爱。</p><p>雪穗说：我的天空里没有太阳，总是黑夜，但并不黑暗，因为有东西代替了太阳。虽然没有太阳那么明亮，但对我来说已经足够。凭借着这份光，我便能把黑夜当成白天。你明白吗？我从来就没有太阳，所以不怕失去。</p><p>她的太阳就是桐原亮司。亮司的愿望是在白天（一起）走路（书的封面是亮司的剪纸作品之一，小男孩和小女孩一起牵着手走路）。</p><p>年仅十一岁的亮司从一出场就走上了一条永远黑暗的不归之路，只能永远期期指望“等到有一天，能够和她手牵手去阳光下散步”；为了这个希望，他一路为恶，直到长大成人，大开杀戒……</p><p>说到底，他们的恶终究或许来源于家庭的不幸。</p><p>东野圭吾太鲨了，在我心里留下了难以抹去的压抑和阴影……</p><p>甚至都有些恐恋了。现实生活中也总会有像这样，容貌出众、透露着聪慧、气质优雅、全身上下散发出温柔的光芒，但藏着不少难以察觉的险恶卑劣的人吧。</p><p>当遇上现实生活中的雪穗，我到底会是自我牺牲也要帮助她的亮司、盲目地被她的表象所吸引的康晴还是察觉到她的险恶的一成呢……？</p><p>那我当然不希望遇上雪穗。</p><p>因为她的背影犹如白色的幽灵。</p><h2 id="想到什么再补充什么吧"><a class="markdownIt-Anchor" href="#想到什么再补充什么吧"></a> 想到什么再补充什么吧。</h2><p>原来这句话出自这里呀。<br />曾经拥有的东西被夺走，并不代表就会回到原来没有那种东西的时候。——东野圭吾《白夜行》<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20211026163516.jpg" alt="" /></p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/zoruasama/zoruasama.github.io@latest/css/mindmap.css">]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;snote bug&quot;&gt;&lt;p&gt;本文可能含一定程度的剧透，提前浏览可能会影响阅读体验。&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;熟悉东野圭吾的朋友必定知道作为其代表作之一的《白夜行》，一直以来我都很喜爱阅读东野圭吾的作品，但是大学期间好像很容易浮躁，很难沉下心去阅读。终于在
      
    
    </summary>
    
    
      <category term="书读" scheme="https://zoruasama.gitee.io/categories/%E4%B9%A6%E8%AF%BB/"/>
    
    
      <category term="书读" scheme="https://zoruasama.gitee.io/tags/%E4%B9%A6%E8%AF%BB/"/>
    
      <category term="读后感" scheme="https://zoruasama.gitee.io/tags/%E8%AF%BB%E5%90%8E%E6%84%9F/"/>
    
  </entry>
  
  <entry>
    <title>题解心得 | P3379 【模板】最近公共祖先（LCA）</title>
    <link href="https://zoruasama.gitee.io/2021/01/21/P3379/"/>
    <id>https://zoruasama.gitee.io/2021/01/21/P3379/</id>
    <published>2021-01-21T11:30:00.000Z</published>
    <updated>2021-01-21T11:38:24.116Z</updated>
    
    <content type="html"><![CDATA[<h1 id="题面原文"><a class="markdownIt-Anchor" href="#题面原文"></a> 题面原文</h1><p><a href="https://www.luogu.com.cn/problem/P3379" target="_blank" rel="noopener">原题链接</a></p><h2 id="题目描述"><a class="markdownIt-Anchor" href="#题目描述"></a> 题目描述</h2><p>如题，给定一棵有根多叉树，请求出指定两个点直接最近的公共祖先。</p><h2 id="输入格式"><a class="markdownIt-Anchor" href="#输入格式"></a> 输入格式</h2><p>第一行包含三个正整数 N,M，分别表示树的结点个数、询问的个数和树根结点的序号。<br />接下来 N-1 行每行包含两个正整数 x, y，表示 x 结点和 y 结点之间有一条直接连接的边（数据保证可以构成树）。<br />接下来 M行每行包含两个正整数 a, b表示询问 a 结点和 b 结点的最近公共祖先。</p><h2 id="输出格式"><a class="markdownIt-Anchor" href="#输出格式"></a> 输出格式</h2><p>输出包含 M 行，每行包含一个正整数，依次为每一个询问的结果。</p><h1 id="ac-record"><a class="markdownIt-Anchor" href="#ac-record"></a> Ac Record</h1><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201205213926.png" alt="" /></p><h1 id="code"><a class="markdownIt-Anchor" href="#code"></a> Code</h1><details cyan open><summary> <p>show me the code.</p> </summary>              <div class='content'>              <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">500001</span>;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; node[maxn];</span><br><span class="line"><span class="keyword">int</span> dep[maxn];</span><br><span class="line"><span class="keyword">int</span> f[maxn][<span class="number">22</span>]; <span class="comment">//2^20</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> log2(x&amp;(-x));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> fa,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">    dep[u]=d;</span><br><span class="line">    f[u][<span class="number">0</span>]=fa;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;node[u].size();++i)&#123;</span><br><span class="line">        <span class="keyword">if</span>(node[u][i]==fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(node[u][i],u,d+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(dep[x]&lt;dep[y]) swap(x,y);</span><br><span class="line">    <span class="keyword">while</span>(dep[x]&gt;dep[y])&#123;</span><br><span class="line">        x=f[x][lowbit(dep[x]-dep[y])];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(x==y) <span class="keyword">return</span> x;<span class="comment">// or return y.</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=log2(dep[x]);i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(f[x][i]!=f[y][i])&#123;</span><br><span class="line">            x=f[x][i];</span><br><span class="line">            y=f[y][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> c=(<span class="keyword">char</span>)getchar();</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,fs=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c))&#123;<span class="keyword">if</span>(c==<span class="string">'-'</span>)fs=<span class="number">-1</span>;c=(<span class="keyword">char</span>)getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(c))x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(c^<span class="number">48</span>),c=(<span class="keyword">char</span>)getchar(); <span class="comment">//NOLINT</span></span><br><span class="line">    <span class="keyword">return</span> x*fs;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a&lt;<span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">'-'</span>),a=-a;</span><br><span class="line">    <span class="keyword">if</span>(a&gt;=<span class="number">10</span>)write(a/<span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(a%<span class="number">10</span>+<span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n,m,s;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m&gt;&gt;s;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)&#123;</span><br><span class="line">        <span class="keyword">int</span> x,y;</span><br><span class="line">        x=read();</span><br><span class="line">        y=read();</span><br><span class="line">        node[x].push_back(y);</span><br><span class="line">        node[y].push_back(x);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(s,s,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;<span class="number">22</span>;++i)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> u=<span class="number">1</span>;u&lt;=n;u++)&#123;</span><br><span class="line">            f[u][i]=f[f[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)&#123;</span><br><span class="line">        <span class="keyword">int</span> x,y;</span><br><span class="line">        x=read();</span><br><span class="line">        y=read();</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;lca(x,y)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><h1 id="思路"><a class="markdownIt-Anchor" href="#思路"></a> 思路</h1><p>这就是一道LCA模板题。</p><ul><li>简单地用vector存图。</li><li>先用DFS把整个树遍历一遍，标记上每个节点的<strong>深度</strong>。这个深度的作用会在后面的算法体现到。</li><li><code>f[u][i]=f[f[u][i-1]][i-1];</code>这是<strong>倍增</strong>的递推式。<ul><li><code>f[u][i]</code>指的是，节点<code>u</code>的前<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">2^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.824664em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span>个父节点。</li><li>例如<code>f[u][0]</code>指的是就是节点<code>u</code>的父节点。<code>f[u][1]</code>指的是就是节点<code>u</code>的父节点的父节点。<code>f[u][2]</code>指的是就是节点<code>u</code>的父节点的父节点的父节点的父节点。</li><li>在这个题目中的节点数最多是500000，所以最坏情况下是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>19</mn></msup></mrow><annotation encoding="application/x-tex">2^{19}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">9</span></span></span></span></span></span></span></span></span></span></span></span>，所以数组开到20就差不多够用了。（为保险可以多开一点）</li></ul></li><li>用LCA函数求解答案。</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(dep[x]&lt;dep[y]) swap(x,y);</span><br><span class="line">    <span class="keyword">while</span>(dep[x]&gt;dep[y])&#123;</span><br><span class="line">        x=f[x][lowbit(dep[x]-dep[y])];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(x==y) <span class="keyword">return</span> x;<span class="comment">// or return y.</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=log2(dep[x]);i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(f[x][i]!=f[y][i])&#123;</span><br><span class="line">            x=f[x][i];</span><br><span class="line">            y=f[y][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>先将两个节点移动至同一深度。<ul><li>这个操作可以通过不断使更深的节点变为它的父节点就行了。</li><li>为了快速移动，通过<strong>倍增</strong>来实现。</li></ul></li><li>如果移动至同一深度，两个节点变成同一节点了，那么就可以返回了。</li><li>如果不是同一节点，那么就再<strong>同时移动两个节点</strong>（变为它们的父节点），直至最后一个节点的下一层节点。</li><li>这个时候返回这层节点的父节点即为答案。</li></ul><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/zoruasama/zoruasama.github.io@latest/css/mindmap.css">]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;题面原文&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#题面原文&quot;&gt;&lt;/a&gt; 题面原文&lt;/h1&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.com.cn/problem/P3379&quot; target=&quot;_blank&quot; r
      
    
    </summary>
    
    
      <category term="算法" scheme="https://zoruasama.gitee.io/categories/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="算法" scheme="https://zoruasama.gitee.io/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="LCA" scheme="https://zoruasama.gitee.io/tags/LCA/"/>
    
  </entry>
  
  <entry>
    <title>正则表达式 | 初入茅庐[0-9]+</title>
    <link href="https://zoruasama.gitee.io/2020/09/26/regexp_0/"/>
    <id>https://zoruasama.gitee.io/2020/09/26/regexp_0/</id>
    <published>2020-09-26T03:51:02.000Z</published>
    <updated>2020-09-26T15:34:25.701Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css"><h1 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h1><p>正则表达式描述了一种字符串匹配的模式是怎么回事呢？正则表达式相信大家都很熟悉，但是正则表达式描述了一种字符串匹配的模式是怎么回事呢，下面就让小编带大家一起了解吧。</p><p>正则表达式描述了一种字符串匹配的模式，其实就是正则表达式可以用来匹配字符串，大家可能会很惊讶正则表达式怎么会描述了一种字符串匹配的模式呢？但事实就是这样，小编也感到非常惊讶。</p><p>这就是关于正则表达式描述了一种字符串匹配的模式的事情了，大家有什么想法呢，欢迎在评论区告诉小编一起讨论哦！【大雾】</p><h1 id="是什么"><a class="markdownIt-Anchor" href="#是什么"></a> 是什么</h1><p>在阐述我自己的理解前，先搬出<a href="https://baike.baidu.com/item/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/1700215?fr=aladdin" target="_blank" rel="noopener">百度百科</a>的内容撑撑场面。</p><div class="snote quote"><p class="p subtitle">度娘百科</p><p><b>正则表达式</b>，又称规则表达式。（英语：Regular Expression，在代码中常简写为regex、regexp或RE），计算机科学的一个概念。正则表达式通常被用来检索、替换那些符合某个模式(规则)的文本。</p></div><blockquote><p>正则表达式是对字符串操作的一种逻辑公式，就是用事先定义好的一些特定字符、及这些特定字符的组合，组成一个“规则字符串”，这个“规则字符串”用来表达对字符串的一种过滤逻辑。</p></blockquote><blockquote><p>正则表达式是对字符串（包括普通字符（例如，a 到 z 之间的字母）和特殊字符（称为“元字符”））操作的一种逻辑公式，就是用事先定义好的一些特定字符、及这些特定字符的组合，组成一个“规则字符串”，这个“规则字符串”用来表达对字符串的一种过滤逻辑。正则表达式是一种文本模式，该模式描述在搜索文本时要匹配的一个或多个字符串。</p></blockquote><blockquote><p>给定一个正则表达式和另一个字符串，我们可以达到如下的目的：</p><ol><li>给定的字符串是否符合正则表达式的过滤逻辑（称作“匹配”）</li><li>可以通过正则表达式，从字符串中获取我们想要的特定部分。</li></ol></blockquote><p>从上面三段内容可以看到，关键词<strong>检索、过滤、匹配</strong>。而这些工作让我想到了 <code>?</code> <code>*</code>。<br />我相信大多数人对 <code>?</code> <code>*</code>的作用应该不陌生。在Word文档中，<code>?</code>用于匹配单一字符，<code>*</code>用于匹配多个字符。</p><p>例如下面这个例子。我在编辑这篇文章时，发现我居然蠢到把每一个<strong>正则表达式</strong>都打错了。只有<strong>第一个字</strong>和<strong>最后一个字</strong>是正确的。</p><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200423223525.png" alt="" /></p><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200423223654.png" alt="" /></p><p>于是我果断地按下了 <code>Ctrl</code> <code>H</code>，勾选了使用通配符。由于<strong>第一个字</strong>和<strong>最后一个字</strong>是正确的，因此查找的内容只需为<code>正*式</code>即可检索到所有错误的<strong>正则表达式</strong>文本。然后点击<strong>全部替换</strong>。便轻松愉快地全部修正了。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200423223902.png" alt="" /></p><p>或许这时候你要问了。就这？就这？就这？<s>怎么可能会有sabi犯这种错误啊</s>这玩意儿有什么用？<br />嗐。您可别着急。如果说<strong>正则表达式</strong>并不是这种简单的<code>?</code>和<code>*</code>呢？</p><hr /><h1 id="快速上手"><a class="markdownIt-Anchor" href="#快速上手"></a> 快速上手</h1><h2 id="最简单的匹配情况"><a class="markdownIt-Anchor" href="#最简单的匹配情况"></a> 最简单的匹配情况</h2><p>最简单的匹配情况相当容易想到，即表达式本身等同于要匹配的表达式。例如使用<code>China</code>匹配下面的文本。就会匹配到下面两个<code>China</code>子字符串。</p><p>I love <span class="inline-tag red">China</span>. Long live <span class="inline-tag red">China</span>!</p><h2 id="简单的几个符号"><a class="markdownIt-Anchor" href="#简单的几个符号"></a> 简单的几个符号</h2><p>再来介绍几个简单的符号，引用我本学期的「编译原理」课程PPT中的一张图片。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200923230150.png" alt="" /></p><h3 id="选项-choice-among-alternatives"><a class="markdownIt-Anchor" href="#选项-choice-among-alternatives"></a> 选项 Choice among alternatives</h3><p>令<code>r</code>和<code>s</code>是两个正则表达式，那么<code>r|s</code>既可以匹配<code>r</code>能匹配的字符串，也能匹配<code>s</code>能匹配的字符串。<br />例如使用正则表达式<code>China|Long</code>就能匹配到三个子字符串了。</p><p>I love <span class="inline-tag red">China</span>. <span class="inline-tag red">Long</span> live <span class="inline-tag red">China</span>!<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200926211645.png" alt="" /></p><h3 id="连接-concatenation"><a class="markdownIt-Anchor" href="#连接-concatenation"></a> 连接 Concatenation</h3><p>连接<strong>没有符号</strong>，直接把一个正则表达式与另一个正则表达式相连即可。<br />例如之前举过的例子<code>China</code>能够匹配字符串中的<code>China</code>子串。这里是五个字符直接相连的正则表达式。<br />又例如，<code>(a|b)c</code>，能够匹配字符串 <code>ac</code>或<code>bc</code>。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200926211619.png" alt="" /></p><h3 id="重复-repetition"><a class="markdownIt-Anchor" href="#重复-repetition"></a> 重复 Repetition</h3><p>重复也被称作是<strong>闭包(closure)</strong>，用符号<code>*</code>表示，其内涵是<strong>可以把<code>*</code>所作用的表达式重复0次或多次</strong>。<br />注意，作用的表达式是<code>*</code>前的字符串，如果没有打括号的话，就只有一个字符。<br />例如<code>a*</code>能够匹配<strong>空字符串</strong>、<code>a</code>、<code>aa</code>、<code>aaa</code>等等。<br />再例如对于正则表达式<code>(a|bb)*</code>，能够匹配<strong>空字符串</strong>，<code>a</code>，<code>bb</code>，<code>aa</code>，<code>abb</code>，<code>bba</code>，<code>bbbb</code>，<code>aaa</code>，<code>aabbbba</code>，<code>abbabbabbbba</code>等等。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200926211425.png" alt="" /></p><h2 id="更多符号"><a class="markdownIt-Anchor" href="#更多符号"></a> 更多符号</h2><h3 id="熟悉的老朋友通配符"><a class="markdownIt-Anchor" href="#熟悉的老朋友通配符"></a> 熟悉的老朋友通配符 .</h3><p>这里的<code>.</code>的作用等同于我在<strong>是什么</strong>那一节中举例的Word软件中的<code>?</code>。<br />它可以匹配一个除了换行符以外的字符。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200926211912.png" alt="" /></p><h3 id="加号"><a class="markdownIt-Anchor" href="#加号"></a> 加号 +</h3><p>和重复<code>*</code>类似，不过加号是匹配子表达式<strong>一次或多次</strong>。<br /><code>zo(rua)+</code>能够匹配<code>zorua</code>，<code>zoruarua</code>，<code>zoruaruarua</code>等等。但是不能匹配<code>zo</code>。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200926211347.png" alt="" /></p><h3 id="问号"><a class="markdownIt-Anchor" href="#问号"></a> 问号 ?</h3><p>还是和重复<code>*</code>类似，不过问号是匹配子表达式<strong>0次或一次</strong>。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200926212040.png" alt="" /></p><h3 id="字符集合"><a class="markdownIt-Anchor" href="#字符集合"></a> 字符集合 [  ]</h3><p>匹配所包含的任意一个字符。例如，<code>[abc]</code> 可以匹配<code>plain</code>中的<code>a</code>。<code>[a-z]</code>表示一个范围，可以匹配二十六个字母。<br /><code>[a-cf-l]</code>表示字母的<code>a</code>到<code>c</code>，然后<code>f</code>到<code>l</code>。也可以使用数字<code>[0-9]</code><br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200926231016.png" alt="" /></p><h4 id="否定符号"><a class="markdownIt-Anchor" href="#否定符号"></a> 否定符号 ^</h4><p><code>[^xyz]</code>是对<code>[xyz]</code>的否定，即匹配除去<code>xyz</code>三个字母后的其他字符。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200926231300.png" alt="" /></p><h3 id="匹配次数大括号"><a class="markdownIt-Anchor" href="#匹配次数大括号"></a> 匹配次数大括号 {  }</h3><p>大括号内填写一个非负整数。<br />代表前面的表达式应该被匹配的次数。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200926231822.png" alt="" /></p><h4 id="限制下限"><a class="markdownIt-Anchor" href="#限制下限"></a> 限制下限</h4><p>如果填写为<code>{n,}</code>的形式，则可以匹配<code>n</code>次以上。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200926231914.png" alt="" /></p><h4 id="限制下限上限"><a class="markdownIt-Anchor" href="#限制下限上限"></a> 限制下限上限</h4><p>如果填写为<code>{n,m}</code>的形式，则可以匹配<code>n</code>次以上，最多<code>m</code>次。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200926232001.png" alt="" /></p><h2 id="转义符号"><a class="markdownIt-Anchor" href="#转义符号"></a> 转义符号</h2><p><code>\</code>将下一个字符标记为一个<strong>特殊字符</strong>、或一个<strong>原义字符</strong>、或一个 <strong>向后引用</strong>、或一个<strong>八进制转义符</strong>。例如，‘n’ 匹配字符 “n”。’\n’ 匹配一个换行符。序列 <code>\\</code> 匹配 <code>\</code> 而 <code>\(</code> 则匹配 <code>(</code>。</p><p>转义符号的设计使得一些难以输入的字符可以被匹配，或已被使用的字符(例如问号<code>?</code>被在正则表达式里被认为是0,1次匹配。)<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200926231557.png" alt="" /></p><h1 id="在线测试正则表达式"><a class="markdownIt-Anchor" href="#在线测试正则表达式"></a> 在线测试正则表达式</h1><p>除了可以在程序内调试正则表达式外，也可以使用在线的一些工具测试正则表达式。例如下面的几个网站。</p><ul><li><a href="https://c.runoob.com/front-end/854" target="_blank" rel="noopener">菜鸟工具 - 正则表达式在线测试</a></li><li><a href="http://tool.chinaz.com/regex/" target="_blank" rel="noopener">站长工具 - 正则表达式在线测试</a></li><li><a href="https://www.w3cschool.cn/tools/index?name=reg" target="_blank" rel="noopener">w3school 在线正则表达式测试</a></li></ul><h1 id="写在最后"><a class="markdownIt-Anchor" href="#写在最后"></a> 写在最后</h1><p>关于正则表达式的内容还有很多，一篇文章难以详尽。日后如果有时间，我会再次学习。<br />在本篇文章中，多处参考了我的朋友Kooer的博文，在此表示对他衷心感谢。<br />您可以在<a href="https://dooerlly.github.io/2020/09/22/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" target="_blank" rel="noopener">这个链接</a>看到他的博文。</p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/zoruasama/zoruasama.github.io@latest/css/mindmap.css">]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; href=&quot;https://use.fontawesome.com/releases/v5.0.13/css/all.css&quot;&gt;
&lt;h1 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;
      
    
    </summary>
    
    
      <category term="其他" scheme="https://zoruasama.gitee.io/categories/%E5%85%B6%E4%BB%96/"/>
    
    
      <category term="正则表达式" scheme="https://zoruasama.gitee.io/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>数据库原理 | 一些填空题的摘录</title>
    <link href="https://zoruasama.gitee.io/2020/09/11/database_x/"/>
    <id>https://zoruasama.gitee.io/2020/09/11/database_x/</id>
    <published>2020-09-11T03:51:02.000Z</published>
    <updated>2020-09-11T08:37:09.972Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css"><h1 id="关于"><a class="markdownIt-Anchor" href="#关于"></a> 关于</h1><p>本文档由Zorua自行整理，如果有错误请在评论区反馈，或投递邮件至zoruasama@qq.com。<br />文档采用<code>CC BY-NC-ND 4.0许可协议</code>。转载本文档请保留本文档地址。<br />(?)如果您对此留有任何疑问，可以访问<a href="https://zh.wikipedia.org/wiki/%E5%89%B5%E4%BD%9C%E5%85%B1%E7%94%A8%E6%8E%88%E6%AC%8A%E6%A2%9D%E6%AC%BE" target="_blank" rel="noopener">知识共享许可协议</a>以获取帮助。</p><h1 id="正文"><a class="markdownIt-Anchor" href="#正文"></a> 正文</h1><ol><li>数据管理技术经历了<strong>人工管理、文件系统、数据库管理</strong>三个阶段。</li><li>数据库系统中常用的三种模型有<strong>层次模型、网状模型、关系模型</strong>。</li><li>数据模型的三要素包括<strong>数据结构、数据操纵或操作、数据的完整性约束</strong>。</li><li>实体之间的联系可抽象为三类，它们是<strong>一对一、一对多、多对多</strong>。</li><li>在数据库设计中，<strong>数据字典</strong>是系统中各类数据描述的集合，是进行详细的数据收集和数据分析所获得的主要成果。</li><li>数据库系统一般由<strong>数据库、数据库应用系统、数据库管理系统、数据库管理员</strong>和用户构成。</li><li>数据库系统在运行过程中，可能会发生故障。故障主要有<strong>事务故障、系统故障、介质故障和计算机病毒</strong>四类。</li><li>并发控制的主要方法是采用<strong>封锁</strong>机制，其类型有<strong>共享锁</strong>和<strong>排它锁</strong>两种。</li><li>数据库的完整性是指数据的<strong>正确性</strong>和<strong>相容性</strong>。</li><li>在SQL语言中，为了数据库的安全性，设置了对数据的存取进行控制的语句，对用户授权使用<strong>GRANT</strong>语句，收回所授的权限使用<strong>REVOKE</strong>语句。</li><li><strong>数据库</strong>是长期存储在计算机内的、有组织、可共享的数据集合。</li><li>数据库系统的三级模式结构是指数据库系统是由<strong>模式</strong>、<strong>外模式</strong>、<strong>内模式</strong>三级构成的。</li><li>E-R图一般在数据库设计的<strong>概念结构设计</strong>阶段使用。</li><li><strong>事务</strong>是用户定义的一个数据库操作序列，是一个不可分割的工作单位，它具有<strong>原子性</strong>、<strong>一致性</strong>、<strong>隔离性</strong>、<strong>持续性</strong>四个特性。</li><li>数据库系统中，系统故障通常称为<strong>软故障</strong>，介质故障称为<strong>硬故障</strong>。</li><li>关系操作的特点是<strong>集合</strong>操作。</li><li>若事务T对数据对象A加了S锁，则其他事务只能对数据A再加<strong>S</strong>锁，不能加<strong>X</strong>锁，直到事务T释放A上的锁。</li><li>现实世界进行第一层抽象的模型，称为<strong>概念</strong>模型；对现实世界进行第二层抽象的模型，称为<strong>数据</strong>模型。</li><li>在数据库技术中，编写应用程序的语言仍然是C—类高级语言，这些语言被称为<strong>宿主语言或主语言</strong>。</li><li>层次、网状的DML属于<strong>过程性</strong>语言，而关系型DML属于<strong>非过程性</strong>语言。</li><li>关系模式的操作异常问题往往是由<strong>数据冗余</strong>引起的。</li><li>恢复的基本原则是<strong>冗余</strong>。要使数据库具有可恢复性，在平时要做好两件事：<strong>转储</strong>备份和<strong>记“日志”</strong>。</li><li>如果对数据库的并发操作不加以控制，则会带来的问题：<strong>丢失更新</strong>、<strong>读“脏数据”<strong>和</strong>不可重复读</strong>。</li><li>事务的执行次序称为<strong>调度</strong>。</li><li>判断一个并发调度是否正确，可以用<strong>可串行化</strong>概念来解决。</li><li>封锁能避免错误的发生，但会引起<strong>活锁和死锁</strong>问题。</li><li>S封锁增加了并发度，但缺点是<strong>容易发生死锁</strong>。</li><li>两段式封锁是可串行化的<strong>充分</strong>条件。</li><li>SQL中的安全性机制，主要有两个：<strong>视图</strong>和<strong>授权</strong>。</li><li>数据库的基本特点是<strong>数据可以共享</strong>或<strong>数据结构化、数据独立性、数据冗余度小，易扩充、统一管理和控制</strong>。</li><li>数据库技术中采取分级方法将数据库的结构划分成多个层次，是为了提高数据库的<strong>逻辑独立性</strong>和<strong>物理独立性</strong>。</li><li>数据库是长期存储在计算机内，有<strong>组织</strong>的，可<strong>共享</strong>的数据集合</li><li>现实世界的事物反映到人的头脑中经过思维加工是数据，这一过程要经历三个领域，依次是<strong>现实世界</strong>，<strong>信息世界</strong>和<strong>计算机世界</strong>。</li><li>关系数据库规范化是为解决关系数据库中<strong>插入、删除和数据冗余</strong>问题而引入的。</li><li>关系规范中的删除操作异常是指<strong>不该删除的数据被删除</strong>，插入操作异常是指<strong>应该插入的数据未被插入</strong>。</li><li>设计性能较优的关系模式称为规范化，规范化主要的理论依据是<strong>关系规范化理论</strong>。</li><li>规范化理论是关系数据库进行逻辑设计的理论依据。根据这个理论，关系数据库中的关系必须满足：其每一属性都是<strong>不可分解的</strong>。</li><li>关系模型是把实体之间的联系用<strong>二维表格</strong>表示。</li><li>在关系数据库中，当关系的类型改变时，用户程序也可以不变，这是<strong>数据的逻辑独立性</strong>。</li><li>当数据库的存储结构改变时，可相应修改<strong>模式/内模式映像</strong>，从而保持模式不变。</li><li>在数据库系统的三级模式体系结构中，描述数据在数据库中的物理结构或存储方式的是<strong>内模式</strong>。</li><li>在数据库系统的三级组织结构中，DBA视图是<strong>概念模式</strong>，系统程序员视图是<strong>内模式</strong>，用户视图是<strong>外模式</strong>。</li><li>在数据库的三级模式体系结构中，模式与内模式之间的映象<strong>模式/内模式</strong>，实现了数据库的<strong>物理</strong>独立性。</li><li>描述概念模型常用的方法是<strong>实体–联系方法</strong>。</li><li>在数据库设计中，将E-R图转换成关系数据模型的过程属于<strong>逻辑设计阶段</strong>。</li><li>在数据库设计的4个阶段中，每个阶段都有自己的设计内容。“在哪些表、在哪些属性上、建什么样的索引”，这一内容应该属于<strong>物理</strong>设计阶段。</li><li>在登录日志文件时，应该先<strong>登录日志文件</strong>，后<strong>更新数据库</strong>。</li><li>对数据对象施加封锁，可能会引起活锁和死锁问题。预防死锁通常有<strong>一次封锁法</strong>和<strong>顺序封锁法</strong>两种方法。</li><li>数据库管理系统通常提供授权功能来控制不同用户访问数据的权限，这主要是为了实现数据库的<strong>安全性</strong>。</li></ol><h1 id="测试"><a class="markdownIt-Anchor" href="#测试"></a> 测试</h1><p><button>隐藏答案</button></p><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script>$('button').on('click',function(){        console.log("By Zorua");         $('strong').css('color',"white");     })</script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/zoruasama/zoruasama.github.io@latest/css/mindmap.css">]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; href=&quot;https://use.fontawesome.com/releases/v5.0.13/css/all.css&quot;&gt;
&lt;h1 id=&quot;关于&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#关于&quot;&gt;
      
    
    </summary>
    
    
      <category term="数据库原理" scheme="https://zoruasama.gitee.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/"/>
    
    
      <category term="数据库原理" scheme="https://zoruasama.gitee.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/"/>
    
      <category term="数据库" scheme="https://zoruasama.gitee.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>数据库原理 | 7. 关系数据理论</title>
    <link href="https://zoruasama.gitee.io/2020/09/07/database_6/"/>
    <id>https://zoruasama.gitee.io/2020/09/07/database_6/</id>
    <published>2020-09-07T03:51:02.000Z</published>
    <updated>2020-09-07T08:13:30.598Z</updated>
    
    <content type="html"><![CDATA[<h1 id="思维导图"><a class="markdownIt-Anchor" href="#思维导图"></a> 思维导图</h1><blockquote class="pullquote mindmap mindmap-md"><ul><li>关系数据理论<ul><li>问题的提出</li><li>函数依赖<ul><li>函数依赖</li><li>平凡函数依赖与非平凡函数依赖</li><li>完全函数依赖与部分函数依赖</li><li>传递函数依赖</li></ul></li><li>码</li><li>范式<ul><li>1NF</li><li>2NF<ul><li>SLC不是一个好的关系模式</li><li>原因及解决办法</li><li>2NF的定义</li></ul></li><li>3NF<ul><li>解决方法</li><li>3NF的定义</li></ul></li><li>BC 范式<ul><li>解决方法</li><li>3NF与BCNF的关系</li><li>BCNF的关系模式所具有的性质</li></ul></li><li>规范化<ul><li>关系模式规范化的基本步骤</li><li>规范化的基本思想</li></ul></li></ul></li><li>数据依赖的公理系统<ul><li>Armstrong公理系统</li><li>导出规则</li><li>函数依赖闭包<ul><li>关于闭包的引理</li></ul></li><li>函数依赖集等价<ul><li>最小依赖集</li><li>极小化过程</li></ul></li></ul></li></ul></li></ul></blockquote><h1 id="问题的提出"><a class="markdownIt-Anchor" href="#问题的提出"></a> 问题的提出</h1><ul><li>关系数据库逻辑设计<ul><li>针对具体问题，如何构造一个适合于它的数据模式</li><li>数据库逻辑设计的工具──关系数据库的规范化理论</li></ul></li></ul><h1 id="函数依赖"><a class="markdownIt-Anchor" href="#函数依赖"></a> 函数依赖</h1><h2 id="函数依赖-2"><a class="markdownIt-Anchor" href="#函数依赖-2"></a> 函数依赖</h2><p>设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(U)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mclose">)</span></span></span></span>是一个属性集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span>上的关系模式，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span>的子集。<br />若对于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(U)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mclose">)</span></span></span></span>的任意一个可能的关系<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span></span>中不可能存在两个元组在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>上的属性值相等， 而在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>上的属性值不等， 则称 <strong>X函数确定Y</strong> 或<strong>Y函数依赖于X</strong>，记作<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>。<br />X称为这个函数依赖的<strong>决定属性集</strong>(Determinant)。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Y=f(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></p><ol><li>函数依赖不是指关系模式R的某个或某些关系实例满足的约束条件，而是指R的<strong>所有关系实例</strong>均要满足的约束条件。</li><li>函数依赖是<strong>语义范畴</strong>的概念。只能根据数据的语义来确定函数依赖。<br />例如“姓名→年龄”这个函数依赖只有在不允许有同名人的条件下成立</li><li>数据库设计者可以对现实世界作强制的规定。例如规定不允许同名人出现，函数依赖“姓名→年龄”成立。所插入的元组必须满足规定的函数依赖，若发现有同名人存在， 则拒绝装入该元组。</li></ol><blockquote><p><strong>例</strong><br />Student(Sno, Sname, Ssex, Sage, Sdept)<br />假设不允许重名，则有:<br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>n</mi><mi>o</mi><mo>→</mo><mi>S</mi><mi>s</mi><mi>e</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">Sno \rightarrow Ssex</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span></span></span></span>， <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>n</mi><mi>o</mi><mo>→</mo><mi>S</mi><mi>a</mi><mi>g</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Sno \rightarrow Sage</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">e</span></span></span></span> , <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>n</mi><mi>o</mi><mo>→</mo><mi>S</mi><mi>d</mi><mi>e</mi><mi>p</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">Sno \rightarrow Sdept</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span></span></span></span>，<br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>n</mi><mi>o</mi><mo>←</mo><mo>→</mo><mi>S</mi><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo separator="true">,</mo><mi>S</mi><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo>→</mo><mi>S</mi><mi>s</mi><mi>e</mi><mi>x</mi><mo separator="true">,</mo><mi>S</mi><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo>→</mo><mi>S</mi><mi>a</mi><mi>g</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Sno \leftarrow \rightarrow Sname, Sname \rightarrow Ssex, Sname \rightarrow Sage</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">e</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo>→</mo><mi>S</mi><mi>d</mi><mi>e</mi><mi>p</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">Sname \rightarrow Sdept</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span></span></span></span><br />但<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>s</mi><mi>e</mi><mi>x</mi><mo>→</mo><mi>S</mi><mi>a</mi><mi>g</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Ssex \rightarrow Sage</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">e</span></span></span></span><br />若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>，并且<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>→</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">Y\rightarrow X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>,  则记为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>←</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\leftarrow \rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>。<br />若Y不函数依赖于X,   则记为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>↛</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\not\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>。</p></blockquote><h2 id="平凡函数依赖与非平凡函数依赖"><a class="markdownIt-Anchor" href="#平凡函数依赖与非平凡函数依赖"></a> 平凡函数依赖与非平凡函数依赖</h2><p>在关系模式<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(U)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mclose">)</span></span></span></span>中，对于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span>的子集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>，<br />如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>，但<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>⊈</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">Y\not\subseteq X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>，则称X→Y是<strong>非平凡的函数依赖</strong><br />若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>，但<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>⊆</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">Y\subseteq X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>,   则称<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>是<strong>平凡的函数依赖</strong></p><blockquote><p><strong>例</strong><br />在关系<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>C</mi><mo stretchy="false">(</mo><mi>S</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>C</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>G</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">SC(Sno, Cno, Grade)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span>中，</p><ol><li>非平凡函数依赖： <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>C</mi><mi>n</mi><mi>o</mi><mo stretchy="false">)</mo><mo>→</mo><mi>G</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">(Sno, Cno) \rightarrow Grade</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span></span></span></span></li><li>平凡函数依赖：     <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>C</mi><mi>n</mi><mi>o</mi><mo stretchy="false">)</mo><mo>→</mo><mi>S</mi><mi>n</mi><mi>o</mi></mrow><annotation encoding="application/x-tex">(Sno, Cno) \rightarrow Sno</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>C</mi><mi>n</mi><mi>o</mi><mo stretchy="false">)</mo><mo>→</mo><mi>C</mi><mi>n</mi><mi>o</mi></mrow><annotation encoding="application/x-tex">(Sno, Cno) \rightarrow Cno</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span></span></span></span></li></ol></blockquote><p>任一关系模式，平凡函数依赖都是必然成立的，它不反映新的语义，因此若不特别声明， 我们总是讨论非平凡函数依赖。</p><h2 id="完全函数依赖与部分函数依赖"><a class="markdownIt-Anchor" href="#完全函数依赖与部分函数依赖"></a> 完全函数依赖与部分函数依赖</h2><p>在关系模式<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(U)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mclose">)</span></span></span></span>中，如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>，并且对于X的任何一个真子集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>X</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">X&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，都有</p><ul><li>若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>X</mi><mo mathvariant="normal">′</mo></msup><mo>↛</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X&#x27;\not\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>, 则称<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>完全函数依赖于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>，记作<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mover><mo><mo>→</mo></mo><mi>f</mi></mover><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\mathop{\rightarrow}\limits^{f} Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.200086em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.200086em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">→</span></span></span><span style="top:-3.613978em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>。</li><li>若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>，但Y不完全函数依赖于X，则称Y部分函数依赖于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>，记作<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mover><mo><mo>→</mo></mo><mi>P</mi></mover><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \mathop{\rightarrow}\limits^{P}   Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1452010000000001em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1452010000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">→</span></span></span><span style="top:-3.5668699999999998em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>。</li></ul><h2 id="传递函数依赖"><a class="markdownIt-Anchor" href="#传递函数依赖"></a> 传递函数依赖</h2><p>在关系模式<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(U)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mclose">)</span></span></span></span>中，如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">Y\rightarrow Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span>，且<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>⊈</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">Y\not\subseteq X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>→</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">Y\rightarrow X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>，则称<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span><strong>传递函数依赖于</strong><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>。<br />注: 如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>→</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">Y\rightarrow X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>， 即<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>←</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\leftarrow \rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span><strong>直接依赖</strong>于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>。</p><blockquote><p><strong>例</strong><br />在关系<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>t</mi><mi>d</mi><mo stretchy="false">(</mo><mi>S</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>S</mi><mi>d</mi><mi>e</mi><mi>p</mi><mi>t</mi><mo separator="true">,</mo><mi>S</mi><mi>l</mi><mi>o</mi><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Std(Sno, Sdept, Sloc)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">t</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mclose">)</span></span></span></span>中，有：<br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>n</mi><mi>o</mi><mo>→</mo><mi>S</mi><mi>d</mi><mi>e</mi><mi>p</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">Sno \rightarrow Sdept</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>d</mi><mi>e</mi><mi>p</mi><mi>t</mi><mo>→</mo><mi>S</mi><mi>l</mi><mi>o</mi><mi>c</mi></mrow><annotation encoding="application/x-tex">Sdept \rightarrow Sloc</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>l</mi><mi>o</mi><mi>c</mi></mrow><annotation encoding="application/x-tex">Sloc</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span></span></span></span>传递函数依赖于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>n</mi><mi>o</mi></mrow><annotation encoding="application/x-tex">Sno</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span></span></span></span></p></blockquote><h1 id="码"><a class="markdownIt-Anchor" href="#码"></a> 码</h1><p>设K为关系模式<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>&lt;</mo><mi>U</mi><mo separator="true">,</mo><mi>F</mi><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">R&lt;U,F&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span></span></span>中的属性或属性组合。若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi><mover><mo><mo>→</mo></mo><mi>f</mi></mover><mi>U</mi></mrow><annotation encoding="application/x-tex">K \mathop{\rightarrow}\limits^{f} U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.200086em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.200086em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">→</span></span></span><span style="top:-3.613978em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span>，则K称为R的一个候选码（Candidate Key）。若关系模式R有多个候选码，则选定其中的一个做为主码（Primary key）。</p><h1 id="范式"><a class="markdownIt-Anchor" href="#范式"></a> 范式</h1><ul><li>范式是符合某一种级别的关系模式的集合。</li><li>关系数据库中的关系必须满足一定的要求。满足不同程度要求的为不同范式。</li><li>范式的种类：<ul><li>第一范式(1NF)</li><li>第二范式(2NF)</li><li>第三范式(3NF)</li><li>BC范式(BCNF)</li><li>第四范式(4NF)</li><li>第五范式(5NF)</li></ul></li><li>各种范式之间存在联系：<ul><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mrow><mi mathvariant="normal">N</mi><mi mathvariant="normal">F</mi></mrow><mo>⊃</mo><mn>2</mn><mrow><mi mathvariant="normal">N</mi><mi mathvariant="normal">F</mi></mrow><mo>⊃</mo><mn>3</mn><mrow><mi mathvariant="normal">N</mi><mi mathvariant="normal">F</mi></mrow><mo>⊃</mo><mrow><mi mathvariant="normal">B</mi><mi mathvariant="normal">C</mi><mi mathvariant="normal">N</mi><mi mathvariant="normal">F</mi></mrow><mo>⊃</mo><mn>4</mn><mrow><mi mathvariant="normal">N</mi><mi mathvariant="normal">F</mi></mrow><mo>⊃</mo><mn>5</mn><mrow><mi mathvariant="normal">N</mi><mi mathvariant="normal">F</mi></mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">1\mathrm{NF} \supset 2\mathrm{NF} \supset 3\mathrm{NF} \supset \mathrm{BCNF} \supset 4\mathrm{NF} \supset 5\mathrm{NF}F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord">1</span><span class="mord"><span class="mord mathrm">N</span><span class="mord mathrm">F</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊃</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathrm">N</span><span class="mord mathrm">F</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊃</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord">3</span><span class="mord"><span class="mord mathrm">N</span><span class="mord mathrm">F</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊃</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord mathrm">B</span><span class="mord mathrm">C</span><span class="mord mathrm">N</span><span class="mord mathrm">F</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊃</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord">4</span><span class="mord"><span class="mord mathrm">N</span><span class="mord mathrm">F</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊃</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">5</span><span class="mord"><span class="mord mathrm">N</span><span class="mord mathrm">F</span></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span></li></ul></li><li>某一关系模式R为第n范式，可简记为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>∈</mo><mi>n</mi><mrow><mi mathvariant="normal">N</mi><mi mathvariant="normal">F</mi></mrow></mrow><annotation encoding="application/x-tex">R\in n\mathrm{NF}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathrm">N</span><span class="mord mathrm">F</span></span></span></span></span>。</li></ul><h2 id="1nf"><a class="markdownIt-Anchor" href="#1nf"></a> 1NF</h2><ul><li>1NF的定义<ul><li>如果<strong>一个关系模式R的所有属性</strong>都是不可分的基本数据项，则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>∈</mo><mn>1</mn><mrow><mi mathvariant="normal">N</mi><mi mathvariant="normal">F</mi></mrow></mrow><annotation encoding="application/x-tex">R\in 1\mathrm{NF}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord mathrm">N</span><span class="mord mathrm">F</span></span></span></span></span>。</li><li>第一范式是对关系模式的最起码的要求。不满足第一范式的数据库模式不能称为关系数据库。</li><li>但是满足第一范式的关系模式并不一定是一个好的关系模式。</li></ul></li></ul><h2 id="2nf"><a class="markdownIt-Anchor" href="#2nf"></a> 2NF</h2><ul><li><p>例: 关系模式   SLC(Sno, Sdept, Sloc, Cno, Grade)</p></li><li><pre><code>Sloc为学生住处，假设每个系的学生住在同一个地方。</code></pre></li><li><p>函数依赖包括：</p><ul><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>C</mi><mi>n</mi><mi>o</mi><mo stretchy="false">)</mo><mover><mo><mo>→</mo></mo><mi>f</mi></mover><mi>G</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">(Sno, Cno) \mathop{\rightarrow}\limits^f     Grade</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.450086em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.200086em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">→</span></span></span><span style="top:-3.613978em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>n</mi><mi>o</mi><mo><mo>→</mo></mo><mi>S</mi><mi>d</mi><mi>e</mi><mi>p</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">Sno \mathop{\rightarrow} Sdept</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">→</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>C</mi><mi>n</mi><mi>o</mi><mo stretchy="false">)</mo><mover><mo><mo>→</mo></mo><mi>P</mi></mover><mi>S</mi><mi>d</mi><mi>e</mi><mi>p</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">(Sno, Cno) \mathop{\rightarrow}\limits^P     Sdept</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3952010000000001em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1452010000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">→</span></span></span><span style="top:-3.5668699999999998em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>n</mi><mi>o</mi><mo><mo>→</mo></mo><mi>S</mi><mi>l</mi><mi>o</mi><mi>c</mi></mrow><annotation encoding="application/x-tex">Sno \mathop{\rightarrow} Sloc</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">→</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>C</mi><mi>n</mi><mi>o</mi><mo stretchy="false">)</mo><mover><mo><mo>→</mo></mo><mi>P</mi></mover><mi>S</mi><mi>l</mi><mi>o</mi><mi>c</mi></mrow><annotation encoding="application/x-tex">(Sno, Cno) \mathop{\rightarrow}\limits^P     Sloc</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3952010000000001em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1452010000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">→</span></span></span><span style="top:-3.5668699999999998em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>d</mi><mi>e</mi><mi>p</mi><mi>t</mi><mo><mo>→</mo></mo><mi>S</mi><mi>l</mi><mi>o</mi><mi>c</mi></mrow><annotation encoding="application/x-tex">Sdept \mathop{\rightarrow} Sloc</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">→</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span></span></span></span></li></ul></li></ul><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200519200344.png" alt="" /></p><ul><li>SLC的码为(Sno, Cno)</li><li>SLC满足第一范式。</li><li>非主属性Sdept和Sloc部分函数依赖于码(Sno, Cno)</li></ul><h3 id="slc不是一个好的关系模式"><a class="markdownIt-Anchor" href="#slc不是一个好的关系模式"></a> SLC不是一个好的关系模式</h3><ol><li>插入异常<br />假设Sno＝95102，Sdept＝IS，Sloc＝N的学生还未选课，因课程号是主属性，因此该学生的信息无法插入SLC。</li><li>删除异常<br />假定某个学生本来只选修了3号课程这一门课。现在因身体不适，他连3号课程也不选修了。因课程号是主属性，此操作将导致该学生信息的整个元组都要删除。</li><li>数据冗余度大<br />如果一个学生选修了10门课程，那么他的Sdept和Sloc值就要重复存储了10次。</li><li>修改复杂<br />例如学生转系，在修改此学生元组的Sdept值的同时，还可能需要修改住处（Sloc）。如果这个学生选修了K门课，则必须无遗漏地修改K个元组中全部Sdept、Sloc信息。</li></ol><h3 id="原因及解决办法"><a class="markdownIt-Anchor" href="#原因及解决办法"></a> 原因及解决办法</h3><ul><li>Sdept、 Sloc部分函数依赖于码。</li><li>SLC分解为两个关系模式，以消除这些部分函数依赖<ul><li>SC（Sno， Cno， Grade）</li><li>SL（Sno， Sdept， Sloc）<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200519202552.png" alt="" /></li></ul></li></ul><h3 id="2nf的定义"><a class="markdownIt-Anchor" href="#2nf的定义"></a> 2NF的定义</h3><ul><li><p>若关系模式R∈1NF，并且每一个非主属性都完全函数依赖于R的码，则R∈2NF。</p><ul><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>L</mi><mi>C</mi><mo stretchy="false">(</mo><mi>S</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>S</mi><mi>d</mi><mi>e</mi><mi>p</mi><mi>t</mi><mo separator="true">,</mo><mi>S</mi><mi>l</mi><mi>o</mi><mi>c</mi><mo separator="true">,</mo><mi>C</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>G</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>e</mi><mo stretchy="false">)</mo><mo>∈</mo><mn>1</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">SLC(Sno, Sdept, Sloc, Cno, Grade) \in 1NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">L</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>L</mi><mi>C</mi><mo stretchy="false">(</mo><mi>S</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>S</mi><mi>d</mi><mi>e</mi><mi>p</mi><mi>t</mi><mo separator="true">,</mo><mi>S</mi><mi>l</mi><mi>o</mi><mi>c</mi><mo separator="true">,</mo><mi>C</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>G</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>e</mi><mo stretchy="false">)</mo><mo>∈</mo><mn>2</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">SLC(Sno, Sdept, Sloc, Cno, Grade) \in 2NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">L</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>C</mi><mo stretchy="false">(</mo><mi>S</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>C</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>G</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>e</mi><mo stretchy="false">)</mo><mo>∈</mo><mn>2</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">SC(Sno, Cno, Grade) \in 2NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>L</mi><mo stretchy="false">(</mo><mi>S</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>S</mi><mi>d</mi><mi>e</mi><mi>p</mi><mi>t</mi><mo separator="true">,</mo><mi>S</mi><mi>l</mi><mi>o</mi><mi>c</mi><mo stretchy="false">)</mo><mo>∈</mo><mn>2</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">SL(Sno, Sdept, Sloc) \in 2NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span></li></ul></li><li><p>采用投影分解法将一个1NF的关系分解为多个2NF的关系，可以在一定程度上减轻原1NF关系中存在的插入异常、删除异常、数据冗余度大、修改复杂等问题。</p></li><li><p>将一个1NF关系分解为多个2NF的关系，并不能完全消除关系模式中的各种异常情况和数据冗余。</p></li></ul><h2 id="3nf"><a class="markdownIt-Anchor" href="#3nf"></a> 3NF</h2><ul><li><p>例：2NF关系模式SL(Sno, Sdept, Sloc)中<br />函数依赖：</p></li><li><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>n</mi><mi>o</mi><mo>→</mo><mi>S</mi><mi>d</mi><mi>e</mi><mi>p</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">Sno\rightarrow Sdept</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span></span></span></span></p></li><li><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>d</mi><mi>e</mi><mi>p</mi><mi>t</mi><mo>→</mo><mi>S</mi><mi>l</mi><mi>o</mi><mi>c</mi></mrow><annotation encoding="application/x-tex">Sdept\rightarrow Sloc</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span></span></span></span></p></li><li><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>n</mi><mi>o</mi><mo>→</mo><mi>S</mi><mi>l</mi><mi>o</mi><mi>c</mi></mrow><annotation encoding="application/x-tex">Sno\rightarrow Sloc</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span></span></span></span><br />Sloc传递函数依赖于Sno，即SL中存在非主属性对码的传递函数依赖。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200520211845.png" alt="" /></p></li></ul><h3 id="解决方法"><a class="markdownIt-Anchor" href="#解决方法"></a> 解决方法</h3><p>采用投影分解法，把SL分解为两个关系模式，以消除传递函数依赖：</p><ul><li>SD（Sno, Sdept）</li><li>DL（Sdept, Sloc）<br />SD的码为Sno， DL的码为Sdept。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200520225001.png" alt="" /></li></ul><h3 id="3nf的定义"><a class="markdownIt-Anchor" href="#3nf的定义"></a> 3NF的定义</h3><p>关系模式<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>&lt;</mo><mi>U</mi><mo separator="true">,</mo><mi>F</mi><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">R&lt;U,F&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span></span></span>中若不存在这样的码X、属性组Y及非主属性Z（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi><mo>⊈</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">Z\not\subseteq Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>）, 使得<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi><mo separator="true">,</mo><mi>Y</mi><mo>→</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y,Y\rightarrow X,Y\rightarrow Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span>，成立，则称<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>&lt;</mo><mi>U</mi><mo separator="true">,</mo><mi>F</mi><mo>&gt;</mo><mo>∈</mo><mn>3</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">R&lt;U,F&gt;\in 3NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>。</p><ul><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>L</mi><mo stretchy="false">(</mo><mi>S</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>S</mi><mi>d</mi><mi>e</mi><mi>p</mi><mi>t</mi><mo separator="true">,</mo><mi>S</mi><mi>l</mi><mi>o</mi><mi>c</mi><mo stretchy="false">)</mo><mo>∈</mo><mn>2</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">SL(Sno, Sdept, Sloc) \in 2NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>L</mi><mo stretchy="false">(</mo><mi>S</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>S</mi><mi>d</mi><mi>e</mi><mi>p</mi><mi>t</mi><mo separator="true">,</mo><mi>S</mi><mi>l</mi><mi>o</mi><mi>c</mi><mo stretchy="false">)</mo><mo>∈</mo><mn>3</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">SL(Sno, Sdept, Sloc) \in 3NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>D</mi><mo stretchy="false">(</mo><mi>S</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>S</mi><mi>d</mi><mi>e</mi><mi>p</mi><mi>t</mi><mo stretchy="false">)</mo><mo>∈</mo><mn>3</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">SD(Sno, Sdept) \in 3NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi><mi>L</mi><mo stretchy="false">(</mo><mi>S</mi><mi>d</mi><mi>e</mi><mi>p</mi><mi>t</mi><mo separator="true">,</mo><mi>S</mi><mi>l</mi><mi>o</mi><mi>c</mi><mo stretchy="false">)</mo><mo>∈</mo><mn>3</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">DL(Sdept, Sloc)\in 3NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span></li></ul><hr /><ul><li>若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>∈</mo><mn>3</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">R\in 3NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>，则R的每一个非主属性既不部分函数依赖于候选码也不传递函数依赖于候选码。</li><li>如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>∈</mo><mn>3</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">R\in 3NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>，则R也是2NF。</li><li>采用投影分解法将一个2NF的关系分解为多个3NF的关系，可以在一定程度上解决原2NF关系中存在的插入异常、删除异常、数据冗余度大、修改复杂等问题。</li><li>将一个2NF关系分解为多个3NF的关系后，并不能完全消除关系模式中的各种异常情况和数据冗余。</li></ul><h2 id="bc-范式"><a class="markdownIt-Anchor" href="#bc-范式"></a> BC 范式</h2><ul><li>设关系模式<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>&lt;</mo><mi>U</mi><mo separator="true">,</mo><mi>F</mi><mo>&gt;</mo><mo>∈</mo><mn>1</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">R&lt;U,F&gt;\in 1NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>，如果对于R的每个函数依赖<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>，若Y不属于X，则X必含有候选码，那么<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>∈</mo><mi>B</mi><mi>C</mi><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">R\in BCNF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>。</li><li>若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>∈</mo><mi>B</mi><mi>C</mi><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">R\in BCNF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span><ul><li>每一个决定属性集（因素）都包含（候选）码</li><li>R中的所有属性（主，非主属性）都完全函数依赖于码</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>∈</mo><mn>3</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">R\in 3NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>（证明）</li><li>若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>∈</mo><mn>3</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">R\in 3NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>    则  <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span>不一定<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>∈</mo><mi>B</mi><mi>C</mi><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">\in BCNF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span><br />例：在关系模式<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>T</mi><mi>J</mi><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mi>T</mi><mo separator="true">,</mo><mi>J</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">STJ(S,T,J)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mclose">)</span></span></span></span>中，S表示学生，T表示教师，J表示课程。<br />每一教师只教一门课。每门课由若干教师教，某一学生选定某门课，就确定了一个固定的教师。某个学生选修某个教师的课就确定了所选课的名称 ：                <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mi>J</mi><mo stretchy="false">)</mo><mo>→</mo><mi>T</mi><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">)</mo><mo>→</mo><mi>J</mi><mo separator="true">,</mo><mi>T</mi><mo>→</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">(S,J)\rightarrow T,(S,T)\rightarrow J,T\rightarrow J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span></span></span></span><br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200520230033.png" alt="" /></li></ul></li></ul><h3 id="解决方法-2"><a class="markdownIt-Anchor" href="#解决方法-2"></a> 解决方法</h3><ul><li>将STJ分解为二个关系模式：</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>J</mi><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mi>J</mi><mo stretchy="false">)</mo><mo>∈</mo><mi>B</mi><mi>C</mi><mi>N</mi><mi>F</mi><mi mathvariant="normal">，</mi><mi>T</mi><mi>J</mi><mo stretchy="false">(</mo><mi>T</mi><mo separator="true">,</mo><mi>J</mi><mo stretchy="false">)</mo><mo>∈</mo><mi>B</mi><mi>C</mi><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">SJ(S,J) \in BCNF， TJ(T,J)\in BCNF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord cjk_fallback">，</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span></li><li>没有<strong>任何属性</strong>对码的部分函数依赖和传递函数依赖</li></ul><h3 id="3nf与bcnf的关系"><a class="markdownIt-Anchor" href="#3nf与bcnf的关系"></a> 3NF与BCNF的关系</h3><ul><li>如果关系模式<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>∈</mo><mi>B</mi><mi>C</mi><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">R\in BCNF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>，必定有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>∈</mo><mn>3</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">R\in 3NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span></li><li>如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>∈</mo><mn>3</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">R\in 3NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>，且R只有一个候选码，则必定<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>∈</mo><mi>B</mi><mi>C</mi><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">R\in BCNF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>。</li></ul><h3 id="bcnf的关系模式所具有的性质"><a class="markdownIt-Anchor" href="#bcnf的关系模式所具有的性质"></a> BCNF的关系模式所具有的性质</h3><ol><li>所有<strong>非主属性</strong>都完全函数依赖于每个候选码</li><li>所有<strong>主属性</strong>都完全函数依赖于每个不包含它的候选码</li><li>没有任何属性完全函数依赖于<strong>非码</strong>的任何一组属性</li></ol><h2 id="规范化"><a class="markdownIt-Anchor" href="#规范化"></a> 规范化</h2><ul><li>关系数据库的规范化理论是数据库逻辑设计的工具。</li><li>一个关系只要其分量都是不可分的数据项，它就是规范化的关系，但这只是最基本的规范化。</li><li>规范化程度可以有多个不同的级别</li><li>规范化程度过低的关系不一定能够很好地描述现实世界，可能会存在插入异常、删除异常、修改复杂、数据冗余等问题</li><li>一个低一级范式的关系模式，通过模式分解可以转换为若干个高一级范式的关系模式集合，这种过程就叫<strong>关系模式的规范化</strong></li></ul><h3 id="关系模式规范化的基本步骤"><a class="markdownIt-Anchor" href="#关系模式规范化的基本步骤"></a> 关系模式规范化的基本步骤</h3><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200520230604.png" alt="" /></p><h3 id="规范化的基本思想"><a class="markdownIt-Anchor" href="#规范化的基本思想"></a> 规范化的基本思想</h3><ul><li>消除不合适的数据依赖</li><li>使模式中的各关系模式达到某种程度的“分离”</li><li>采用“一事一地”的模式设计原则<ul><li>让一个关系描述一个概念、一个实体或者实体间的一种联系。若多于一个概念就把它“分离”出去</li></ul></li><li>所谓规范化实质上是<strong>概念的单一化</strong></li><li>不能说规范化程度越高的关系模式就越好</li><li>在设计数据库模式结构时，必须对现实世界的实际情况和用户应用需求作进一步分析，确定一个合适的、能够反映现实世界的模式</li><li>上面的规范化步骤可以在其中任何一步终止</li></ul><h1 id="数据依赖的公理系统"><a class="markdownIt-Anchor" href="#数据依赖的公理系统"></a> 数据依赖的公理系统</h1><p>对于满足一组<strong>函数依赖</strong><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>的关系模式<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>&lt;</mo><mi>U</mi><mo separator="true">,</mo><mi>F</mi><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">R&lt;U,F&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span></span></span>，其任何一个关系<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span></span>，若函数依赖<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>都成立, 则称F<strong>逻辑蕴含</strong><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>。</p><h2 id="armstrong公理系统"><a class="markdownIt-Anchor" href="#armstrong公理系统"></a> Armstrong公理系统</h2><ul><li>一套推理规则，是模式分解算法的理论基础</li><li>用途<ul><li>求给定关系模式的码</li><li>从一组函数依赖求得蕴含的函数依赖</li></ul></li></ul><hr /><p>关系模式R &lt;U，F &gt;来说有以下的推理规则：</p><ul><li>自反律（Reflexivity）：若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>⊆</mo><mi>X</mi><mo>⊆</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">Y \subseteq X \subseteq U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>所蕴含。</li><li>增广律（Augmentation）：若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>为F所蕴含，且<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi><mo>⊆</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">Z \subseteq U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mi>Z</mi><mo>→</mo><mi>Y</mi><mi>Z</mi></mrow><annotation encoding="application/x-tex">XZ\rightarrow YZ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span>为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>所蕴含。</li><li>传递律（Transitivity）：若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>及<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">Y\rightarrow Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span>为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>所蕴含，则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span>为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>所蕴含。</li></ul><p>注意：由自反律所得到的函数依赖均是平凡的函数依赖，自反律的使用并不依赖于F</p><h2 id="导出规则"><a class="markdownIt-Anchor" href="#导出规则"></a> 导出规则</h2><p>根据A1，A2，A3这三条推理规则可以得到下面三条推理规则：</p><ul><li>合并规则：由<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi><mo separator="true">,</mo><mi>X</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y, X\rightarrow Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span>，有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi><mi>Z</mi></mrow><annotation encoding="application/x-tex">X\rightarrow YZ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span>。</li><li>伪传递规则：由<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi><mo separator="true">,</mo><mi>W</mi><mi>Y</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y, WY\rightarrow Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span>，有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mi>W</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">XW\rightarrow Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span>。</li><li>分解规则：由<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>及 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi><mo>⊆</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">Z\subseteq Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>，有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span>。</li></ul><hr /><ul><li>引理：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo>⋯</mo><msub><mi>A</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">X→A_1,A_2\cdots A_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>成立的充分必要条件是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">X\rightarrow A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>成立<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo>=</mo><mi>l</mi><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i=l,2,\cdots,k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span>。</li></ul><h2 id="函数依赖闭包"><a class="markdownIt-Anchor" href="#函数依赖闭包"></a> 函数依赖闭包</h2><ul><li>在关系模式R&lt;U，F&gt;中为F所逻辑蕴含的函数依赖的全体叫作<strong>F的闭包</strong>，记为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>F</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">F^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>。</li><li>设F为属性集U上的一组函数依赖，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>⊆</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">X\subseteq U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span>， <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>X</mi><mi>F</mi><mo>+</mo></msubsup></mrow><annotation encoding="application/x-tex">X_F^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104993em;vertical-align:-0.293531em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.4064690000000004em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">F</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.293531em;"><span></span></span></span></span></span></span></span></span></span> ={A|X→A能由F根据Armstrong公理导出}，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>X</mi><mi>F</mi><mo>+</mo></msubsup></mrow><annotation encoding="application/x-tex">X_F^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104993em;vertical-align:-0.293531em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.4064690000000004em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">F</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.293531em;"><span></span></span></span></span></span></span></span></span></span>称为<strong>属性集X关于函数依赖集F的闭包</strong>。</li></ul><h3 id="关于闭包的引理"><a class="markdownIt-Anchor" href="#关于闭包的引理"></a> 关于闭包的引理</h3><ul><li><strong>内容</strong>：设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>为属性集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span>上的一组函数依赖，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo>⊆</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">X,Y \subseteq U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>能由F 根据Armstrong公理导出的充分必要条件是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>⊆</mo><msubsup><mi>X</mi><mi>F</mi><mo>+</mo></msubsup></mrow><annotation encoding="application/x-tex">Y\subseteq X_F^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.104993em;vertical-align:-0.293531em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.4064690000000004em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">F</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.293531em;"><span></span></span></span></span></span></span></span></span></span></li><li><strong>用途</strong>：将判定<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>是否能由<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>根据Armstrong公理导出的问题，就转化为求出<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>X</mi><mi>F</mi><mo>+</mo></msubsup></mrow><annotation encoding="application/x-tex">X_F^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104993em;vertical-align:-0.293531em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.4064690000000004em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">F</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.293531em;"><span></span></span></span></span></span></span></span></span></span> ，判定<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>是否为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>X</mi><mi>F</mi><mo>+</mo></msubsup></mrow><annotation encoding="application/x-tex">X_F^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104993em;vertical-align:-0.293531em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.4064690000000004em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">F</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.293531em;"><span></span></span></span></span></span></span></span></span></span>的子集的问题。</li></ul><h2 id="函数依赖集等价"><a class="markdownIt-Anchor" href="#函数依赖集等价"></a> 函数依赖集等价</h2><p>如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>G</mi><mo>+</mo></msup><mo>=</mo><msup><mi>F</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">G^+=F^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>，就说函数依赖集F<strong>覆盖</strong>G（F是G的覆盖，或G是F的覆盖），或F与G<strong>等价</strong>。</p><h3 id="最小依赖集"><a class="markdownIt-Anchor" href="#最小依赖集"></a> 最小依赖集</h3><p>如果函数依赖集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>满足下列条件，则称F为一个<strong>极小函数依赖集</strong>。亦称为<strong>最小依赖集</strong>或<strong>最小覆盖</strong>。</p><ul><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>中任一函数依赖的右部仅含有一个属性。</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>中不存在这样的函数依赖<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">X\rightarrow A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span>，使得<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>与<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mo>−</mo><mrow><mi>X</mi><mo>→</mo><mi>A</mi></mrow></mrow><annotation encoding="application/x-tex">F-{X\rightarrow A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">A</span></span></span></span></span>等价。</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>中不存在这样的函数依赖<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">X\rightarrow A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span>， X有真子集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span>使得<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mo>−</mo><mrow><mi>X</mi><mo>→</mo><mi>A</mi></mrow><mo>∪</mo><mrow><mi>Z</mi><mo>→</mo><mi>A</mi></mrow></mrow><annotation encoding="application/x-tex">F-{X\rightarrow A}\cup{Z\rightarrow A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">A</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">A</span></span></span></span></span>与<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>等价。</li></ul><h3 id="极小化过程"><a class="markdownIt-Anchor" href="#极小化过程"></a> 极小化过程</h3><p>每一个函数依赖集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>均等价于一个极小函数依赖集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">F_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。此<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">F_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>称为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>的最小依赖集。</p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/zoruasama/zoruasama.github.io@latest/css/mindmap.css">]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;思维导图&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#思维导图&quot;&gt;&lt;/a&gt; 思维导图&lt;/h1&gt;
&lt;blockquote class=&quot;pullquote mindmap mindmap-md&quot;&gt;&lt;ul&gt;
&lt;li&gt;关系数据理论
&lt;ul&gt;
      
    
    </summary>
    
    
      <category term="数据库原理" scheme="https://zoruasama.gitee.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/"/>
    
    
      <category term="数据库原理" scheme="https://zoruasama.gitee.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/"/>
    
      <category term="数据库" scheme="https://zoruasama.gitee.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>Linux入门 | 3.常用命令</title>
    <link href="https://zoruasama.gitee.io/2020/08/27/Linux_2/"/>
    <id>https://zoruasama.gitee.io/2020/08/27/Linux_2/</id>
    <published>2020-08-27T13:00:00.000Z</published>
    <updated>2020-09-10T06:31:50.666Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css"><h1 id="基础命令"><a class="markdownIt-Anchor" href="#基础命令"></a> 基础命令</h1><p>在<a href="/2020/04/14/Linux_1/#%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4">上一篇文章</a>中，我写到了在<code>Linux</code>系统中常用了8个命令，在这篇文章中，将会对这8个命令作较为详细的解析。<br />如果各位读者对本文有所不清晰或认为有错误的地方，欢迎来评论区指出。我会及时确认并修正。</p><table><thead><tr><th>序号</th><th>命令</th><th>对应英语</th><th>作用</th></tr></thead><tbody><tr><td>01</td><td>ls</td><td>list</td><td>列出指定文件夹下的内容</td></tr><tr><td>02</td><td>pwd</td><td>print work directory</td><td>显示当前工作路径</td></tr><tr><td>03</td><td>cd</td><td>change directory</td><td>改变当前工作路径</td></tr><tr><td>04</td><td>touch</td><td>touch</td><td>新建一个空白文件</td></tr><tr><td>05</td><td>mkdir</td><td>make directory</td><td>创建一个新的目录</td></tr><tr><td>06</td><td>rm</td><td>remove</td><td>删除指定文件</td></tr><tr><td>07</td><td>clear</td><td>clear</td><td>清除当前屏幕上的信息（新建一屏）</td></tr><tr><td>08</td><td>reset</td><td>reset</td><td>重置终端</td></tr></tbody></table><h1 id="命令格式"><a class="markdownIt-Anchor" href="#命令格式"></a> 命令格式</h1><p>在终端中，命令通常是按照如下格式进行的：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">command</span> [-options] [parameter]</span><br></pre></td></tr></table></figure><ul><li><code>command</code>：命令名称，</li><li><code>[-options]</code>：选项，可用来对命令进行控制，实现不同的效果。这一项可以省略。</li><li><code>parameter</code>：传给命令的参数，可以是 <strong>零个</strong>、<strong>一个</strong> 或者 <strong>多个</strong></li></ul><h1 id="ls-命令说明"><a class="markdownIt-Anchor" href="#ls-命令说明"></a> ls 命令说明</h1><ul><li><code>ls</code> 是<strong>list</strong> 的缩写，功能是列出指定文件夹下的内容，可以类比于 <strong>DOS</strong> 下的 <code>dir</code> 命令。</li><li><code>ls path</code>显示path路径的目录下的内容。</li><li>如果直接使用<code>ls</code>，等价于<code>ls .</code>（下文有解释<code>.</code>）。</li></ul><h2 id="ls-常用选项"><a class="markdownIt-Anchor" href="#ls-常用选项"></a> ls 常用选项</h2><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-a</td><td>显示指定目录下所有子目录与文件，包括<strong>隐藏文件</strong></td></tr><tr><td>-l</td><td>以<strong>列表方式</strong>显示文件的详细信息</td></tr><tr><td>-h</td><td>配合 -l 以人性化的方式显示文件大小</td></tr></tbody></table><h2 id="linux-系统的文件和目录的特点"><a class="markdownIt-Anchor" href="#linux-系统的文件和目录的特点"></a> Linux 系统的文件和目录的特点</h2><ul><li><strong>文件</strong> 或者 <strong>目录</strong> 名称最长可以有 <code>256</code> 个字符</li><li>以 <code>.</code> 开头的文件为隐藏文件，需要用 -a 参数才能显示</li><li><strong>.</strong> 代表当前目录，也可以叫做工作目录（或者工作路径）</li><li><strong>…</strong> 代表上一级目录</li><li>上面这两个目录严格来说也是<code>.</code>开头的，所以也是在 -a 参数下才能显示。</li></ul><h3 id="绝对路径与相对路径"><a class="markdownIt-Anchor" href="#绝对路径与相对路径"></a> 绝对路径与相对路径</h3><p>在Linux中，以path作为参数时，可分为绝对路径和相对路径。</p><ul><li><p><strong>绝对路径</strong><br />从<strong>根目录</strong><code>/</code>开始，依次将各级子目录的名字组合起来，形成的路径就称为某个文件的绝对路径。例如，根目录（/）下有目录usr，usr目录下有子目录bin，bin目录下有文件chsh，则chsh文件的绝对路径就是：/usr/bin/chsh。</p></li><li><p><strong>相对路径</strong><br />相对当前所在路径的位置，例如当前所在的位置为/usr，也就是在根目录的usr子目录下，则chsh文件相对当前位置的路径为：bin/chsh。</p></li></ul><div class="snote guide"><p>相对路径就是相对于当前工作目录的路径。例如我想显示当前工作目录的上一级目录下的文件：ls ..</p></div><h2 id="ls-通配符的使用"><a class="markdownIt-Anchor" href="#ls-通配符的使用"></a> ls 通配符的使用</h2><p>在<code>ls</code>命令的参数中，可以使用通配符。</p><table><thead><tr><th>通配符</th><th>含义</th></tr></thead><tbody><tr><td>*</td><td>代表任意个数个字符</td></tr><tr><td>?</td><td>代表任意一个字符，至少 1 个</td></tr><tr><td>[]</td><td>表示可以匹配字符组中的任一一个</td></tr><tr><td>[abc]</td><td>匹配 a、b、c 中的任意一个</td></tr><tr><td>[a-f]</td><td>匹配从 a 到 f 范围内的的任意一个字符</td></tr></tbody></table><h2 id="演示"><a class="markdownIt-Anchor" href="#演示"></a> 演示</h2><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200827191622.gif" alt="" /></p><h1 id="pwd-命令说明"><a class="markdownIt-Anchor" href="#pwd-命令说明"></a> pwd 命令说明</h1><ul><li><code>pwd</code> 命令相对比较简单，就是显示当前工作目录。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200827192734.png" alt="" /><br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200827192945.png" alt="" /></li></ul><h2 id="演示-2"><a class="markdownIt-Anchor" href="#演示-2"></a> 演示</h2><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200827191855.gif" alt="" /></p><h1 id="cd-命令说明"><a class="markdownIt-Anchor" href="#cd-命令说明"></a> cd 命令说明</h1><h2 id="使用cd命令"><a class="markdownIt-Anchor" href="#使用cd命令"></a> 使用cd命令</h2><ul><li>如果单纯地使用<code>cd</code>命令，等价于<code>cd ~</code>或<code>cd /home/username</code><ul><li>即切换到家目录</li></ul></li><li><code>cd</code>后面可以接<strong>绝对路径</strong>或<strong>相对路径</strong>作为参数。</li><li><code>cd -</code>可以来回切换目录，即<strong>访问上一次访问的目录</strong>。</li></ul><h2 id="演示-3"><a class="markdownIt-Anchor" href="#演示-3"></a> 演示</h2><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200827192449.gif" alt="" /></p><h1 id="touch-命令说明"><a class="markdownIt-Anchor" href="#touch-命令说明"></a> touch 命令说明</h1><p><code>touch</code>用于修改文件或者目录的时间属性，包括存取时间和更改时间。若文件不存在，<strong>系统会建立一个新的文件</strong>。<br />作为入门级教程，我们只需要知道<code>touch</code>命令可以创建一个空白文件就行了。<br />语法：<code>touch filename</code></p><h2 id="演示-4"><a class="markdownIt-Anchor" href="#演示-4"></a> 演示</h2><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200827200707.gif" alt="" /></p><h1 id="mkdir-命令说明"><a class="markdownIt-Anchor" href="#mkdir-命令说明"></a> mkdir 命令说明</h1><ul><li><code>mkdir path</code>会创建一个path目录。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200827203633.gif" alt="" /></li></ul><hr /><p>如果path是一个较长的路径，例如<code>aaa/bbb/ccc/ddd</code>这个例子，需要确保<code>aaa``bbb``ccc</code>文件夹都已经存在。<br />如果加一个<code>-p</code>选项（递归创建目录），则不需要确保这些文件夹都已经存在。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200827204408.gif" alt="" /></p><h1 id="rm-命令说明"><a class="markdownIt-Anchor" href="#rm-命令说明"></a> rm 命令说明</h1><p>使用<code>rm</code>时请<strong>万分小心</strong>，<code>rm</code>是删除文件或目录，是<strong>不可逆操作</strong>。<br /><code>rm</code>后接文件名就可以了。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200827204738.gif" alt="" /></p><h2 id="选项"><a class="markdownIt-Anchor" href="#选项"></a> 选项</h2><p>如果想用<code>rm</code>删除目录，则应该加一个<code>-r</code>选项，代表递归删除。<br />如果想用<code>rm</code>删除前进行提示，则应该加一个<code>-i</code>选项。<br />如果想用<code>rm</code>强制删除，则应该加一个<code>-f</code>选项。<br />下面是这些选项的演示：</p><h3 id="递归删除"><a class="markdownIt-Anchor" href="#递归删除"></a> 递归删除</h3><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200827205022.gif" alt="" /></p><h3 id="删除前提示"><a class="markdownIt-Anchor" href="#删除前提示"></a> 删除前提示</h3><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200827205304.gif" alt="" /></p><h1 id="查阅命令帮助信息"><a class="markdownIt-Anchor" href="#查阅命令帮助信息"></a> 查阅命令帮助信息</h1><blockquote><p>提示</p><ul><li>现阶段只需要 <strong>知道</strong> 通过以下两种方式可以查询命令的帮助信息</li><li>先学习<strong>常用命令</strong>及<strong>常用选项</strong>的使用即可，工作中如果遇到问题可以借助 <strong>网络搜索</strong></li></ul></blockquote><h2 id="-help"><a class="markdownIt-Anchor" href="#-help"></a> <code>--help</code></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">command</span> --<span class="built_in">help</span></span><br></pre></td></tr></table></figure><p>说明：</p><ul><li>显示 <code>command</code> 命令的帮助信息</li><li>示例：<code>pwd --help</code></li></ul><h2 id="man"><a class="markdownIt-Anchor" href="#man"></a> man</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">man <span class="built_in">command</span></span><br></pre></td></tr></table></figure><p>说明：</p><ul><li>查阅 <code>command</code> 命令的使用手册</li><li>示例：<code>man pwd</code></li></ul><blockquote><p><code>man</code> 是 <strong>manual</strong> 的缩写，是 Linux 提供的一个 <strong>手册</strong>，包含了绝大部分的命令、函数的详细使用说明</p></blockquote><p>使用 <code>man</code> 时的操作键：</p><table><thead><tr><th>操作键</th><th>功能</th></tr></thead><tbody><tr><td>空格键</td><td>显示手册页的下一屏</td></tr><tr><td>Enter 键</td><td>一次滚动手册页的一行</td></tr><tr><td>b</td><td>回滚一屏</td></tr><tr><td>f</td><td>前滚一屏</td></tr><tr><td>q</td><td>退出</td></tr><tr><td>/word</td><td>搜索 <strong>word</strong> 字符串</td></tr></tbody></table><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/zoruasama/zoruasama.github.io@latest/css/mindmap.css">]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; href=&quot;https://use.fontawesome.com/releases/v5.0.13/css/all.css&quot;&gt;
&lt;h1 id=&quot;基础命令&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#基础
      
    
    </summary>
    
    
      <category term="Linux" scheme="https://zoruasama.gitee.io/categories/Linux/"/>
    
    
      <category term="Linux" scheme="https://zoruasama.gitee.io/tags/Linux/"/>
    
      <category term="操作系统" scheme="https://zoruasama.gitee.io/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>实训日记 | Day 20. 答辩的终稿</title>
    <link href="https://zoruasama.gitee.io/2020/08/20/training_20/"/>
    <id>https://zoruasama.gitee.io/2020/08/20/training_20/</id>
    <published>2020-08-20T11:30:00.000Z</published>
    <updated>2020-09-07T08:24:29.277Z</updated>
    
    <content type="html"><![CDATA[<h1 id="总述"><a class="markdownIt-Anchor" href="#总述"></a> 总述</h1><p>今天是8月14日，实训的第20天。实训的最后一天。<br />今天我如预期一样地完成了答辩，两位老师似乎对我的项目及答辩都还很满意。<br />看着自己完整的项目和老师的认可，我感到非常有成就感。<br />我能在这取得一个小小的进步，离不开孟老师的耐心教导，同学们友爱的帮助。<br />由于我今天中午又加了一些新的内容，所以也在这里再对昨天的内容进行补充。</p><h1 id="事先准备"><a class="markdownIt-Anchor" href="#事先准备"></a> 事先准备</h1><ul><li>另一块屏幕用来播放本文档</li><li>已经开启服务的项目（原项目，处于登录状态，数据仅有一页）</li><li>ZOL手机报价网站</li><li>360安全浏览器</li></ul><h1 id="简介"><a class="markdownIt-Anchor" href="#简介"></a> 简介</h1><ul><li>名称：指上云霄手机信息查阅系统</li><li>功能：提供爬虫和数据可视化两部分功能。<ul><li>爬虫：可以在页面上调用后台接口，爬取ZOL手机报价网站上的数据并存储到数据库中。</li><li>数据可视化：可以在页面上显示手机的相关数据信息。</li></ul></li></ul><h1 id="介绍数据爬取来源"><a class="markdownIt-Anchor" href="#介绍数据爬取来源"></a> 介绍数据爬取来源</h1><ul><li>手机报价首页</li><li>手机配置参数页</li><li>手机评价页面</li><li>bilibili搜索</li></ul><p>难点：ZOL手机报价的页面很多都不一样。对于一些没有评价或未上市的手机数据不予爬取。</p><h1 id="应用页面"><a class="markdownIt-Anchor" href="#应用页面"></a> 应用页面</h1><p>应用的页面有<strong>登录注册页面</strong>、<strong>数据可视化首页</strong>、<strong>爬虫页面</strong>、<strong>数据柱状图页面</strong>、<strong>关于页面</strong>五个页面。</p><h2 id="登录注册页面"><a class="markdownIt-Anchor" href="#登录注册页面"></a> 登录注册页面</h2><ul><li>在图1中点击注册按钮可切换为图2界面，图2界面点击返回按钮可切换为图1界面。</li><li>在<strong>注册登录界面</strong>，对填充的文本内容有长度和字符内容的限制。例如用户名和密码只能为字母和数字组成。</li><li>在此界面注册后，密码将以加密后的文本进行存储。</li><li><strong>如果还未登录，企图访问其他网页，则会自动跳转至登录注册页面</strong>。反之，若在登录后，访问该登录注册页面，将会自动跳转至首页。</li></ul><h2 id="数据可视化首页"><a class="markdownIt-Anchor" href="#数据可视化首页"></a> 数据可视化首页</h2><ul><li>数据可视化首页会在顶部显示<strong>当前的数据库条目数量</strong>。</li><li>数据可视化首页显示的手机信息的序列，将是一个<strong>随机序列</strong>。</li><li><strong>在刚载入页面时，首页只会显示8条数据。当滚轮被滑到底部时，将会再次载入至多4条数据。实现了动态加载数据的过程，直至数据库的所有数据都已呈现</strong>。<ul><li>每次载入的数据都是从后端被渲染完毕后，以HTML的形式插入的。</li></ul></li><li><strong>每个标签左侧会读取数据库中的基本信息并显示，右侧会以echarts雷达图的形式显示当前的数据和平均的数据。</strong></li><li>点击名字可以弹出bilibili的视频。</li></ul><h2 id="爬虫页面"><a class="markdownIt-Anchor" href="#爬虫页面"></a> 爬虫页面</h2><p>在文本框填入要爬取数据的第几页，点击爬虫，即可爬取数据。<br />数据来源是<strong>ZOL手机报价</strong>。</p><ul><li>如果选择的页号已经被爬取到数据库中，后端将会拒绝该爬取请求。</li><li>如果选择的页号不符合要求，后端也会拒绝该爬取请求。</li><li>清空数据库前，需要填入事先在后端设置好的密码。</li></ul><h2 id="数据柱状图页面"><a class="markdownIt-Anchor" href="#数据柱状图页面"></a> 数据柱状图页面</h2><p>该页面将会呈现数据库中所有条目的售价以及得分状况。通过调节图像四周的工具，可以获取不同的信息。<br />该页面将会呈现数据库中所有条目的售价以及得分状况。通过调节图像四周的工具，可以获取不同的信息。</p><ul><li>单击柱状条可以在下方显示手机信息卡片。</li><li>双击柱状条会自动跳转到和这个手机相关的B站视频链接。</li></ul><h2 id="关于页面"><a class="markdownIt-Anchor" href="#关于页面"></a> 关于页面</h2><p>关于页面比较简单，仅仅只是显示了本文档的<strong>简介</strong>部分的内容。在此不再赘述。</p><h1 id="接口"><a class="markdownIt-Anchor" href="#接口"></a> 接口</h1><p>接口分成两个模块，UserInfo模块和echarts模块。</p><h2 id="userinfo"><a class="markdownIt-Anchor" href="#userinfo"></a> UserInfo</h2><ul><li>index，被请求时，将会返回<strong>登录注册页面</strong>。</li><li>user_login，仅能被POST请求，参数为username和password。用于登录。</li><li>user_register，仅能被POST请求，参数为username和password及emailAddress。用于注册。</li><li>user_activate，能被GET请求，参数为id。用于注册账号的激活。将会返回一个JsonResponse。</li><li>is_login，参数为id。被请求时，会检查浏览器的session，查看是否登录。</li><li>user_logout，参数为id。被请求时，将会删除浏览器的session。</li></ul><h2 id="echarts"><a class="markdownIt-Anchor" href="#echarts"></a> echarts</h2><ul><li>空，被请求时，返回<strong>数据可视化首页</strong>。</li><li>run_page，被请求时，返回<strong>爬虫页面</strong>。</li><li>hot_page，被请求时，返回<strong>数据柱状图页面</strong>。</li><li>about，被请求时，返回<strong>关于页面</strong>。</li><li>timenow，被请求时，返回含有系统现行时间信息的JsonResponse。</li><li>run，参数为index，仅能被POST请求。被请求后，将会启动爬虫程序。</li><li>get_hot_json，被请求时，返回一个字典。字典内容为数据库中所有手机的名称、价格、分数数据。</li><li>delete，仅能被POST请求。将会清空数据库数据。</li><li>get_data，参数为index，将会从数据库中读取序号为index的手机数据并返回一个JsonResponse。</li><li>get_random_dict，以列表的形式产生一个随机的序列。</li><li>get_average，被请求时，将以JsonResponse返回数据库中所有数据的评分的平均值。</li><li>init_zorua_box，参数为index，将读取数据库中的数据，并对指定的HTML文件进行渲染，然后<strong>将渲染后的HTML文件返回</strong>。</li></ul><h1 id="数据库结构"><a class="markdownIt-Anchor" href="#数据库结构"></a> 数据库结构</h1><ul><li>User(id,username,password,is_activate)</li><li>Phone(id,name,price,img,score)</li><li>config(phone,soc,camera,camera_vice,ram,battery,screen_size,image)</li><li>evaluation(phone,cost_performance,performance,endurance,design,photograph)</li></ul><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/zoruasama/zoruasama.github.io@latest/css/mindmap.css">]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;总述&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#总述&quot;&gt;&lt;/a&gt; 总述&lt;/h1&gt;
&lt;p&gt;今天是8月14日，实训的第20天。实训的最后一天。&lt;br /&gt;
今天我如预期一样地完成了答辩，两位老师似乎对我的项目及答辩都还很满意。&lt;br /
      
    
    </summary>
    
    
      <category term="实训日记" scheme="https://zoruasama.gitee.io/categories/%E5%AE%9E%E8%AE%AD%E6%97%A5%E8%AE%B0/"/>
    
    
      <category term="Python" scheme="https://zoruasama.gitee.io/tags/Python/"/>
    
      <category term="实训" scheme="https://zoruasama.gitee.io/tags/%E5%AE%9E%E8%AE%AD/"/>
    
  </entry>
  
  <entry>
    <title>实训日记 | Day 19. 答辩的准备</title>
    <link href="https://zoruasama.gitee.io/2020/08/13/training_19/"/>
    <id>https://zoruasama.gitee.io/2020/08/13/training_19/</id>
    <published>2020-08-13T11:30:00.000Z</published>
    <updated>2020-09-07T08:24:12.539Z</updated>
    
    <content type="html"><![CDATA[<h1 id="总述"><a class="markdownIt-Anchor" href="#总述"></a> 总述</h1><p>今天是8月13日，实训的第19天。实训即将步入尾声。<br />今天是答辩的第一天。<br />而我是在第二天答辩。今天准备了一下答辩的思路。</p><h1 id="事先准备"><a class="markdownIt-Anchor" href="#事先准备"></a> 事先准备</h1><ul><li>另一块屏幕用来播放本文档</li><li>已经开启服务的项目（原项目，处于登录状态，数据仅有一页）</li><li>ZOL手机报价网站</li><li>360安全浏览器</li></ul><h1 id="简介"><a class="markdownIt-Anchor" href="#简介"></a> 简介</h1><ul><li>名称：指上云霄手机信息查阅系统</li><li>功能：提供爬虫和数据可视化两部分功能。<ul><li>爬虫：可以在页面上调用后台接口，爬取ZOL手机报价网站上的数据并存储到数据库中。</li><li>数据可视化：可以在页面上显示手机的相关数据信息。</li></ul></li></ul><h1 id="介绍数据爬取来源"><a class="markdownIt-Anchor" href="#介绍数据爬取来源"></a> 介绍数据爬取来源</h1><ul><li>手机报价首页</li><li>手机配置参数页</li><li>手机评价页面</li><li>bilibili搜索</li></ul><p>难点：ZOL手机报价的页面很多都不一样。对于一些没有评价或未上市的手机数据不予爬取。</p><h1 id="应用页面"><a class="markdownIt-Anchor" href="#应用页面"></a> 应用页面</h1><p>应用的页面有<strong>登录注册页面</strong>、<strong>数据可视化首页</strong>、<strong>爬虫页面</strong>、<strong>数据柱状图页面</strong>、<strong>关于页面</strong>五个页面。</p><h2 id="登录注册页面"><a class="markdownIt-Anchor" href="#登录注册页面"></a> 登录注册页面</h2><ul><li>在图1中点击注册按钮可切换为图2界面，图2界面点击返回按钮可切换为图1界面。</li><li>在<strong>注册登录界面</strong>，对填充的文本内容有长度和字符内容的限制。例如用户名和密码只能为字母和数字组成。</li><li>在此界面注册后，密码将以加密后的文本进行存储。</li><li><strong>如果还未登录，企图访问其他网页，则会自动跳转至登录注册页面</strong>。反之，若在登录后，访问该登录注册页面，将会自动跳转至首页。</li></ul><h2 id="数据可视化首页"><a class="markdownIt-Anchor" href="#数据可视化首页"></a> 数据可视化首页</h2><ul><li>数据可视化首页会在顶部显示<strong>当前的数据库条目数量</strong>。</li><li>数据可视化首页显示的手机信息的序列，将是一个<strong>随机序列</strong>。</li><li><strong>在刚载入页面时，首页只会显示8条数据。当滚轮被滑到底部时，将会再次载入至多4条数据。实现了动态加载数据的过程，直至数据库的所有数据都已呈现</strong>。<ul><li>每次载入的数据都是从后端被渲染完毕后，以HTML的形式插入的。</li></ul></li><li><strong>每个标签左侧会读取数据库中的基本信息并显示，右侧会以echarts雷达图的形式显示当前的数据和平均的数据。</strong></li><li>点击名字可以弹出bilibili的视频。</li></ul><h2 id="爬虫页面"><a class="markdownIt-Anchor" href="#爬虫页面"></a> 爬虫页面</h2><p>在文本框填入要爬取数据的第几页，点击爬虫，即可爬取数据。<br />数据来源是<strong>ZOL手机报价</strong>。</p><ul><li>如果选择的页号已经被爬取到数据库中，后端将会拒绝该爬取请求。</li><li>如果选择的页号不符合要求，后端也会拒绝该爬取请求。</li><li>清空数据库前，需要填入事先在后端设置好的密码。</li></ul><h2 id="数据柱状图页面"><a class="markdownIt-Anchor" href="#数据柱状图页面"></a> 数据柱状图页面</h2><p>该页面将会呈现数据库中所有条目的售价以及得分状况。通过调节图像四周的工具，可以获取不同的信息。</p><h2 id="关于页面"><a class="markdownIt-Anchor" href="#关于页面"></a> 关于页面</h2><p>关于页面比较简单，仅仅只是显示了本文档的<strong>简介</strong>部分的内容。在此不再赘述。</p><h1 id="接口"><a class="markdownIt-Anchor" href="#接口"></a> 接口</h1><p>接口分成两个模块，UserInfo模块和echarts模块。</p><h2 id="userinfo"><a class="markdownIt-Anchor" href="#userinfo"></a> UserInfo</h2><ul><li>index，被请求时，将会返回<strong>登录注册页面</strong>。</li><li>user_login，仅能被POST请求，参数为username和password。用于登录。</li><li>user_register，仅能被POST请求，参数为username和password及emailAddress。用于注册。</li><li>user_activate，能被GET请求，参数为id。用于注册账号的激活。将会返回一个JsonResponse。</li><li>is_login，参数为id。被请求时，会检查浏览器的session，查看是否登录。</li><li>user_logout，参数为id。被请求时，将会删除浏览器的session。</li></ul><h2 id="echarts"><a class="markdownIt-Anchor" href="#echarts"></a> echarts</h2><ul><li>空，被请求时，返回<strong>数据可视化首页</strong>。</li><li>run_page，被请求时，返回<strong>爬虫页面</strong>。</li><li>hot_page，被请求时，返回<strong>数据柱状图页面</strong>。</li><li>about，被请求时，返回<strong>关于页面</strong>。</li><li>timenow，被请求时，返回含有系统现行时间信息的JsonResponse。</li><li>run，参数为index，仅能被POST请求。被请求后，将会启动爬虫程序。</li><li>get_hot_json，被请求时，返回一个字典。字典内容为数据库中所有手机的名称、价格、分数数据。</li><li>delete，仅能被POST请求。将会清空数据库数据。</li><li>get_data，参数为index，将会从数据库中读取序号为index的手机数据并返回一个JsonResponse。</li><li>get_random_dict，以列表的形式产生一个随机的序列。</li><li>get_average，被请求时，将以JsonResponse返回数据库中所有数据的评分的平均值。</li><li>init_zorua_box，参数为index，将读取数据库中的数据，并对指定的HTML文件进行渲染，然后<strong>将渲染后的HTML文件返回</strong>。</li></ul><h1 id="数据库结构"><a class="markdownIt-Anchor" href="#数据库结构"></a> 数据库结构</h1><ul><li>User(id,username,password,is_activate)</li><li>Phone(id,name,price,img,score)</li><li>config(phone,soc,camera,camera_vice,ram,battery,screen_size,image)</li><li>evaluation(phone,cost_performance,performance,endurance,design,photograph)</li></ul><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/zoruasama/zoruasama.github.io@latest/css/mindmap.css">]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;总述&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#总述&quot;&gt;&lt;/a&gt; 总述&lt;/h1&gt;
&lt;p&gt;今天是8月13日，实训的第19天。实训即将步入尾声。&lt;br /&gt;
今天是答辩的第一天。&lt;br /&gt;
而我是在第二天答辩。今天准备了一下答辩的思路
      
    
    </summary>
    
    
      <category term="实训日记" scheme="https://zoruasama.gitee.io/categories/%E5%AE%9E%E8%AE%AD%E6%97%A5%E8%AE%B0/"/>
    
    
      <category term="Python" scheme="https://zoruasama.gitee.io/tags/Python/"/>
    
      <category term="实训" scheme="https://zoruasama.gitee.io/tags/%E5%AE%9E%E8%AE%AD/"/>
    
  </entry>
  
  <entry>
    <title>实训日记 | Day 18. 我的项目介绍</title>
    <link href="https://zoruasama.gitee.io/2020/08/12/training_18/"/>
    <id>https://zoruasama.gitee.io/2020/08/12/training_18/</id>
    <published>2020-08-12T11:30:00.000Z</published>
    <updated>2020-09-07T08:23:51.677Z</updated>
    
    <content type="html"><![CDATA[<h1 id="总述"><a class="markdownIt-Anchor" href="#总述"></a> 总述</h1><p>今天是8月12日，实训的第18天。实训即将步入尾声。<br />今天孟老师依然全天给同学们进行答疑。<br />我整理了一下我的项目的相关信息以准备明天后天的答辩。<br />整理内容如下。</p><h1 id="简介"><a class="markdownIt-Anchor" href="#简介"></a> 简介</h1><ul><li>名称：指上云霄手机信息查阅系统</li><li>功能：提供爬虫和数据可视化两部分功能。<ul><li>爬虫：可以在页面上调用后台接口，爬取ZOL手机报价网站上的数据并存储到数据库中。</li><li>数据可视化：可以在页面上显示手机的相关数据信息。</li></ul></li><li>开发工具：PyCharm</li><li>后台开发语言：Python3</li><li>前端开发语言：HTML5+CSS+JavaScript</li><li>作者：张仁忠(Zorua) 2018065527</li><li>指导老师：孟老师（mzm5466）</li></ul><h1 id="应用页面"><a class="markdownIt-Anchor" href="#应用页面"></a> 应用页面</h1><p>应用的页面有<strong>登录注册页面</strong>、<strong>数据可视化首页</strong>、<strong>爬虫页面</strong>、<strong>数据柱状图页面</strong>、<strong>关于页面</strong>五个页面。</p><h2 id="登录注册页面"><a class="markdownIt-Anchor" href="#登录注册页面"></a> 登录注册页面</h2><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/1597240970_20200812210057628_27841.png" alt="" /><br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/1597240972_20200812210113431_24575.png" alt="" /></p><ul><li>在图1中点击注册按钮可切换为图2界面，图2界面点击返回按钮可切换为图1界面。</li><li>在<strong>注册登录界面</strong>，对填充的文本内容有长度和字符内容的限制。例如用户名和密码只能为字母和数字组成。</li><li>在此界面注册后，密码将以加密后的文本进行存储。</li><li><strong>如果还未登录，企图访问其他网页，则会自动跳转至登录注册页面</strong>。反之，若在登录后，访问该登录注册页面，将会自动跳转至首页。</li></ul><h2 id="数据可视化首页"><a class="markdownIt-Anchor" href="#数据可视化首页"></a> 数据可视化首页</h2><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/1597240973_20200812210444412_15098.png" alt="" /></p><ul><li>数据可视化首页会在顶部显示<strong>当前的数据库条目数量</strong>。</li><li>数据可视化首页显示的手机信息的序列，将是一个<strong>随机序列</strong>。</li><li><strong>在刚载入页面时，首页只会显示8条数据。当滚轮被滑到底部时，将会再次载入至多4条数据。实现了动态加载数据的过程，直至数据库的所有数据都已呈现</strong>。<ul><li>每次载入的数据都是从后端被渲染完毕后，以HTML的形式插入的。</li></ul></li><li><strong>每个标签左侧会读取数据库中的基本信息并显示，右侧会以echarts雷达图的形式显示当前的数据和平均的数据。</strong></li></ul><h2 id="爬虫页面"><a class="markdownIt-Anchor" href="#爬虫页面"></a> 爬虫页面</h2><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/1597240973_20200812212702692_31578.png" alt="" /><br />在文本框填入要爬取数据的第几页，点击爬虫，即可爬取数据。<br />数据来源是<strong>ZOL手机报价</strong>。</p><ul><li>如果选择的页号已经被爬取到数据库中，后端将会拒绝该爬取请求。</li><li>如果选择的页号不符合要求，后端也会拒绝该爬取请求。</li><li>清空数据库前，需要填入事先在后端设置好的密码。</li></ul><h2 id="数据柱状图页面"><a class="markdownIt-Anchor" href="#数据柱状图页面"></a> 数据柱状图页面</h2><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/1597240973_20200812212945780_14328.png" alt="" /><br />该页面将会呈现数据库中所有条目的售价以及得分状况。通过调节图像四周的工具，可以获取不同的信息。</p><h2 id="关于页面"><a class="markdownIt-Anchor" href="#关于页面"></a> 关于页面</h2><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/1597240974_20200812214757439_29652.png" alt="" /><br />关于页面比较简单，仅仅只是显示了本文档的<strong>简介</strong>部分的内容。在此不再赘述。</p><h1 id="接口"><a class="markdownIt-Anchor" href="#接口"></a> 接口</h1><p>接口分成两个模块，UserInfo模块和echarts模块。</p><h2 id="userinfo"><a class="markdownIt-Anchor" href="#userinfo"></a> UserInfo</h2><ul><li>index，被请求时，将会返回<strong>登录注册页面</strong>。</li><li>user_login，仅能被POST请求，参数为username和password。用于登录。</li><li>user_register，仅能被POST请求，参数为username和password及emailAddress。用于注册。</li><li>user_activate，能被GET请求，参数为id。用于注册账号的激活。将会返回一个JsonResponse。</li><li>is_login，参数为id。被请求时，会检查浏览器的session，查看是否登录。</li><li>user_logout，参数为id。被请求时，将会删除浏览器的session。</li></ul><h2 id="echarts"><a class="markdownIt-Anchor" href="#echarts"></a> echarts</h2><ul><li>空，被请求时，返回<strong>数据可视化首页</strong>。</li><li>run_page，被请求时，返回<strong>爬虫页面</strong>。</li><li>hot_page，被请求时，返回<strong>数据柱状图页面</strong>。</li><li>about，被请求时，返回<strong>关于页面</strong>。</li><li>timenow，被请求时，返回含有系统现行时间信息的JsonResponse。</li><li>run，参数为index，仅能被POST请求。被请求后，将会启动爬虫程序。</li><li>get_hot_json，被请求时，返回一个字典。字典内容为数据库中所有手机的名称、价格、分数数据。</li><li>delete，仅能被POST请求。将会清空数据库数据。</li><li>get_data，参数为index，将会从数据库中读取序号为index的手机数据并返回一个JsonResponse。</li><li>get_random_dict，以列表的形式产生一个随机的序列。</li><li>get_average，被请求时，将以JsonResponse返回数据库中所有数据的评分的平均值。</li><li>init_zorua_box，参数为index，将读取数据库中的数据，并对指定的HTML文件进行渲染，然后<strong>将渲染后的HTML文件返回</strong>。</li></ul><h1 id="数据库结构"><a class="markdownIt-Anchor" href="#数据库结构"></a> 数据库结构</h1><ul><li>User(id,username,password,is_activate)</li><li>Phone(id,name,price,img,score)</li><li>config(phone,soc,camera,camera_vice,ram,battery,screen_size,image)</li><li>evaluation(phone,cost_performance,performance,endurance,design,photograph)</li></ul><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/zoruasama/zoruasama.github.io@latest/css/mindmap.css">]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;总述&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#总述&quot;&gt;&lt;/a&gt; 总述&lt;/h1&gt;
&lt;p&gt;今天是8月12日，实训的第18天。实训即将步入尾声。&lt;br /&gt;
今天孟老师依然全天给同学们进行答疑。&lt;br /&gt;
我整理了一下我的项目的相关信
      
    
    </summary>
    
    
      <category term="实训日记" scheme="https://zoruasama.gitee.io/categories/%E5%AE%9E%E8%AE%AD%E6%97%A5%E8%AE%B0/"/>
    
    
      <category term="Python" scheme="https://zoruasama.gitee.io/tags/Python/"/>
    
      <category term="实训" scheme="https://zoruasama.gitee.io/tags/%E5%AE%9E%E8%AE%AD/"/>
    
  </entry>
  
  <entry>
    <title>实训日记 | Day 17. 一些乱七八糟的随笔</title>
    <link href="https://zoruasama.gitee.io/2020/08/11/training_17/"/>
    <id>https://zoruasama.gitee.io/2020/08/11/training_17/</id>
    <published>2020-08-11T11:30:00.000Z</published>
    <updated>2020-09-07T08:23:32.393Z</updated>
    
    <content type="html"><![CDATA[<h1 id="总述"><a class="markdownIt-Anchor" href="#总述"></a> 总述</h1><p>今天是8月11日，实训的第17天。实训即将步入尾声。<br />今天孟老师全程在给同学答疑，但是由于我的大作业已经完成了，基本上没有什么问题需要向孟老师询问。<br />所以今天的日志就写一写，在答疑过程中，收获的几个比较有意思的知识点吧。</p><h1 id="eval"><a class="markdownIt-Anchor" href="#eval"></a> eval()</h1><h2 id="描述"><a class="markdownIt-Anchor" href="#描述"></a> 描述</h2><p>eval() 函数是python内置函数，用来执行一个字符串表达式，并返回表达式的值。</p><h3 id="语法"><a class="markdownIt-Anchor" href="#语法"></a> 语法</h3><p>以下是 eval() 方法的语法:<br />eval(expression[, globals[, locals]])</p><h3 id="参数"><a class="markdownIt-Anchor" href="#参数"></a> 参数</h3><ul><li>expression – 表达式。</li><li>globals – 变量作用域，全局命名空间，如果被提供，则必须是一个字典对象。</li><li>locals – 变量作用域，局部命名空间，如果被提供，可以是任何映射对象。</li></ul><h3 id="返回值"><a class="markdownIt-Anchor" href="#返回值"></a> 返回值</h3><p>返回表达式计算结果。</p><h2 id="实例"><a class="markdownIt-Anchor" href="#实例"></a> 实例</h2><p>以下展示了使用 eval() 方法的实例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;x &#x3D; 7</span><br><span class="line">&gt;&gt;&gt; eval( &#39;3 * x&#39; )</span><br><span class="line">21</span><br><span class="line">&gt;&gt;&gt; eval(&#39;pow(2,2)&#39;)</span><br><span class="line">4</span><br><span class="line">&gt;&gt;&gt; eval(&#39;2 + 2&#39;)</span><br><span class="line">4</span><br><span class="line">&gt;&gt;&gt; n&#x3D;81</span><br><span class="line">&gt;&gt;&gt; eval(&quot;n + 4&quot;)</span><br><span class="line">85</span><br></pre></td></tr></table></figure><h2 id="感悟"><a class="markdownIt-Anchor" href="#感悟"></a> 感悟</h2><p>用这个eval()函数，我可以将一个列表以字符串的形式存储在一个文件中，然后读取文件并把数据作为eval()的函数，就可变成python中的列表对象。<br />我将这个特性应用在了我的大作业中，体现在可以“对已经爬取过数据的页码进行存档”。</p><h1 id="html的for循环"><a class="markdownIt-Anchor" href="#html的for循环"></a> html的for循环</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span></span><br><span class="line"><span class="css">            <span class="selector-class">.top</span>&#123;</span></span><br><span class="line">                float: left;</span><br><span class="line">                margin-left: 22px;</span><br><span class="line">                margin-top: 30px;</span><br><span class="line">                height: 320px;</span><br><span class="line">                width: 240px;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="css">            <span class="selector-class">.top</span> <span class="selector-tag">img</span>&#123;</span></span><br><span class="line">                width: 100%;</span><br><span class="line">                height: 100%;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"top"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"tu1"</span> <span class="attr">src</span>=<span class="string">"../pic/1.jpg"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">//1、先用js获取到div的内容</span></span></span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.getElementsByClassName(<span class="string">'top'</span>).innerHTML;</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> re = <span class="string">""</span>;</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> tu = <span class="number">1</span>;</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++) &#123;</span></span><br><span class="line">        tu++;</span><br><span class="line"><span class="handlebars"><span class="xml">        re += '<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"top"</span>&gt;</span>' +</span></span></span><br><span class="line"><span class="handlebars"><span class="xml">            '<span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"tu1"</span> <span class="attr">src</span>=<span class="string">"../pic/'+tu+'.jpg"</span>&gt;</span>' +</span></span></span><br><span class="line"><span class="actionscript">            <span class="string">'&lt;/div&gt;'</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.writeln(re);</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>就像上面这段代码一样，可以在html里应用“for”循环来重复div元素。<br />众所周知，html并不被认为是一种编程语言，我也是这么想的，但是html里还有for循环实在让我有些惊讶。<br />可用来实现画面的渲染。（但是我的大作业中不是以这种方式实现的，而是以后端渲染html页面后，插入到已存在的标签中。）</p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/zoruasama/zoruasama.github.io@latest/css/mindmap.css">]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;总述&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#总述&quot;&gt;&lt;/a&gt; 总述&lt;/h1&gt;
&lt;p&gt;今天是8月11日，实训的第17天。实训即将步入尾声。&lt;br /&gt;
今天孟老师全程在给同学答疑，但是由于我的大作业已经完成了，基本上没有什么问题需
      
    
    </summary>
    
    
      <category term="实训日记" scheme="https://zoruasama.gitee.io/categories/%E5%AE%9E%E8%AE%AD%E6%97%A5%E8%AE%B0/"/>
    
    
      <category term="Python" scheme="https://zoruasama.gitee.io/tags/Python/"/>
    
      <category term="实训" scheme="https://zoruasama.gitee.io/tags/%E5%AE%9E%E8%AE%AD/"/>
    
  </entry>
  
  <entry>
    <title>实训日记 | Day 16. 服务器的部署</title>
    <link href="https://zoruasama.gitee.io/2020/08/10/training_16/"/>
    <id>https://zoruasama.gitee.io/2020/08/10/training_16/</id>
    <published>2020-08-10T11:30:00.000Z</published>
    <updated>2020-09-07T08:23:04.666Z</updated>
    
    <content type="html"><![CDATA[<h1 id="总述"><a class="markdownIt-Anchor" href="#总述"></a> 总述</h1><p>今天是8月10日，实训的第16天。<br />上午孟老师演示了如何将Django项目部署在云服务器上。<br />由于我没有云服务器，因此用装有Centos7的虚拟机来代替。<br />将项目部署在虚拟机上的过程也不算容易，途中遇到了不少坎坷。例如我的centos在刚开始时连不上网络，rc命令无法上传等等。<br />靠着不断百度到的CSDN的资料还是艰难地克服了难题，完成了部署。<br />今天还有部分关于Nginx的还未讲授完，为保证该笔记的一体性，我也加上去了。</p><h1 id="ssh设置"><a class="markdownIt-Anchor" href="#ssh设置"></a> SSH设置</h1><h2 id="启动ssh服务"><a class="markdownIt-Anchor" href="#启动ssh服务"></a> 启动ssh服务</h2><p>在打开centos虚拟机后，先用<code>yum install openssh* -y</code>安装开启SSH必备的程序。<br />而后用<code>vi /etc/ssh/sshd config</code>命令打开sshd的配置文件。<br />修改内容为：</p><ul><li><code>ListenAddress 0.0.0.0</code>和<code>ListenAddress ::</code>的井号去掉。</li><li><code>PermitRootLogin</code>前的井号去掉。</li></ul><p>完成这些操作后，用<code>systemctl restart sshd</code>指令重启sshd服务。</p><h2 id="查询ip地址"><a class="markdownIt-Anchor" href="#查询ip地址"></a> 查询IP地址</h2><p>接下来使用<code>ifconfig</code>来查询虚拟机的IP地址。<br />由于我的centos7没有内置ifconfig命令，因此需要进行额外的安装。<br />通过<code>yum search ifconfig</code>命令发现，ifconfig命令在net-tools.x86_64这个包里。<br />因此使用<code>yum install net-tools.x86_64</code>命令来进行安装。</p><h2 id="建立ssh连接"><a class="markdownIt-Anchor" href="#建立ssh连接"></a> 建立SSH连接</h2><p>在配置完SSH服务和获取IP地址后，在本机上的XShell或者其他能SSH连接的shell中输入<code>ssh ip address</code>进行连接。<br />通过命令<code>sudo apt install lrzsz unzip -y</code>解压缩上传工具，但由于我安装成功后也无法使用<code>rc</code>命令，因此只能采用<code>scp</code>命令。<br />形如<code>scp a.txt root@ip:/home</code>的命令，来完成文件的上传。</p><p>ln -s /usr/local/python3/bin/uwsgi /usr/bin/uwsgi 创建软连接</p><h1 id="安装python3"><a class="markdownIt-Anchor" href="#安装python3"></a> 安装python3</h1><p>centos自带了一个python2，但是没有python3。因此需要安装一个python3。依照以下步骤即可完成python3的安装。</p><ol><li>拉取远程包<code>yum install wget -y</code></li><li>安装编译时需要的程序<code>yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel python-devel gcc make -y</code></li><li>在home创建一个目录<code>mkdir python37</code></li><li>切换到目标文件夹 <code>cd python37/</code></li><li>获取python的源文件 <code>wget https://www.python.org/ftp/python/3.7.2/Python-3.7.2.tar.xz</code><ul><li>直接从官网获取速度会比较慢，因此也可以使用阿里云的源<code>https://npm.taobao.org/mirrors/python/3.7.2/Python-3.7.2.tar.xz</code></li></ul></li><li>使用tar命令进行解压 <code>tar -xvJf Python-3.7.2.tar.xz</code></li><li>进入解压后的目录，指定编译路径 <code>./configure prefix=/usr/local/python3</code></li><li>进行文件的编译<code>make &amp;&amp; make install</code><ul><li>如果报错ModuleNotFoundError: No module named ‘_ctypes’，则<code>yum install libffi-devel –y</code></li></ul></li><li>删除旧的python2 <code>rm -rf /usr/bin/python</code></li><li>创建软连接 <code>ln -s /usr/local/python3/bin/python3 /usr/bin/python</code></li><li>修改yum vim <code>/usr/bin/yum</code></li><li><code>vim /usr/libexec/urlgrabber-ext-down</code></li><li>永久换pip源  <code>mkdir ~/.pip</code></li><li>vim <code>~/.pip/pip.conf</code></li><li>在前一步文件都迁移过来后，安装工程项目所需的包。</li></ol><pre><code>+ `python -m pip install -r r.txt -i https://pypi.tuna.tsinghua.edu.cn/simple`+ 其中`r.txt`的内容是，工程项目所需要的包的名字。一行一个。</code></pre><h1 id="uwsgi部署"><a class="markdownIt-Anchor" href="#uwsgi部署"></a> uwsgi部署</h1><p>uwsgi --ini uwsgi.ini 前台以http方式启动uwsgi<br />uwsgi -d --ini uwsgi.ini 以后台运行uwsgi<br />pkill -f uwsgi -9 杀死uwsgi服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[uwsgi]</span><br><span class="line">chdir &#x3D; &#x2F;home&#x2F;qd201909dj #设置项目根目录</span><br><span class="line">module &#x3D; qd201909dj.wsgi:application #设置项目启动器</span><br><span class="line">master &#x3D; true  #设置主节点</span><br><span class="line">processes &#x3D; 1  #设置进程数</span><br><span class="line">http &#x3D; 0.0.0.0:80  #以http形式访问</span><br><span class="line">chmod-socket &#x3D; 644</span><br><span class="line">vacuum &#x3D; true #服务停止杀死pid</span><br><span class="line">logto &#x3D; &#x2F;home&#x2F;qd201909dj&#x2F;test.log  #输出日志</span><br><span class="line">pidfile &#x3D; &#x2F;home&#x2F;qd201909dj&#x2F;uwsgi.pid  #pid文件</span><br><span class="line">static-map &#x3D; &#x2F;static &#x3D;  &#x2F;home&#x2F;qd201909dj&#x2F; 静态文件</span><br><span class="line">py-autoreload &#x3D; 1  #修改后自动重启项目（生产不可用）</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Nginx</span><br><span class="line">server&#123;</span><br><span class="line">    listen        80;</span><br><span class="line">    server_name   39.100.6.138;</span><br><span class="line">    charset       utf-8;</span><br><span class="line"></span><br><span class="line">    client_max_body_size 75M;</span><br><span class="line"></span><br><span class="line">    location &#x2F;static &#123;</span><br><span class="line">        alias &#x2F;home&#x2F;qd201909dj;</span><br><span class="line">    &#125;</span><br><span class="line">    location &#x2F; &#123;</span><br><span class="line">        uwsgi_pass 127.0.0.1:8888;</span><br><span class="line">        include     &#x2F;etc&#x2F;nginx&#x2F;uwsgi_params;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="生成文件服务器"><a class="markdownIt-Anchor" href="#生成文件服务器"></a> 生成文件服务器</h2><ol><li>yum install httpd-tools -y</li><li>htpasswd -bc /home/htpasswd python（用户名） python2019（密码）</li><li>配置文件</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">server&#123;</span><br><span class="line">    listen        9999;</span><br><span class="line">    server_name   39.100.6.138;</span><br><span class="line">    charset       utf-8;</span><br><span class="line">    location &#x2F; &#123;</span><br><span class="line">       auth_basic &quot;input your user name and password&quot;;</span><br><span class="line">       auth_basic_user_file     &#x2F;home&#x2F;htpasswd;#密码文件</span><br><span class="line">       autoindex on;  #自动展示索引文件</span><br><span class="line">       root &#x2F;home&#x2F;;  #显示的目录</span><br><span class="line">    &#125;</span><br><span class="line">    location ^*\.(*)$ &#123;</span><br><span class="line">        add_header Content-Type text&#x2F;plain;</span><br><span class="line">        root &#x2F;home&#x2F;;   ##匹配下载的目录</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/zoruasama/zoruasama.github.io@latest/css/mindmap.css">]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;总述&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#总述&quot;&gt;&lt;/a&gt; 总述&lt;/h1&gt;
&lt;p&gt;今天是8月10日，实训的第16天。&lt;br /&gt;
上午孟老师演示了如何将Django项目部署在云服务器上。&lt;br /&gt;
由于我没有云服务器，因此用
      
    
    </summary>
    
    
      <category term="实训日记" scheme="https://zoruasama.gitee.io/categories/%E5%AE%9E%E8%AE%AD%E6%97%A5%E8%AE%B0/"/>
    
    
      <category term="Python" scheme="https://zoruasama.gitee.io/tags/Python/"/>
    
      <category term="实训" scheme="https://zoruasama.gitee.io/tags/%E5%AE%9E%E8%AE%AD/"/>
    
  </entry>
  
  <entry>
    <title>实训日记 | Day 15. Django打分系统示例</title>
    <link href="https://zoruasama.gitee.io/2020/08/07/training_15/"/>
    <id>https://zoruasama.gitee.io/2020/08/07/training_15/</id>
    <published>2020-08-07T11:30:00.000Z</published>
    <updated>2020-09-07T08:22:02.012Z</updated>
    
    <content type="html"><![CDATA[<h1 id="总述"><a class="markdownIt-Anchor" href="#总述"></a> 总述</h1><p>今天是8月7日，实训的第15天。<br />上午孟老师演示了如何用Django做一个打分系统，先是分析需求——<br />打分系统需要满足：</p><ul><li>录入学生信息</li><li>添加评委账号</li><li>企业打分占比50%</li><li>校内打分占比50%</li><li>成绩汇总显示</li><li>导出成绩 查询账号 可查分数 学号</li></ul><p>下午主要是帮助同学们答疑。由于我的项目已经接近尾声，所以我比较闲，我也就跟着帮助同学了。</p><h1 id="打分系统"><a class="markdownIt-Anchor" href="#打分系统"></a> 打分系统</h1><h2 id="数据库的建立"><a class="markdownIt-Anchor" href="#数据库的建立"></a> 数据库的建立</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Create your models here.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserTeacher</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    username =models.CharField(max_length=<span class="number">20</span>,verbose_name=<span class="string">'用户名'</span>)</span><br><span class="line">    password = models.CharField(max_length=<span class="number">20</span>,verbose_name=<span class="string">'密码'</span>)</span><br><span class="line">    nickname =  models.CharField(max_length=<span class="number">20</span>,verbose_name=<span class="string">'昵称'</span>)</span><br><span class="line">    kind = models.IntegerField(verbose_name=<span class="string">'是否企业老师'</span>) <span class="comment">#0不是 1 是</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.nickname</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        verbose_name = <span class="string">'教师账号'</span></span><br><span class="line">        verbose_name_plural = verbose_name</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StundentInfo</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    username = models.CharField(max_length=<span class="number">20</span>,verbose_name=<span class="string">'用户名'</span>)</span><br><span class="line">    password = models.CharField(max_length=<span class="number">20</span>,verbose_name=<span class="string">'密码'</span>,default=<span class="string">'123456'</span>)</span><br><span class="line">    nickname =  models.CharField(max_length=<span class="number">20</span>,verbose_name=<span class="string">'昵称'</span>)</span><br><span class="line">    score = models.IntegerField(verbose_name=<span class="string">'总得分'</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.username+<span class="string">"_"</span>+self.nickname</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        verbose_name = <span class="string">'学生账号'</span></span><br><span class="line">        verbose_name_plural = verbose_name</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CompanyScore</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    score1 = models.IntegerField(verbose_name=<span class="string">'寻求解决方案的能力'</span>)</span><br><span class="line">    score2 = models.IntegerField(verbose_name=<span class="string">'综合应用分析的能力'</span>)</span><br><span class="line">    score3 = models.IntegerField(verbose_name=<span class="string">'考虑社会等因素'</span>)</span><br><span class="line">    score4 = models.IntegerField(verbose_name=<span class="string">'工具的选择和使用能力'</span>)</span><br><span class="line">    score5 = models.IntegerField(verbose_name=<span class="string">'沟通交流能力'</span>)</span><br><span class="line">    score6 = models.IntegerField(verbose_name=<span class="string">'考勤'</span>)</span><br><span class="line">    student = models.ForeignKey(StundentInfo,on_delete=models.CASCADE,verbose_name=<span class="string">'学生'</span>)</span><br><span class="line">    teacher = models.ForeignKey(UserTeacher,on_delete=models.CASCADE,verbose_name=<span class="string">'老师'</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.student.nickname,self.teacher.nickname,self.student.username</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        verbose_name = <span class="string">'企业打分'</span></span><br><span class="line">        verbose_name_plural = verbose_name</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SchoolScore</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    score1 = models.IntegerField(verbose_name=<span class="string">'实习日志'</span>)</span><br><span class="line">    score2 = models.IntegerField(verbose_name=<span class="string">'实习报告'</span>)</span><br></pre></td></tr></table></figure><h2 id="视图的建立"><a class="markdownIt-Anchor" href="#视图的建立"></a> 视图的建立</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render,redirect</span><br><span class="line"><span class="keyword">from</span> api.models <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> JsonResponse</span><br><span class="line"><span class="keyword">from</span> django.forms.models <span class="keyword">import</span> model_to_dict</span><br><span class="line"><span class="keyword">from</span> django.views.decorators.csrf <span class="keyword">import</span> csrf_exempt</span><br><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"><span class="meta">@csrf_exempt</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> request.method==<span class="string">'POST'</span>:</span><br><span class="line">        username = request.POST.get(<span class="string">'username'</span>)</span><br><span class="line">        password = request.POST.get(<span class="string">'password'</span>)</span><br><span class="line">        user_check=UserTeacher.objects.filter(username=username,password=password)</span><br><span class="line">        <span class="keyword">if</span> user_check:</span><br><span class="line">            request.session[<span class="string">'techer_id'</span>]=user_check.first().id</span><br><span class="line">            <span class="keyword">return</span> redirect(<span class="string">'/student_page/'</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> JsonResponse(&#123;<span class="string">'data'</span>: <span class="string">'登陆失败'</span>&#125;)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render(request,<span class="string">'login.html'</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">@csrf_exempt</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_score_by_company</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> request.method==<span class="string">'POST'</span>:</span><br><span class="line">        username=request.POST.get(<span class="string">'username'</span>)</span><br><span class="line">        teacher_id=request.session[<span class="string">'techer_id'</span>]</span><br><span class="line">        has_score=CompanyScore.objects.filter(teacher_id=teacher_id)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> has_score:</span><br><span class="line">            student_id=StundentInfo.objects.get(username=username).id</span><br><span class="line">            systemDict = &#123;&#125;</span><br><span class="line">            <span class="keyword">for</span> key <span class="keyword">in</span> request.POST:</span><br><span class="line">                systemDict[key] = request.POST.get(key)</span><br><span class="line">            <span class="keyword">del</span> systemDict[<span class="string">'username'</span>]</span><br><span class="line">            CompanyScore.objects.create(**systemDict,teacher_id=teacher_id,student_id=student_id).save()</span><br><span class="line">            <span class="keyword">return</span> JsonResponse(&#123;<span class="string">'data'</span>: <span class="string">'打分成功'</span>&#125;)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> JsonResponse(&#123;<span class="string">'data'</span>: <span class="string">'您已经为该同学打过分了，请勿重复打分'</span>&#125;)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">'company_score.html'</span>)</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_score_by_school</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> request.method==<span class="string">'POST'</span>:</span><br><span class="line">        username=request.POST.get(<span class="string">'username'</span>)</span><br><span class="line">        teacher_id=request.session[<span class="string">'techer_id'</span>]</span><br><span class="line">        has_score=SchoolScore.objects.filter(teacher_id=teacher_id)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> has_score:</span><br><span class="line">            student_id=StundentInfo.objects.get(username=username).id</span><br><span class="line">            systemDict = &#123;&#125;</span><br><span class="line">            <span class="keyword">for</span> key <span class="keyword">in</span> request.POST:</span><br><span class="line">                systemDict[key] = request.POST.get(key)</span><br><span class="line">            <span class="keyword">del</span> systemDict[<span class="string">'username'</span>]</span><br><span class="line">            SchoolScore.objects.create(**systemDict,teacher_id=teacher_id,student_id=student_id).save()</span><br><span class="line">            <span class="keyword">return</span> JsonResponse(&#123;<span class="string">'data'</span>: <span class="string">'打分成功'</span>&#125;)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> JsonResponse(&#123;<span class="string">'data'</span>: <span class="string">'您已经为该同学打过分了，请勿重复打分'</span>&#125;)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">'shcool_score.html'</span>)</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">score_all</span><span class="params">(request)</span>:</span></span><br><span class="line">    username = request.POST.get(<span class="string">'username'</span>)</span><br><span class="line">    student_id = StundentInfo.objects.get(username=username).id</span><br><span class="line">    cs = CompanyScore.objects.filter(student_id=student_id)</span><br><span class="line">    ss = SchoolScore.objects.filter(student_id=student_id)</span><br><span class="line">    list_cs=[]</span><br><span class="line">    list_ss=[]</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> cs:</span><br><span class="line">        list_cs.append(model_to_dict(c,exclude=[<span class="string">'student_id'</span>,<span class="string">'teacher_id'</span>]))</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> ss:</span><br><span class="line">        list_ss.append(model_to_dict(s,exclude=[<span class="string">'student_id'</span>,<span class="string">'teacher_id'</span>]))</span><br><span class="line">    cs_all=zip(*map(<span class="keyword">lambda</span> x: (x[<span class="string">'score1'</span>], x[<span class="string">'score2'</span>],x[<span class="string">'score3'</span>],x[<span class="string">'score4'</span>],x[<span class="string">'score5'</span>],x[<span class="string">'score6'</span>]), list_cs))</span><br><span class="line">    sum_cs=<span class="number">0</span> <span class="comment">#((1,2),(3,4),(5,6))</span></span><br><span class="line">    <span class="keyword">for</span> index,i <span class="keyword">in</span> enumerate(cs_all):</span><br><span class="line">        sum_cs+=sum(list(i))/len(i)</span><br><span class="line">    ss_all=zip(*map(<span class="keyword">lambda</span> x: (x[<span class="string">'score1'</span>], x[<span class="string">'score2'</span>],x[<span class="string">'score3'</span>]), list_ss))</span><br><span class="line">    sum_ss=<span class="number">0</span> <span class="comment">#((1,2),(3,4),(5,6))</span></span><br><span class="line">    <span class="keyword">for</span> index,i <span class="keyword">in</span> enumerate(ss_all):</span><br><span class="line">        sum_ss+=sum(list(i))/len(i)</span><br><span class="line">    total_score = sum_cs + sum_ss</span><br><span class="line">    StundentInfo.objects.filter(username=username).update(score=total_score)</span><br><span class="line">    <span class="keyword">return</span> JsonResponse(&#123;<span class="string">'data'</span>: <span class="string">'成绩核算成功'</span>&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">student_list</span><span class="params">(request)</span>:</span></span><br><span class="line">    all_stus=StundentInfo.objects.all()</span><br></pre></td></tr></table></figure><h2 id="登录界面"><a class="markdownIt-Anchor" href="#登录界面"></a> 登录界面</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"box"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/login/"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"username"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"password"</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"登陆"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="学生列表界面"><a class="markdownIt-Anchor" href="#学生列表界面"></a> 学生列表界面</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;学生列表&lt;/title&gt;</span><br><span class="line">    &lt;script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"&gt;&lt;/script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;table&gt;</span><br><span class="line">    &lt;thead&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;序号&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;学号&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;姓名&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;操作&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;/thead&gt;</span><br><span class="line">    &lt;tbody&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;/tbody&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url:<span class="string">'/student_list/'</span>,</span><br><span class="line">        type:<span class="string">'get'</span>,</span><br><span class="line">        dataType:<span class="string">'json'</span>,</span><br><span class="line">        success:function (res) &#123;</span><br><span class="line">          <span class="keyword">for</span>(var i = <span class="number">0</span>;i&lt;res.data.length;i++)&#123;</span><br><span class="line">              var htmlStr=<span class="string">'&lt;tr&gt;\n'</span> +</span><br><span class="line">                  <span class="string">'        &lt;td&gt;'</span>+(i+<span class="number">1</span>)+<span class="string">'&lt;/td&gt;\n'</span> +</span><br><span class="line">                  <span class="string">'        &lt;td&gt;'</span>+res.data[i].username+<span class="string">'&lt;/td&gt;\n'</span> +</span><br><span class="line">                  <span class="string">'        &lt;td&gt;'</span>+res.data[i].nickname+<span class="string">'&lt;/td&gt;\n'</span> +</span><br><span class="line">                  <span class="string">'        &lt;td&gt;&lt;button class="company"&gt;企业&lt;/button&gt;&lt;button class="school"&gt;学校&lt;/button&gt;&lt;/td&gt;\n'</span> +</span><br><span class="line">                  <span class="string">'    &lt;/tr&gt;'</span></span><br><span class="line">              $(<span class="string">'tbody'</span>).append(htmlStr);</span><br><span class="line">          &#125;</span><br><span class="line">          company();</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">    function company()&#123;</span><br><span class="line">        $(<span class="string">".company"</span>).click(function()&#123;</span><br><span class="line">            var username=$(this).parent().parent().find(<span class="string">'td:eq(1)'</span>).text();</span><br><span class="line">            window.location.href=<span class="string">'/msbc/?username='</span>+username+<span class="string">''</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h2 id="公司评分界面"><a class="markdownIt-Anchor" href="#公司评分界面"></a> 公司评分界面</h2></head><body><h1></h1><div>寻求解决方案的能力<input id="score1" type="text" placeholder="满分：16" value="0"></div><div>综合应用分析的能力<input id="score2" type="text" placeholder="满分：23" value="0"></div><div>考虑社会等因素<input id="score3" type="text" placeholder="满分：15" value="0"></div><div>工具的选择和使用能力<input id="score4" type="text" placeholder="满分：22" value="0"></div><div>沟通交流能力<input id="score5" type="text" placeholder="满分：4" value="0"></div><div>考勤<input id="score6" type="text" placeholder="满分：20" value="0"></div><div><span>目前分</span><span id="score"></span></div><button id="submit">提交成绩</button></body><script>    function getUrlParam(name) { //a标签跳转获取参数        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");        var r = window.location.search.substr(1).match(reg);        if(r != null) return decodeURI(r[2]);        return null;    }    var username = getUrlParam('username');    $('h1').text(username);    $("#submit").click(function () {         $.ajax({        url:'/msbc/',        type:'post',        dataType:'json',        data:{            username:username,            score1:$("#score1").val(),            score2:$("#score2").val(),            score3:$("#score3").val(),            score4:$("#score4").val(),            score5:$("#score5").val(),            score6:$("#score6").val(),        },        success:function (res) {            alert(res.data);        },    })    });    $("input").change(function(){       $("#score").empty();       var sum = 0;       var a=$("input").each(function(){var value = $(this).val();sum+=parseInt(value)});       $("#score").text(sum);    });</script></html><h2 id="获取上一链接的参数"><a class="markdownIt-Anchor" href="#获取上一链接的参数"></a> 获取上一链接的参数</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function getUrlParam(name) &#123; &#x2F;&#x2F;a标签跳转获取参数</span><br><span class="line">var reg &#x3D; new RegExp(&quot;(^|&amp;)&quot; + name + &quot;&#x3D;([^&amp;]*)(&amp;|$)&quot;, &quot;i&quot;);</span><br><span class="line">var r &#x3D; window.location.search.substr(1).match(reg);</span><br><span class="line">if(r !&#x3D; null) return decodeURI(r[2]);</span><br><span class="line">return null;</span><br><span class="line">&#125;</span><br><span class="line">var username &#x3D; getUrlParam(&#39;username&#39;);</span><br></pre></td></tr></table></figure><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/zoruasama/zoruasama.github.io@latest/css/mindmap.css">]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;总述&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#总述&quot;&gt;&lt;/a&gt; 总述&lt;/h1&gt;
&lt;p&gt;今天是8月7日，实训的第15天。&lt;br /&gt;
上午孟老师演示了如何用Django做一个打分系统，先是分析需求——&lt;br /&gt;
打分系统需要满足：
      
    
    </summary>
    
    
      <category term="实训日记" scheme="https://zoruasama.gitee.io/categories/%E5%AE%9E%E8%AE%AD%E6%97%A5%E8%AE%B0/"/>
    
    
      <category term="Python" scheme="https://zoruasama.gitee.io/tags/Python/"/>
    
      <category term="实训" scheme="https://zoruasama.gitee.io/tags/%E5%AE%9E%E8%AE%AD/"/>
    
  </entry>
  
  <entry>
    <title>实训日记 | Day 14. 调用第三方API</title>
    <link href="https://zoruasama.gitee.io/2020/08/06/training_14/"/>
    <id>https://zoruasama.gitee.io/2020/08/06/training_14/</id>
    <published>2020-08-06T11:30:00.000Z</published>
    <updated>2020-09-07T08:21:45.301Z</updated>
    
    <content type="html"><![CDATA[<h1 id="总述"><a class="markdownIt-Anchor" href="#总述"></a> 总述</h1><p>2020年8月6日。是实训的第14天。<br />今天上午孟老师带我们学习了如何将调用第三方的公开API以及如何使用HBuilder将web应用快速打包成安卓可以使用的apk包。<br />调用第三方的公开API，是以高德地图为例的。说实话，高德地图作为一个成熟的商业地图导航提供商，它的API调用并不算太简单。<br />老师还演示了如何将其他地方下载过来的数据与高德地图API结合的过程，过程十分繁琐，但也有趣。</p><h1 id="调用api"><a class="markdownIt-Anchor" href="#调用api"></a> 调用API</h1><h2 id="高德地图"><a class="markdownIt-Anchor" href="#高德地图"></a> 高德地图</h2><p>打开<a href="https://lbs.amap.com/" target="_blank" rel="noopener">高德地图开放平台</a>。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/1596676271_20200806090924741_16028.png" alt="" /><br />点击注册并完成个人开发者认证。<br />点击控制台，在我的应用-应用管理中，创建新应用。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200806091127.png" alt="" /><br />点击左上角的添加，选择Web端的服务平台。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200806091200.png" alt="" /><br />注意这个Key，后续会使用到。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200806091649.png" alt="" /></p><p>点击开发支持，有API文档可供阅读。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200806092049.png" alt="" /><br />复制一个示例到html文件中。点击运行，则可看到地图效果。</p><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200806093048.png" alt="" /><br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200806093122.png" alt="" /></p><h2 id="pandas-to_dict-的用法"><a class="markdownIt-Anchor" href="#pandas-to_dict-的用法"></a> pandas to_dict 的用法</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.test <span class="keyword">import</span> TestCase</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = pd.read_excel(<span class="string">'黑龙江gps.xlsx'</span>)</span><br><span class="line">data_dict=data.to_dict(orient=<span class="string">'split'</span>)</span><br><span class="line">print(data_dict[<span class="string">'data'</span>])</span><br></pre></td></tr></table></figure><p>pandas 中的to_dict 可以对DataFrame类型的数据进行转换<br />可以选择六种的转换类型，分别对应于参数 ‘dict’, ‘list’, ‘series’, ‘split’, ‘records’, ‘index’，下面逐一介绍每种的用法。</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Help on method to_dict <span class="keyword">in</span> module pandas.core.frame:</span><br><span class="line"></span><br><span class="line">to_dict(orient=<span class="string">'dict'</span>) method of pandas.core.frame.DataFrame instance</span><br><span class="line">    Convert DataFrame to dictionary.</span><br><span class="line"></span><br><span class="line">    Parameters</span><br><span class="line">    ----------</span><br><span class="line">    orient : str &#123;<span class="string">'dict'</span>, <span class="string">'list'</span>, <span class="string">'series'</span>, <span class="string">'split'</span>, <span class="string">'records'</span>, <span class="string">'index'</span>&#125;</span><br><span class="line">        Determines the type of the values of the dictionary.</span><br><span class="line"></span><br><span class="line">        - dict (default) : dict like &#123;column -&gt; &#123;index -&gt; value&#125;&#125;</span><br><span class="line">        - list : dict like &#123;column -&gt; [values]&#125;</span><br><span class="line">        - series : dict like &#123;column -&gt; Series(values)&#125;</span><br><span class="line">        - split : dict like</span><br><span class="line">          &#123;index -&gt; [index], columns -&gt; [columns], data -&gt; [values]&#125;</span><br><span class="line">        - records : list like</span><br><span class="line">          [&#123;column -&gt; value&#125;, ... , &#123;column -&gt; value&#125;]</span><br><span class="line">        - index : dict like &#123;index -&gt; &#123;column -&gt; value&#125;&#125;</span><br><span class="line"></span><br><span class="line">          .. versionadded:: <span class="number">0.17</span><span class="number">.0</span></span><br><span class="line"></span><br><span class="line">        Abbreviations are allowed. `s` indicates `series` <span class="keyword">and</span> `sp`</span><br><span class="line">        indicates `split`.</span><br><span class="line"></span><br><span class="line">    Returns</span><br><span class="line">    -------</span><br><span class="line">    result : dict like &#123;column -&gt; &#123;index -&gt; value&#125;&#125;</span><br></pre></td></tr></table></figure><h3 id="选择参数orientdict"><a class="markdownIt-Anchor" href="#选择参数orientdict"></a> 选择参数orient=‘dict’</h3><p>dict也是默认的参数，下面的data数据类型为DataFrame结构, 会形成 {column -&gt; {index -&gt; value}}这样的结构的字典，可以看成是一种双重字典结构。</p><ul><li>单独提取每列的值及其索引，然后组合成一个字典</li><li>再将上述的列属性作为关键字（key），值（values）为上述的字典</li></ul><p>查询方式为 ：<code>data_dict[key1][key2]</code></p><ul><li>data_dict 为参数选择orient=’dict’时的数据名</li><li>key1 为列属性的键值（外层）</li><li>key2 为内层字典对应的键值</li></ul><h3 id="选择参数orientlist"><a class="markdownIt-Anchor" href="#选择参数orientlist"></a> 选择参数orient=‘list’</h3><p>和1中比较相似，只不过内层变成了一个列表，结构为{column -&gt; [values]}<br />查询方式为： data_list[keys][index]</p><h3 id="选择参数orientseries"><a class="markdownIt-Anchor" href="#选择参数orientseries"></a> 选择参数orient=‘series’</h3><p>形成结构**{column -&gt; Series(values)}**<br />调用格式为：data_series[key1][key2]或data_dict[key1]</p><ul><li>data_series 为数据对应的名字</li><li>key1 为列属性的键值，如本例中的’age’ , ‘embarked’等</li><li>key2 使用数据原始的索引（可选）</li></ul><h3 id="选择参数orientsplit"><a class="markdownIt-Anchor" href="#选择参数orientsplit"></a> 选择参数orient=‘split’</h3><p>形成**{index -&gt; [index], columns -&gt; [columns], data -&gt; [values]}**的结构，是将数据、索引、属性名单独脱离出来构成字典<br />调用方式有 data_split[‘index’],data_split[‘data’],data_split[‘columns’]+ data_list 为关键字orient=‘list’ 时对应的数据名</p><ul><li>keys 为列属性的键值，如本例中的’age’ , 'embarked’等</li><li>index 为整型索引，从0开始到最后</li></ul><h3 id="选择参数orientrecords时"><a class="markdownIt-Anchor" href="#选择参数orientrecords时"></a> 选择参数orient='records’时</h3><p>形成***[{column -&gt; value}, … , {column -&gt; value}]***的结构<br />整体构成一个列表，内层是将原始数据的每行提取出来形成字典<br />调用格式为data_records[index][key1]</p><h3 id="选择参数orientindex时"><a class="markdownIt-Anchor" href="#选择参数orientindex时"></a> 选择参数orient='index’时</h3><p>形成{index -&gt; {column -&gt; value}}的结构，调用格式正好和’dict’对应的反过来，请读者自己思考</p><h1 id="django-cors-headers-解决跨域问题"><a class="markdownIt-Anchor" href="#django-cors-headers-解决跨域问题"></a> django-cors-headers 解决跨域问题</h1><p>浏览器具有 “同源策略的限制”，导致 <code>发送ajax请求</code> + <code>跨域</code> 存在无法获取数据。</p><ul><li>简单请求，发送一次请求。</li><li>复杂请求，先options请求做预检，然后再发送真正请求</li></ul><p><strong>1. pip安装</strong><br /><code>pip install django-cors-headers</code><br /><strong>2. 添加到setting的app中</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS &#x3D; (</span><br><span class="line">...</span><br><span class="line">&#39;corsheaders&#39;,</span><br><span class="line">...</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><strong>3. 添加中间件</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">MIDDLEWARE &#x3D; [  # Or MIDDLEWARE_CLASSES on Django &lt; 1.10</span><br><span class="line">...</span><br><span class="line">&#39;corsheaders.middleware.CorsMiddleware&#39;,</span><br><span class="line">&#39;django.middleware.common.CommonMiddleware&#39;,</span><br><span class="line">...</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p><strong>4. setting下面添加下面的配置</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">CORS_ALLOW_CREDENTIALS &#x3D; True</span><br><span class="line">CORS_ORIGIN_ALLOW_ALL &#x3D; True</span><br><span class="line">CORS_ORIGIN_WHITELIST &#x3D; (</span><br><span class="line">&#39;*&#39;</span><br><span class="line">)</span><br><span class="line">CORS_ALLOW_METHODS &#x3D; (</span><br><span class="line">&#39;DELETE&#39;,</span><br><span class="line">&#39;GET&#39;,</span><br><span class="line">&#39;OPTIONS&#39;,</span><br><span class="line">&#39;PATCH&#39;,</span><br><span class="line">&#39;POST&#39;,</span><br><span class="line">&#39;PUT&#39;,</span><br><span class="line">&#39;VIEW&#39;,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">CORS_ALLOW_HEADERS &#x3D; (</span><br><span class="line">&#39;XMLHttpRequest&#39;,</span><br><span class="line">&#39;X_FILENAME&#39;,</span><br><span class="line">&#39;accept-encoding&#39;,</span><br><span class="line">&#39;authorization&#39;,</span><br><span class="line">&#39;content-type&#39;,</span><br><span class="line">&#39;dnt&#39;,</span><br><span class="line">&#39;origin&#39;,</span><br><span class="line">&#39;user-agent&#39;,</span><br><span class="line">&#39;x-csrftoken&#39;,</span><br><span class="line">&#39;x-requested-with&#39;,</span><br><span class="line">&#39;Pragma&#39;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>启动项目时，使用<code>python manage.py runserver 0.0.0.0:8000</code></p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/zoruasama/zoruasama.github.io@latest/css/mindmap.css">]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;总述&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#总述&quot;&gt;&lt;/a&gt; 总述&lt;/h1&gt;
&lt;p&gt;2020年8月6日。是实训的第14天。&lt;br /&gt;
今天上午孟老师带我们学习了如何将调用第三方的公开API以及如何使用HBuilder将web应
      
    
    </summary>
    
    
      <category term="实训日记" scheme="https://zoruasama.gitee.io/categories/%E5%AE%9E%E8%AE%AD%E6%97%A5%E8%AE%B0/"/>
    
    
      <category term="Python" scheme="https://zoruasama.gitee.io/tags/Python/"/>
    
      <category term="实训" scheme="https://zoruasama.gitee.io/tags/%E5%AE%9E%E8%AE%AD/"/>
    
  </entry>
  
  <entry>
    <title>实训日记 | Day 13. Flask的工程化</title>
    <link href="https://zoruasama.gitee.io/2020/08/05/training_13/"/>
    <id>https://zoruasama.gitee.io/2020/08/05/training_13/</id>
    <published>2020-08-05T11:30:00.000Z</published>
    <updated>2020-09-07T08:21:17.013Z</updated>
    
    <content type="html"><![CDATA[<h1 id="总述"><a class="markdownIt-Anchor" href="#总述"></a> 总述</h1><p>2020年8月5日。是实训的第13天。<br />今天上午孟老师带我们学习了如何将flask工程化。<s>其实是flask的django化。</s><br />flask作为一个轻量级的框架，把路由、数据库、项目启动全都放到了一起，虽然这样子一来开发的速度很快，但是内容一旦多起来，在一页代码中寻找会非常的麻烦。而且flask没有现成的数据库迁移工具。<br />所谓flask工程化，就是将app.py拆分开多个文件。<br />完成flask工程化后，flask稍微显得不那么轻量了（但是对比于django还是属于轻量水准的），但是工程化能使开发流程更加系统全面。<br />讲完flask的工程化后，时间还有剩余。孟老师向我们询问还有什么想知道的。我想起他之前说过django的session，便想让他在这时讲解一下。他很豪爽地讲解了。只用了短短10分钟。原来session这么简单啊。</p><h1 id="flask工程化"><a class="markdownIt-Anchor" href="#flask工程化"></a> flask工程化</h1><h2 id="文件配置"><a class="markdownIt-Anchor" href="#文件配置"></a> 文件配置</h2><p>复制app.py的内容，然后粘贴到新建的app_config.py，略加修改，只应用在配置中使用到的包。<br />将<code>app = Flask(__name__)</code>修改为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app = Flask(__name__,</span><br><span class="line">template_folder=<span class="string">'templates'</span>,</span><br><span class="line">static_folder=<span class="string">"static"</span>,</span><br><span class="line">            )</span><br></pre></td></tr></table></figure><p>同时新建两个文件夹：<code>templates</code>和<code>static</code>。<br />修改完的app_config.py全文如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask_cors <span class="keyword">import</span> CORS</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">app = Flask(__name__,</span><br><span class="line">template_folder=<span class="string">'templates'</span>,</span><br><span class="line">static_folder=<span class="string">"static"</span>,</span><br><span class="line">            )</span><br><span class="line">BASEDIR = os.path.abspath(os.path.dirname(__file__))</span><br><span class="line"></span><br><span class="line">app.config[<span class="string">'SQLALCHEMY_DATABASE_URI'</span>] = <span class="string">'sqlite:///'</span>+os.path.join(BASEDIR,<span class="string">'data.sqlite'</span>)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">如果设置成 True (默认情况)，Flask-SQLAlchemy 将会追踪对象的修改并且发送信号。这需要额外的内存， 如果不必要的可以禁用它。</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">app.config[<span class="string">'SQLALCHEMY_TRACK_MODIFICATIONS'</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">CORS(app)</span><br></pre></td></tr></table></figure><h2 id="数据库迁移工具"><a class="markdownIt-Anchor" href="#数据库迁移工具"></a> 数据库迁移工具</h2><p>先使用<code>pip install flask-migrate</code>和<code>pip install flask-script</code>安装两个包。<br />安装完毕后，新建一个database.py文件。编写如下代码。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> app_config <span class="keyword">import</span> app</span><br><span class="line"><span class="keyword">from</span> models <span class="keyword">import</span> db</span><br><span class="line"><span class="keyword">from</span> flask_migrate <span class="keyword">import</span> Migrate,MigrateCommand</span><br><span class="line"><span class="keyword">from</span> flask_script <span class="keyword">import</span> Manager</span><br><span class="line"></span><br><span class="line">manager = Manager(app)</span><br><span class="line"></span><br><span class="line">migrate = Migrate(app,db)</span><br><span class="line"></span><br><span class="line">manager.add_command(<span class="string">'db'</span>,MigrateCommand)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    manager.run()</span><br></pre></td></tr></table></figure><p>接下来在命令行使用<code>python database.py db init</code>命令，就可以初始化数据库。<br />使用<code>python database.py db migrate</code>命令，就可以生成迁移文件。<br />使用<code>python database.py db upgrade</code>命令，就可以生成数据表。</p><h2 id="模型"><a class="markdownIt-Anchor" href="#模型"></a> 模型</h2><p>新建models.py文件。将app.py中关于models的复制到这里，也略加修改。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> app_config <span class="keyword">import</span> app</span><br><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line">db = SQLAlchemy(app)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Info</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__=<span class="string">'info2'</span></span><br><span class="line">    id = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    title = db.Column(db.String(<span class="number">255</span>))</span><br><span class="line">    category = db.Column(db.String(<span class="number">60</span>))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'&lt;info.&gt;%s '</span> % self.title</span><br></pre></td></tr></table></figure><h2 id="主程序"><a class="markdownIt-Anchor" href="#主程序"></a> 主程序</h2><p>新建run.py文件。将app.py关于路由和运行的复制到这里，略加修改。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,jsonify,render_template,request</span><br><span class="line"><span class="keyword">from</span> app_config <span class="keyword">import</span> app</span><br><span class="line"><span class="keyword">from</span> models <span class="keyword">import</span> Info,db</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#函数和路由不可重复</span></span><br><span class="line"><span class="meta">@app.route('/',methods=['GET','POST']) #装饰器路由</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span> <span class="comment">#视图函数</span></span><br><span class="line">    info1 = Info(id=<span class="number">1</span>,title=<span class="string">'新闻1'</span>,category=<span class="string">'娱乐新闻'</span>)</span><br><span class="line">    info2 = Info(id=<span class="number">2</span>,title=<span class="string">'新闻2'</span>,category=<span class="string">'工作新闻'</span>)</span><br><span class="line">    db.session.add_all([info1,info2]) <span class="comment">#将数据添加到会话</span></span><br><span class="line">    db.session.commit() <span class="comment">#提交会话</span></span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;<span class="string">'data'</span>:&#123;<span class="string">'name'</span>:<span class="string">'Zorua'</span>,<span class="string">'age'</span>:<span class="number">20</span>&#125;&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/query',methods=['GET','POST']) #装饰器路由</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">query</span><span class="params">()</span>:</span></span><br><span class="line">    results=Info.query.all()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> results:</span><br><span class="line">        print(i)</span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;<span class="string">'data'</span>:<span class="string">'Success'</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/update',methods=['GET','POST']) #装饰器路由</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update</span><span class="params">()</span>:</span></span><br><span class="line">    Info.query.filter(Info.title==<span class="string">'新闻1'</span>).update(&#123;<span class="string">'category'</span>:<span class="string">'改后新闻'</span>&#125;)</span><br><span class="line">    db.session.commit()  <span class="comment"># 提交会话</span></span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;<span class="string">'data'</span>:<span class="string">'Success'</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/delete',methods=['GET','POST']) #装饰器路由</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">()</span>:</span></span><br><span class="line">    Info.query.filter(Info.title==<span class="string">'新闻1'</span>).delete()</span><br><span class="line">    db.session.commit()  <span class="comment"># 提交会话</span></span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;<span class="string">'data'</span>:<span class="string">'Success'</span>&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/index',methods=['POST','GET']) #装饰器路由</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello_world</span><span class="params">()</span>:</span>  <span class="comment"># 视图函数</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'index.html'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/api',methods=['POST','GET']) #装饰器路由</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">api</span><span class="params">()</span>:</span>  <span class="comment"># 视图函数</span></span><br><span class="line">    name = request.form.get(<span class="string">'name'</span>)</span><br><span class="line">    age = request.form.get(<span class="string">'age'</span>)</span><br><span class="line">    print(name)</span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;<span class="string">'data'</span>:&#123;<span class="string">'name'</span>:name,<span class="string">'age'</span>:age&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>,host=<span class="string">'0.0.0.0'</span>,port=<span class="number">8888</span>)</span><br></pre></td></tr></table></figure><p>接下来运行项目只用在run.py中运行即可。</p><h1 id="django的session"><a class="markdownIt-Anchor" href="#django的session"></a> django的session</h1><p><code>session</code>就相当于是一个字典。<br /><code>request.session['user_id'] = User.objects.get(username=username).id</code><br />就可以在session中新增user_id字段并记录下来。<br />session中的记录是有有效期的。</p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/zoruasama/zoruasama.github.io@latest/css/mindmap.css">]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;总述&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#总述&quot;&gt;&lt;/a&gt; 总述&lt;/h1&gt;
&lt;p&gt;2020年8月5日。是实训的第13天。&lt;br /&gt;
今天上午孟老师带我们学习了如何将flask工程化。&lt;s&gt;其实是flask的django化。&lt;
      
    
    </summary>
    
    
      <category term="实训日记" scheme="https://zoruasama.gitee.io/categories/%E5%AE%9E%E8%AE%AD%E6%97%A5%E8%AE%B0/"/>
    
    
      <category term="Python" scheme="https://zoruasama.gitee.io/tags/Python/"/>
    
      <category term="实训" scheme="https://zoruasama.gitee.io/tags/%E5%AE%9E%E8%AE%AD/"/>
    
  </entry>
  
  <entry>
    <title>实训日记 | Day 12. Flask框架</title>
    <link href="https://zoruasama.gitee.io/2020/08/04/training_12/"/>
    <id>https://zoruasama.gitee.io/2020/08/04/training_12/</id>
    <published>2020-08-04T11:30:00.000Z</published>
    <updated>2020-09-07T08:20:42.493Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css"><h1 id="总述"><a class="markdownIt-Anchor" href="#总述"></a> 总述</h1><p>2020年8月4日。是实训的第12天。<br />今天上午孟老师带我们回顾了过去在Django这一块所学的一些知识，然后开始讲授flask。完成从flask的创建到部署，再是路由、跨域、连接数据库等等任务。</p><div class="snote quote">Flask 是一个微型的 Python 开发的 Web 框架，基于Werkzeug WSGI工具箱和Jinja2模板引擎。 Flask使用BSD授权。 Flask也被称为“microframework”，因为它使用简单的核心，用extension增加其他功能。Flask没有默认使用的数据库、窗体验证工具。然而，Flask保留了扩增的弹性，可以用Flask-extension加入这些功能：ORM、窗体验证工具、文件上传、各种开放式身份验证技术。</div><p>通过今天的学习，我确实感受到了Flask比Django要简单一些。花费较少的精力和时间就能达到和Django同样的效果。但是即便如此，我依然决定在我的大作业上使用Django。因为就我自身而言，我对Django更加熟悉。</p><p>今天的知识把握程度还行，基于对Django的理解上再去学习Flask就没有那么难。但是对于ajax嵌套，我仍是有一些不明白的地方。</p><p>Flask的优势：</p><ul><li>Flask是一个轻量级的可定制框架</li><li>插件超级多，不用自己造轮子</li></ul><h1 id="新建flask项目"><a class="markdownIt-Anchor" href="#新建flask项目"></a> 新建Flask项目</h1><p>在Pycharm中点击新建，选择Flask项目，即可完成项目的创建。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200804092656.png" alt="" /></p><p>项目创建完毕后，可以看到如下的文件夹结构。Flask框架确实比Django框架要轻量得多。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200804092804.png" alt="" /></p><h2 id="运行测试"><a class="markdownIt-Anchor" href="#运行测试"></a> 运行测试</h2><p>先来对主要的app.py的代码，作一些注释。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 路由不可重复，函数也不可重复。</span></span><br><span class="line"><span class="meta">@app.route('/') #装饰器路由</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello_world</span><span class="params">()</span>:</span> <span class="comment">#视图函数</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'Hello World!'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run()  <span class="comment">#会在这里启动。所以Flask不用像Django一样输入命令行启动。直接运行即可。</span></span><br></pre></td></tr></table></figure><p>运行的结果如下图所示。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200804095707.png" alt="" /></p><p>一般，我们想要的数据，是json数据，在此引入一个包。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> jsonify</span><br></pre></td></tr></table></figure><p>有了这样一个包，</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jsonify(&#123;<span class="string">'data'</span>:&#123;<span class="string">'name'</span>:<span class="string">'Zorua'</span>,<span class="string">'age'</span>:<span class="number">20</span>&#125;&#125;)</span><br><span class="line"><span class="comment">#等价于之前在Django的JsonResponse</span></span><br></pre></td></tr></table></figure><p>测试效果<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200804095648.png" alt="" /></p><h2 id="部署修改"><a class="markdownIt-Anchor" href="#部署修改"></a> 部署修改</h2><p>现在这个站点是部署在本地的，如果部署在云服务器上，或需要修改端口。<br />可在<code>app.run()</code>中加入参数，如下所示。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.run(host=<span class="string">'0.0.0.0'</span>,port=<span class="number">8888</span>)</span><br></pre></td></tr></table></figure><p>这个效果不能马上生效，还需要添加新的配置。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200804094850.png" alt="" /><br />选择Python，然后在右侧，名称写为<code>app.py</code>，Script Path为该文件的绝对路径。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200804093304.png" alt="" /></p><p>最后在命令行键入<code>python app.py</code>即可生效。</p><h2 id="debug模式"><a class="markdownIt-Anchor" href="#debug模式"></a> DEBUG模式</h2><p>Flask默认是没有开启debug模式的，开启debug模式有很多好处：</p><ul><li>可以帮助我们查找代码里面的错误</li><li>每次修改代码不需要重新运行代码</li></ul><p>为开启DEBUG模式，只需要在<code>app.run()</code>的参数中增加一个<code>debug=True</code>，或者在其下面加一句<code>app.debug=True</code>。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">app.run(debug=<span class="literal">True</span>,host=<span class="string">'0.0.0.0'</span>,port=<span class="number">8888</span>)</span><br><span class="line">app.debug = <span class="literal">True</span></span><br></pre></td></tr></table></figure><h1 id="前后端分离"><a class="markdownIt-Anchor" href="#前后端分离"></a> 前后端分离</h1><h2 id="添加新的路由"><a class="markdownIt-Anchor" href="#添加新的路由"></a> 添加新的路由</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route('/index') #装饰器路由</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello_world</span><span class="params">()</span>:</span>  <span class="comment"># 视图函数</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'index.html'</span>)</span><br><span class="line">    <span class="comment">#为使用上面这个语句，需要引入包：</span></span><br><span class="line">    <span class="comment"># from flask import render_template</span></span><br></pre></td></tr></table></figure><p>再在templates文件夹中，新建一个<code>index.html</code></p><p>运行查看一下效果：<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200804095612.png" alt="" /></p><h3 id="请求类型"><a class="markdownIt-Anchor" href="#请求类型"></a> 请求类型</h3><p>对于路由的请求类型，可以在装饰器的函数里面加一个参数<code>methods=['GET','POST']</code>。<br />即</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route('/api',methods=['POST','GET']) #装饰器路由</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">api</span><span class="params">()</span>:</span>  <span class="comment"># 视图函数</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>如果想获取参数的话，需要引入一个包：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="meta">@app.route('/api',methods=['POST','GET']) #装饰器路由</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">api</span><span class="params">()</span>:</span>  <span class="comment"># 视图函数</span></span><br><span class="line">    name = request.args.get(<span class="string">'name'</span>)</span><br><span class="line">    age = request.args.get(<span class="string">'age'</span>)</span><br><span class="line">    print(name)</span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;<span class="string">'data'</span>:&#123;<span class="string">'name'</span>:name,<span class="string">'age'</span>:age&#125;&#125;)</span><br></pre></td></tr></table></figure><p>之后和Django类似，使用<code>request.args.get()</code>函数来获取参数。<br />对于post请求，只需要把上面的args改成form就可以了。<br />即：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="meta">@app.route('/api',methods=['POST','GET']) #装饰器路由</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">api</span><span class="params">()</span>:</span>  <span class="comment"># 视图函数</span></span><br><span class="line">    name = request.form.get(<span class="string">'name'</span>)</span><br><span class="line">    age = request.form.get(<span class="string">'age'</span>)</span><br><span class="line">    print(name)</span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;<span class="string">'data'</span>:&#123;<span class="string">'name'</span>:name,<span class="string">'age'</span>:age&#125;&#125;)</span><br></pre></td></tr></table></figure><h2 id="跨域"><a class="markdownIt-Anchor" href="#跨域"></a> 跨域</h2><p>引用包<code>flask_cors</code>，然后调用<code>flask_cors.CORS(app)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> flask_cors</span><br><span class="line">flask_cors.CORS(app)</span><br></pre></td></tr></table></figure><p>跨域能够实现前后端分离：</p><ul><li>前端：对json数据进行渲染，ajax请求后台接口</li><li>后端：数据打包json，提供可以被调用的api</li></ul><h2 id="ajax"><a class="markdownIt-Anchor" href="#ajax"></a> ajax</h2><p>和之前的Django类似，不同的地方在于url。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>wow<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    Wow awesome</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    $.ajax(&#123;</span></span><br><span class="line"><span class="actionscript">        url:<span class="string">'http://127.0.0.1:8888/api'</span>,</span></span><br><span class="line"><span class="actionscript">        type:<span class="string">'post'</span>,</span></span><br><span class="line"><span class="actionscript">        dataType:<span class="string">'json'</span>,</span></span><br><span class="line">        data:&#123;</span><br><span class="line"><span class="actionscript">          name:<span class="string">'Zorua'</span>,</span></span><br><span class="line">          age:13</span><br><span class="line">        &#125;,</span><br><span class="line"><span class="actionscript">        success:<span class="function"><span class="keyword">function</span><span class="params">(res)</span></span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(res.data)</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="连接数据库"><a class="markdownIt-Anchor" href="#连接数据库"></a> 连接数据库</h2><h3 id="准备工作"><a class="markdownIt-Anchor" href="#准备工作"></a> 准备工作</h3><p>先安装一个库。在命令行中键入<code>pip install Flask-SQLAlchemy</code>并按下回车键。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据库连接</span></span><br><span class="line">app.config[<span class="string">'SQLALCHEMY_DATABASE_URI'</span>] = <span class="string">'sqlite:///'</span>+os.path.join(BASEDIR,<span class="string">'data.sqlite'</span>)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">如果设置成 True（默认情况），Flask-SQLAlchemy将会追踪对象的修改并且发送信号 这需要额外的内存 如果不必要的话可以禁用它</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">app.config[<span class="string">'SQLALCHEMY_TRACK_MODIFICATIONS'</span>]=<span class="literal">False</span></span><br></pre></td></tr></table></figure><h3 id="创建数据库"><a class="markdownIt-Anchor" href="#创建数据库"></a> 创建数据库</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">db = SQLAlchemy(app)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Info</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    id = db.Column(db.Integer,primary_key=<span class="literal">True</span>)</span><br><span class="line">    title = db.Column(db.String(<span class="number">255</span>))</span><br><span class="line">    category = db.Column(db.String(<span class="number">60</span>))</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'&lt;info.&gt;%s '</span> %  self.title</span><br></pre></td></tr></table></figure><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200804145108.png" alt="" /><br />创建完毕后，再命令行中键入flask shell。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200804145346.png" alt="" /></p><h3 id="插入数据"><a class="markdownIt-Anchor" href="#插入数据"></a> 插入数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">info1 = Info(id=<span class="number">1</span>,title=<span class="string">'新闻1'</span>,category=<span class="string">'娱乐新闻'</span>)</span><br><span class="line">info2 = Info(id=<span class="number">2</span>,title=<span class="string">'新闻2'</span>,category=<span class="string">'工作新闻'</span>)</span><br><span class="line">db.session.add_all([info1,info2]) <span class="comment">#将数据添加到会话</span></span><br><span class="line">db.session.commit() <span class="comment">#提交会话</span></span><br></pre></td></tr></table></figure><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200804152306.png" alt="" /></p><h3 id="查询数据"><a class="markdownIt-Anchor" href="#查询数据"></a> 查询数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route('/query',methods=['GET','POST']) #装饰器路由</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">query</span><span class="params">()</span>:</span></span><br><span class="line">    results=Info.query.all()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> results:</span><br><span class="line">        print(i)</span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;<span class="string">'data'</span>:<span class="string">'Success'</span>&#125;)</span><br></pre></td></tr></table></figure><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200804152941.png" alt="" /></p><h3 id="更新数据"><a class="markdownIt-Anchor" href="#更新数据"></a> 更新数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route('/update',methods=['GET','POST']) #装饰器路由</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update</span><span class="params">()</span>:</span></span><br><span class="line">    Info.query.filter(Info.title==<span class="string">'新闻1'</span>).update(&#123;<span class="string">'category'</span>:<span class="string">'改后新闻'</span>&#125;)</span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;<span class="string">'data'</span>:<span class="string">'Success'</span>&#125;)</span><br></pre></td></tr></table></figure><h3 id="删除数据"><a class="markdownIt-Anchor" href="#删除数据"></a> 删除数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route('/update',methods=['GET','POST']) #装饰器路由</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update</span><span class="params">()</span>:</span></span><br><span class="line">    Info.query.filter(Info.title==<span class="string">'新闻1'</span>).delete()</span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;<span class="string">'data'</span>:<span class="string">'Success'</span>&#125;)</span><br></pre></td></tr></table></figure><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/zoruasama/zoruasama.github.io@latest/css/mindmap.css">]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; href=&quot;https://use.fontawesome.com/releases/v5.0.13/css/all.css&quot;&gt;
&lt;h1 id=&quot;总述&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#总述&quot;&gt;
      
    
    </summary>
    
    
      <category term="实训日记" scheme="https://zoruasama.gitee.io/categories/%E5%AE%9E%E8%AE%AD%E6%97%A5%E8%AE%B0/"/>
    
    
      <category term="Python" scheme="https://zoruasama.gitee.io/tags/Python/"/>
    
      <category term="实训" scheme="https://zoruasama.gitee.io/tags/%E5%AE%9E%E8%AE%AD/"/>
    
  </entry>
  
  <entry>
    <title>实训日记 | Day 11. 数据的可视化</title>
    <link href="https://zoruasama.gitee.io/2020/08/03/training_11/"/>
    <id>https://zoruasama.gitee.io/2020/08/03/training_11/</id>
    <published>2020-08-03T11:30:00.000Z</published>
    <updated>2020-09-07T08:20:15.719Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css"><h1 id="总述"><a class="markdownIt-Anchor" href="#总述"></a> 总述</h1><p>2020年8月3日。到了实训的第三周的第一天。<br />今天主要讲了如何用echarts实现<strong>数据的可视化</strong>。<br />主要的活动有：</p><ul><li>数据打包</li><li>echarts远程包</li><li>echarts本地包（重点）<br />数据可视化主要旨在借助于图形化手段，清晰有效地传达与沟通信息。但是，这并不就意味着数据可视化就一定因为要实现其功能用途而令人感到枯燥乏味，或者是为了看上去绚丽多彩而显得极端复杂。为了有效地传达思想概念，美学形式与功能需要齐头并进，通过直观地传达关键的方面与特征，从而实现对于相当稀疏而又复杂的数据集的深入洞察。然而，设计人员往往并不能很好地把握设计与功能之间的平衡，从而创造出华而不实的数据可视化形式，无法达到其主要目的，也就是传达与沟通信息。<br />因此，我们不仅要掌握数据可视化的办法，也更要懂得如何让组织形式使得传达与沟通的效益最大化。<br />今天圆满地完成了主要工作，不仅完成了一边听课一边记录笔记，而且课中也没有遇到什么疑难杂症而纠结良久。</li></ul><p>今天的操作流程，一言以蔽之。对于本地存在的Excel数据、CSV数据等等，可以使用<code>pandas</code>或<code>xlrd</code>来进行提取，而后用<code>echarts</code>把它绘制在网页上。</p><div class="snote quote">ECharts 是一个使用 JavaScript 实现的开源可视化库，涵盖各行业图表，满足各种需求。ECharts 遵循 Apache-2.0 开源协议，免费商用。ECharts 兼容当前绝大部分浏览器（IE8/9/10/11，Chrome，Firefox，Safari等）及兼容多种设备，可随时随地任性展示。</div><h1 id="pandasxlrd"><a class="markdownIt-Anchor" href="#pandasxlrd"></a> pandas&amp;xlrd</h1><div class="snote quote">Pandas是一个强大的分析结构化数据的工具集；它的使用基础是Numpy（提供高性能的矩阵运算）；用于数据挖掘和数据分析，同时也提供数据清洗功能。</div><div class="snote quote">Python中操作excel主要用到xlrd和xlwt这两个库，即xlrd是读excel，xlwt是写excel的库。</div><h2 id="安装流程"><a class="markdownIt-Anchor" href="#安装流程"></a> 安装流程</h2><p>在Terminal中键入<code>pip install pandas</code>即可完成pandas的安装（如果没装过numpy和dateutil也会一并装了）。<br />出现了以下字样的安装成功信息。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Successfully installed numpy-1.19.1 pandas-1.1.0 python-dateutil-2.8.1</span><br></pre></td></tr></table></figure><p>再在Terminal中键入<code>pip install xlrd</code>即可完成xlrd的安装。</p><h2 id="数据的获取"><a class="markdownIt-Anchor" href="#数据的获取"></a> 数据的获取</h2><p>除了可以用爬虫自己获取网页上的数据外，还可以上<a href="https://tianchi.aliyun.com/dataset/" target="_blank" rel="noopener">阿里云-天池</a>来获取数据。<br />为了方便练习，选择一些数据量不大的数据集。这里老师选择了<a href="http://www.stat-nba.com/" target="_blank" rel="noopener">NBA数据</a>中的球员勒布朗-詹姆斯的数据。<br />将网页表格复制到Excel中，得到如下结果。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200803093457.png" alt="" /></p><h2 id="应用伊始"><a class="markdownIt-Anchor" href="#应用伊始"></a> 应用伊始</h2><p>键入<code>python manage.py startapp echarts</code>新建一个应用。<br />将<code>james.xlsx</code>复制到该应用的文件夹下。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200803094147.png" alt="" /></p><p>在 <code>tests.py</code> 文件中，键入如下代码以进行测试。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.test <span class="keyword">import</span> TestCase</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment"># Create your tests here.</span></span><br><span class="line">data = pd.read_excel(<span class="string">'james.xlsx'</span>)</span><br><span class="line">print(data)</span><br></pre></td></tr></table></figure><p>可以看到输出结果为如下所示。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200803094359.png" alt="" /></p><h2 id="dataframe"><a class="markdownIt-Anchor" href="#dataframe"></a> DataFrame</h2><div class="snote quote">DataFrame是一种表格型数据结构，它含有一组有序的列，每列可以是不同的值。DataFrame既有行索引，也有列索引，它可以看作是由Series组成的字典，不过这些Series公用一个索引。</div><p>DataFrame的创建有多种方式，不过最重要的还是根据dict进行创建，以及读取csv或者txt文件来创建。<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></p><p>将刚刚的测试代码修改为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.test <span class="keyword">import</span> TestCase</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment"># Create your tests here.</span></span><br><span class="line">data = pd.read_excel(<span class="string">'james.xlsx'</span>)</span><br><span class="line">df = pd.DataFrame(data=data,index=range(<span class="number">1</span>,<span class="number">17</span>)) <span class="comment">#创建了DataFrame, index是行索引, range是列索引</span></span><br><span class="line"><span class="comment"># 输出不同的形式，以便于观察DataFrame。</span></span><br><span class="line">print(list(df[<span class="string">'赛季'</span>])) <span class="comment">#强制转换为list, 方便后续使用。</span></span><br><span class="line">print(type(df[<span class="string">'得分'</span>]))</span><br><span class="line">print(df[<span class="string">'篮板'</span>])</span><br></pre></td></tr></table></figure><p>输出结果为：<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200803101318.png" alt="" /></p><blockquote><p>个人觉得用不用DataFrame，区别仅在于会不会去掉NaN数据。</p></blockquote><h2 id="views的配置"><a class="markdownIt-Anchor" href="#views的配置"></a> views的配置</h2><p>按照之前的实训经验，完成views的配置。<br />为了使列表的数据以赛季递增，在列表后加入<code>[::-1]</code>完成倒装。</p><blockquote><p>上课时，我以为用<code>list.reverse()</code>，但是<code>reverse()</code>方法是没有返回值的。<br />这意味着，不能直接将这个方法写在<code>print</code>函数里。<br />所以为使代码简短，使用<code>[::-1]</code>确实是最佳解。</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> JsonResponse</span><br><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">api_echarts</span><span class="params">(request)</span>:</span></span><br><span class="line">    data = pd.read_excel(<span class="string">'james.xlsx'</span>)  <span class="comment"># 这里还有一个路径的问题，如果是现行的代码，会报错，参考下面的图。</span></span><br><span class="line">    df = pd.DataFrame(data=data,index=range(<span class="number">1</span>,<span class="number">17</span>))</span><br><span class="line">    print(df)</span><br><span class="line">    season = (list(df[<span class="string">'赛季'</span>])[::<span class="number">-1</span>])</span><br><span class="line">    score = (list(df[<span class="string">'得分'</span>])[::<span class="number">-1</span>])</span><br><span class="line">    lanban = (list(df[<span class="string">'篮板'</span>])[::<span class="number">-1</span>])</span><br><span class="line">    zhugong = (list(df[<span class="string">'助攻'</span>])[::<span class="number">-1</span>])</span><br><span class="line">    <span class="keyword">return</span> JsonResponse(&#123;<span class="string">'season'</span>:season,<span class="string">'score'</span>:score,<span class="string">'lanban'</span>:lanban,<span class="string">'zhugong'</span>:zhugong&#125;)</span><br></pre></td></tr></table></figure><div class="hide-block"><a class="hide-button button--primary button--animated" style="background-color: red;color: white">出现的错误    </a><span class="hide-content"><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200803104215.png" alt="" /></p></span></div><p>为解决这个错误，将代码更改为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> JsonResponse</span><br><span class="line"><span class="keyword">import</span> os   <span class="comment">#新增行</span></span><br><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line">BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__))) <span class="comment">#新增行，获取项目的绝对路径</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">api_echarts</span><span class="params">(request)</span>:</span></span><br><span class="line">    data = pd.read_excel(os.path.join(BASE_DIR,<span class="string">'echarts'</span>,<span class="string">'james.xlsx'</span>)) <span class="comment">#修改行</span></span><br><span class="line">    df = pd.DataFrame(data=data,index=range(<span class="number">1</span>,<span class="number">17</span>))</span><br><span class="line">    print(df)</span><br><span class="line">    season = (list(df[<span class="string">'赛季'</span>])[::<span class="number">-1</span>])</span><br><span class="line">    score = (list(df[<span class="string">'得分'</span>])[::<span class="number">-1</span>])</span><br><span class="line">    lanban = (list(df[<span class="string">'篮板'</span>])[::<span class="number">-1</span>])</span><br><span class="line">    zhugong = (list(df[<span class="string">'助攻'</span>])[::<span class="number">-1</span>])</span><br><span class="line">    <span class="keyword">return</span> JsonResponse(&#123;<span class="string">'season'</span>:season,<span class="string">'score'</span>:score,<span class="string">'lanban'</span>:lanban,<span class="string">'zhugong'</span>:zhugong&#125;)</span><br></pre></td></tr></table></figure><p>这样就可以成功获取数据了。</p><div class="snote link blue">语法：<code>os.path.abspath(__file__)</code><p>功能：获取当前运行文件的绝对路径</p><p>语法：<code>os.path.dirname(path)</code></p><p>功能：去掉文件名，返回目录</p></div><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200803104638.png" alt="" /></p><p>完成后，为了和下文的HTML文件对接，还需要在view.py中加入：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">echarts_page</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> render(request,<span class="string">'echarts.html'</span>)</span><br></pre></td></tr></table></figure><h2 id="urls的配置"><a class="markdownIt-Anchor" href="#urls的配置"></a> urls的配置</h2><p>在项目的路由配置里，加入：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path(<span class="string">'echarts/'</span>,include(<span class="string">'echarts.urls'</span>)),</span><br></pre></td></tr></table></figure><p>在echarts应用的路由里，加入：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">path(<span class="string">'api_echarts/'</span>,api_echarts),</span><br><span class="line">path(<span class="string">'echarts_page'</span>,echarts_page),</span><br></pre></td></tr></table></figure><h1 id="echarts远程包"><a class="markdownIt-Anchor" href="#echarts远程包"></a> echarts远程包</h1><div class="snote quote">远程包：调用CDN需要请求网络资源。</div><p>在templates文件夹下新建一个<code>echarts.html</code></p><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200803105734.png" alt="" /><br />在头部，添加对jQuery和echarts的引用。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcdn.net/ajax/libs/echarts/4.8.0/echarts.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>接下来，再在body部分建一个容器来使用echarts。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"box"</span> <span class="attr">style</span>=<span class="string">"width:900px;height:500px;background: rgba(106,11,233,0.4)"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>然后，新建一个<code>script</code>标签，在其中键入以下代码。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mycharts = echarts.init(<span class="built_in">document</span>.getElementById(<span class="string">'box'</span>));   <span class="comment">//mycharts的内容放在box容器里</span></span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">       url: <span class="string">'/echarts/api_echarts/'</span>,</span><br><span class="line">       type: <span class="string">'get'</span>,</span><br><span class="line">       dataType:<span class="string">'json'</span>,</span><br><span class="line">       success:<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</span><br><span class="line">         <span class="built_in">console</span>.log(res);</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure><p>打开<a href="https://echarts.apache.org/examples/zh/index.html?theme=light" target="_blank" rel="noopener">echarts官网</a>获取一个实例的代码。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200803112146.png" alt="" /><br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200803112219.png" alt="" /><br />复制左边的代码，到script标签的funtion(res)中，修改数据部分为项目的内容。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">option = &#123;</span><br><span class="line">    xAxis: &#123;</span><br><span class="line">        type: <span class="string">'category'</span>,</span><br><span class="line">        data: res.season,</span><br><span class="line">    &#125;,</span><br><span class="line">    yAxis: &#123;</span><br><span class="line">        type: <span class="string">'value'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    series: [&#123;</span><br><span class="line">        data: res.score,</span><br><span class="line">        type: <span class="string">'line'</span>,</span><br><span class="line">        smooth: <span class="literal">true</span></span><br><span class="line">    &#125;]</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure><p>然后在之后加入以下代码来绘制图形。结果如下图所示。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mycharts.setOption(option);</span><br></pre></td></tr></table></figure><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200803112915.png" alt="" /></p><h2 id="绘制表格"><a class="markdownIt-Anchor" href="#绘制表格"></a> 绘制表格</h2><p>在HTML的body部分加入以下代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--table是表格标签--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>&lt;thead&gt;</code>标签定义表格的表头。该标签用于组合 HTML 表格的表头内容。</li><li>thead 元素应该与 tbody 和 tfoot 元素结合起来使用。</li><li>tbody 元素用于对 HTML 表格中的主体内容进行分组，而 tfoot 元素用于对 HTML 表格中的表注（页脚）内容进行分组。</li><li>tr 代表一行；td 代表一列。</li><li>table的属性中有一个<code>border</code>，默认<code>border</code>=“0”，为无边框。这里就是无边框。<br />在Script标签中加入以下代码：</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;res.score.length;i++)&#123;</span><br><span class="line">                $(<span class="string">'thead tr'</span>).append(<span class="string">'&lt;td&gt;'</span>+res.season[i]+<span class="string">'&lt;/td&gt;'</span>);<span class="comment">//追加表头</span></span><br><span class="line">                $(<span class="string">'tbody tr:eq(0)'</span>).append(<span class="string">'&lt;td&gt;'</span>+res.score[i]+<span class="string">'&lt;/td&gt;'</span>);<span class="comment">//追加得分</span></span><br><span class="line">                $(<span class="string">'tbody tr:eq(1)'</span>).append(<span class="string">'&lt;td&gt;'</span>+res.lanban[i]+<span class="string">'&lt;/td&gt;'</span>);<span class="comment">//追加篮板</span></span><br><span class="line">                $(<span class="string">'tbody tr:eq(2)'</span>).append(<span class="string">'&lt;td&gt;'</span>+res.zhugong[i]+<span class="string">'&lt;/td&gt;'</span>);<span class="comment">//追加助攻</span></span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure><p>结果如图所示。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200803142332.png" alt="" /></p><h1 id="echarts本地包"><a class="markdownIt-Anchor" href="#echarts本地包"></a> echarts本地包</h1><p>重点。<br />调用本地资源，不需要网络。<br />拓展-静态文件的展示、图片或者文件的上传</p><h2 id="调用本地图片"><a class="markdownIt-Anchor" href="#调用本地图片"></a> 调用本地图片</h2><p>如果直接在网页中写以下代码时，浏览器并不能找到该资源。因此需进行路由配置。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/bg1.jpg"</span>&gt;</span></span><br></pre></td></tr></table></figure><p>注意到settings.py里有如下内容。因此在项目的根目录新建一个<code>static</code>文件夹。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200803144502.png" alt="" /><br />然后在这句代码的下面，加入下面的代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">STATICFILES_DIRS=[</span><br><span class="line">    os.path.join(BASE_DIR,<span class="string">'static'</span>)</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>对于这段代码，援引一段来自Django官方文档的解释。</p><div class="snote link"><p class="p subtitle">提供文件/Serving the files</p>In addition to these configuration steps, you’ll also need to actually serve the static files.During development, if you use django.contrib.staticfiles, this will be done automatically by runserver when DEBUG is set to True (see django.contrib.staticfiles.views.serve()).This method is grossly inefficient and probably insecure, so it is unsuitable for production.See Deploying static files for proper strategies to serve static files in production environments.<p>除了这些配置步骤之外，您还需要实际提供静态文件。<br />在开发过程中，如果使用django.contrib.staticfiles，这将是自动完成的runserver，当DEBUG设置为True（见django.contrib.staticfiles.views.serve()）。<br />此方法效率极低，并且可能不安全，因此不适合生产。<br />有关在生产环境中提供静态文件的正确策略，请参阅部署静态文件。</p></div class><p><strong>然后在urls.py中配置static文件夹资源的路由。</strong><br />先引入下面这几个包并获取项目绝对路径。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> re_path <span class="comment">#正则表达式路径</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> django.views <span class="keyword">import</span> static</span><br><span class="line">BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))<span class="comment">#项目绝对路径</span></span><br></pre></td></tr></table></figure><p>然后配置下面这条路由。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path(<span class="string">r'^static/(?&lt;path&gt;.*)$'</span>,static.serve,&#123;<span class="string">'document_root'</span>:os.path.join(BASE_DIR,<span class="string">'static'</span>)&#125;),</span><br></pre></td></tr></table></figure><p>完成后，图片就可以正常的访问了。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200803150646.png" alt="" /><br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200803150731.png" alt="" /></p><h2 id="调用本地js或css"><a class="markdownIt-Anchor" href="#调用本地js或css"></a> 调用本地JS或CSS</h2><p>在配置完毕上面的路由之后。也可以调用本地的JS或CSS资源。<br />以jQuery为例，直接打开<a href="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js" target="_blank" rel="noopener">其CDN链接</a>。复制其中的内容到一个本地的js文件中放在static文件夹下即可。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/static/js/jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="echarts增加细节"><a class="markdownIt-Anchor" href="#echarts增加细节"></a> echarts增加细节</h1><p>更多的细节可以查询echarts的<a href="https://echarts.apache.org/zh/api.html" target="_blank" rel="noopener">API手册</a>。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">option = &#123;</span><br><span class="line">                color: [<span class="string">'red'</span>,<span class="string">'orange'</span>],   <span class="comment">//图线颜色</span></span><br><span class="line">                xAxis: &#123;</span><br><span class="line">                    type: <span class="string">'category'</span>,</span><br><span class="line">                    data: res.season,</span><br><span class="line">                &#125;,</span><br><span class="line">                tooltip:&#123;</span><br><span class="line">                  trigger: <span class="string">'axis'</span>,</span><br><span class="line">                  axisPointer:&#123;</span><br><span class="line">                      type:<span class="string">'shadow'</span>         <span class="comment">//当鼠标移动在点上时的提示窗口</span></span><br><span class="line">                  &#125;,</span><br><span class="line">                  show:<span class="literal">true</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">                legend:&#123;</span><br><span class="line">                    data:[<span class="string">'篮板'</span>,<span class="string">'助攻'</span>]    <span class="comment">//图例</span></span><br><span class="line">                &#125;,</span><br><span class="line">                yAxis: &#123;</span><br><span class="line">                    type: <span class="string">'value'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                series: [&#123;</span><br><span class="line">                    data: res.lanban,</span><br><span class="line">                    type: <span class="string">'line'</span>,</span><br><span class="line">                    name:<span class="string">'篮板'</span>,    <span class="comment">//系列名称</span></span><br><span class="line">                    smooth: <span class="literal">true</span></span><br><span class="line">                &#125;,&#123;</span><br><span class="line">                    data: res.zhugong,</span><br><span class="line">                    type: <span class="string">'line'</span>,</span><br><span class="line">                    name: <span class="string">'助攻'</span>,    <span class="comment">//系列名称</span></span><br><span class="line">                    smooth: <span class="literal">true</span>,</span><br><span class="line">                &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;;</span><br></pre></td></tr></table></figure><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200803162734.png" alt="" /></p><hr class="footnotes-sep" /><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>参考资料：<a href="https://www.jianshu.com/p/8024ceef4fe2" target="_blank" rel="noopener">https://www.jianshu.com/p/8024ceef4fe2</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p></li></ol></section><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/zoruasama/zoruasama.github.io@latest/css/mindmap.css">]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; href=&quot;https://use.fontawesome.com/releases/v5.0.13/css/all.css&quot;&gt;
&lt;h1 id=&quot;总述&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#总述&quot;&gt;
      
    
    </summary>
    
    
      <category term="实训日记" scheme="https://zoruasama.gitee.io/categories/%E5%AE%9E%E8%AE%AD%E6%97%A5%E8%AE%B0/"/>
    
    
      <category term="Python" scheme="https://zoruasama.gitee.io/tags/Python/"/>
    
      <category term="实训" scheme="https://zoruasama.gitee.io/tags/%E5%AE%9E%E8%AE%AD/"/>
    
  </entry>
  
  <entry>
    <title>实训日记 | Day 04. 简单的爬虫</title>
    <link href="https://zoruasama.gitee.io/2020/07/23/training_3/"/>
    <id>https://zoruasama.gitee.io/2020/07/23/training_3/</id>
    <published>2020-07-23T11:30:00.000Z</published>
    <updated>2020-10-04T12:25:04.703Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css"><h1 id="总述"><a class="markdownIt-Anchor" href="#总述"></a> 总述</h1><p>2020年7月22日。今天主要讲的内容有：</p><ul><li>使用Requests包和BeautifulSoup4进行简单的网页爬虫</li></ul><h1 id="爬虫"><a class="markdownIt-Anchor" href="#爬虫"></a> 爬虫</h1><p>网络爬虫（又称为网页蜘蛛，网络机器人，在FOAF社区中间，更经常的称为网页追逐者），是一种按照一定的规则，自动地抓取万维网信息的程序或者脚本。另外一些不常使用的名字还有蚂蚁、自动索引、模拟程序或者蠕虫。</p><p>我们知道，在WWW上我们访问的网页基本上都是用HTML文档来进行描述的。在浏览器按下<code>F12</code>键，可以打开开发者工具，选择<code>Elements</code>页签，即可查看HTML的文档内容。如图所示：</p><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200930202616.png" alt="" /></p><p>我们就可以从HTML中获取想要的数据/信息。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200930203042.png" alt="" /></p><p>如果我们要进行对某个网页的爬虫，需要解决的问题有两个：</p><ul><li>获取HTML文档的内容</li><li>解析这个HTML文档，按照一定规则获取其中的信息/数据</li></ul><p>对于上面两个问题，进行针对性的解决：</p><ul><li>用Requests包来获取HTML文档</li><li>用BeautifulSoup4来解析HTML文档</li></ul><h1 id="requests"><a class="markdownIt-Anchor" href="#requests"></a> Requests</h1><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://requests.readthedocs.io/zh_CN/latest/_static/requests-sidebar.png" alt="" /><br /><a href="https://requests.readthedocs.io/zh_CN/latest/user/quickstart.html" target="_blank" rel="noopener">在线文档</a></p><h2 id="简单介绍"><a class="markdownIt-Anchor" href="#简单介绍"></a> 简单介绍</h2><p>引用以下来自官方文档的内容：</p><blockquote><p>Requests 唯一的一个非转基因的 Python HTTP 库，人类可以安全享用。<br />警告：非专业使用其他 HTTP 库会导致危险的副作用，包括：安全缺陷症、冗余代码症、重新发明轮子症、啃文档症、抑郁、头疼、甚至死亡。<br />Requests 允许你发送纯天然，植物饲养的 HTTP/1.1 请求，无需手工劳动。你不需要手动为 URL 添加查询字串，也不需要对 POST 数据进行表单编码。Keep-alive 和 HTTP 连接池的功能是 100% 自动化的，一切动力都来自于根植在 Requests 内部的 urllib3。</p></blockquote><h2 id="简单使用"><a class="markdownIt-Anchor" href="#简单使用"></a> 简单使用</h2><p>如果你还没有安装Requests包，可以在命令行使用如下命令进行安装。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install requests</span><br></pre></td></tr></table></figure><p>安装完毕后，键入如下代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">response = requests.get(<span class="string">'https://www.baidu.com'</span>)</span><br><span class="line">print(response.status_code) <span class="comment">#HTTP状态码</span></span><br></pre></td></tr></table></figure><p>这是以<code>GET</code>请求方式来访问<code>https://www.baidu.com</code>，然后返回一个HTTP状态码。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200930205853.png" alt="" /></p><div class="snote guide"><p>复习一下一些常见的HTTP状态码</p><p>200 请求成功</p><p>301/302 重定向</p><p>403 禁止访问  404 找不到资源 405 Method not allow</p><p>500 服务器问题  502 Bad Gateway 网关错误</p></div><p>上图返回的代码是200，即请求成功了。<br />请求成功后，可以获取一些其他信息。读者可以自行尝试输出查看内容。<br />这里主要说明<code>response.text</code>和<code>response.content</code>。<br />前者这个属性，获取了HTML文档，就解决了我们在前文提出的爬虫的第一个问题。<br />后者主要被用于存储图片和文件，例如访问的URL为<code>https://zoruasama.gitee.io/img/zorua.png</code>。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">print(response.text) <span class="comment">#获取HTML文档</span></span><br><span class="line">print(response.url)  <span class="comment">#获取请求的URL</span></span><br><span class="line">print(response.headers)  <span class="comment">#获取请求头</span></span><br><span class="line">print(response.cookies)  <span class="comment">#获取cookies # cookies和session的概念</span></span><br><span class="line">print(response.content)  <span class="comment">#以字节流返回数据 存图片或文件用</span></span><br></pre></td></tr></table></figure><p>如图所示是<code>response.text</code>返回的字符串内容。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200930210531.png" alt="" /></p><p>接下来说明如何使用BeautifulSoup4来获取HTML文档中的信息。</p><h1 id="beautifulsoup4"><a class="markdownIt-Anchor" href="#beautifulsoup4"></a> BeautifulSoup4</h1><h2 id="简单介绍-2"><a class="markdownIt-Anchor" href="#简单介绍-2"></a> 简单介绍</h2><p><a href="https://beautifulsoup.readthedocs.io/zh_CN/v4.4.0/" target="_blank" rel="noopener">在线文档</a><br />Beautiful Soup 是一个可以从HTML或XML文件中提取数据的Python库。它能够通过你喜欢的转换器实现惯用的文档导航，查找，修改文档的方式。Beautiful Soup会帮你节省数小时甚至数天的工作时间。<br />HTML 文档本身是<strong>结构化的文本</strong>，有<strong>一定的规则</strong>，通过它的结构可以简化信息提取。于是，就有了lxml、pyquery、BeautifulSoup等网页信息提取库。一般我们会用这些库来提取网页信息。<br />在下文中BeautifulSoup4将被简称为BS4。</p><h2 id="简单使用-2"><a class="markdownIt-Anchor" href="#简单使用-2"></a> 简单使用</h2><p>我们引用官方的例子来介绍如何使用BS4来进行工作。<br />先安装BS4，在命令行键入如下语句：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install beautifulsoup4</span><br></pre></td></tr></table></figure><p>假如我们已经使用某种方式获取到了某个网页的HTML文档（例如上文介绍的Requests），然后将这个文档字符串存储在<code>html_doc</code>这个变量中。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">html_doc = <span class="string">"""</span></span><br><span class="line"><span class="string">&lt;html&gt;&lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">&lt;p class="title"&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;p class="story"&gt;Once upon a time there were three little sisters; and their names were</span></span><br><span class="line"><span class="string">&lt;a href="http://example.com/elsie" class="sister" id="link1"&gt;Elsie&lt;/a&gt;,</span></span><br><span class="line"><span class="string">&lt;a href="http://example.com/lacie" class="sister" id="link2"&gt;Lacie&lt;/a&gt; and</span></span><br><span class="line"><span class="string">&lt;a href="http://example.com/tillie" class="sister" id="link3"&gt;Tillie&lt;/a&gt;;</span></span><br><span class="line"><span class="string">and they lived at the bottom of a well.&lt;/p&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;p class="story"&gt;...&lt;/p&gt;</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><p>而后从bs4中引入BeautifulSoup，解析上面的文档，就能得到一个BeautifulSoup对象，并将之赋值给soup变量。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line">soup = BeautifulSoup(html_doc, <span class="string">'html.parser'</span>) <span class="comment">#参数1是解析的文档内容, 参数2是选择的解析器</span></span><br></pre></td></tr></table></figure><p>使用对象的<code>prettify()</code>方法可以以标准缩进的形式呈现soup的HTML文档内容。<br />以下的内容需要一定的<strong>HTML基础</strong>。需要知道什么是<code>标签</code>，<code>ID</code>，<code>Class</code>等知识。<br />由于这不是本文主要内容，因此不再这里赘述，只会在下文简要说明。</p><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200930212424.png" alt="" /></p><p>我们再来看看关于<code>BeautifulSoup</code>对象的其他方法：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">print(soup.title)        <span class="comment">#获取标题标签</span></span><br><span class="line">print(soup.title.text)   <span class="comment">#获取内容</span></span><br><span class="line">print(soup.title.attrs)   <span class="comment">#获取属性</span></span><br><span class="line">print(soup.title.get(<span class="string">'class'</span>))  <span class="comment">#获取属性的值</span></span><br></pre></td></tr></table></figure><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200930213035.png" alt="" /></p><p>接下来来解释一下上面这些名词。</p><h3 id="souptitle"><a class="markdownIt-Anchor" href="#souptitle"></a> soup.title</h3><p>我们可以观察一下被解析的这个HTML文档，里面有一行：<code>&lt;title&gt;The Dormouse's story&lt;/title&gt;</code>，两边用<code>title</code>标签裹着的。<br />因此<code>soup.title</code>就是在<strong>原先的整个文档中截取了这一部分</strong>。<br />同理，如果选择<code>soup.body</code>，那么就是输出<code>body</code>标签裹着的内容。</p><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200930213316.png" alt="" /></p><p>进一步再选择<code>soup.body.p</code>，这会输出<code>body</code>标签下的<code>p</code>标签，而<code>p</code>标签有多个，所以只会选择<strong>第一个</strong>并输出。</p><h3 id="souptitletext"><a class="markdownIt-Anchor" href="#souptitletext"></a> soup.title.text</h3><p>虽然本节的标题是<code>soup.title.text</code>，但是<code>text</code>属性<strong>并不是</strong><code>title</code><strong>独有的</strong>，这一点在接下来的属性或方法介绍也是如此。只要是<code>BeautifulSoup</code>对象，<strong>都有这些方法</strong>。</p><p><code>.text</code>属性是用于获取标签内部的“<strong>正文</strong>”，如下图的<strong>橙色部分</strong>。<br />它没有在<code>&lt; &gt;</code>这对括号内，所以把它视为“正文”。</p><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200930214353.png" alt="" /></p><p>上面这段字符串，实际是通过<code>soup.body.a</code>来获取的。<br />接下来获取其中的“正文”。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200930214713.png" alt="" /></p><h3 id="souptitleattrs"><a class="markdownIt-Anchor" href="#souptitleattrs"></a> soup.title.attrs</h3><p>在上文演示这个方法时，输出的是一个空字典。<br />这是因为<code>soup.title</code>并不具备属性。在本节我们拿上一节的<code>soup.body.a</code>作演示。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200930214843.png" alt="" /></p><p>可以看到，在<code>&lt; &gt;</code>这对括号里的内容，以字典的形式被返回了。如果读者还没有遗忘如何从字典从取值的方法的话，很容易可以联想到：<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200930215000.png" alt="" /></p><p>可以这样做，但是事实上，BS4还提供了一个优雅的做法：<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200930215116.png" alt="" /></p><h3 id="souptitlegetclass"><a class="markdownIt-Anchor" href="#souptitlegetclass"></a> soup.title.get(‘class’)</h3><p>接续上节，获取<code>&lt; &gt;</code>内的内容，还可以使用本节标题的形式。<br />例如：<code>soup.body.a.get('href')</code><br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20200930215334.png" alt="" /></p><h2 id="查找标签"><a class="markdownIt-Anchor" href="#查找标签"></a> 查找标签</h2><p>大多数情况下，上述的简单使用总是只能获取到<strong>第一个匹配项</strong>，显得有些鸡肋、不够用。<br />而且对于标签的选择总是不够精准。<br />因此我们在这里介绍<strong>查找标签</strong>的方法。查找标签的方法主要有两个：<code>.find()</code>和<code>.findall()</code>。<br />前者也是查找<strong>第一个满足条件</strong>的标签并以字符串的形式返回，后者是查找<strong>所有满足条件</strong>的标签并以列表的形式返回。<br />除此以外，这两个方法在参数上大同小异。</p><ul><li><code>name</code>，标签的名字，例如<code>p</code>,<code>a</code>,<code>title</code>等。</li><li><code>**kwargs</code>，利用属性键值对来进行过滤。如<code>id</code>和<code>class_</code>等。</li><li>其他的参数不再作解释。读者若感兴趣可以自行查阅文档。</li></ul><h3 id="查找指定id的标签"><a class="markdownIt-Anchor" href="#查找指定id的标签"></a> 查找指定id的标签</h3><p>我们再次使用上面的HTML文档为例进行演示。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004133730.png" alt="" /><br />为了获取其中标为橙色的内容，我们可以<code>soup.find('a',id=&quot;link2&quot;)</code>。</p><h3 id="查找指定class的标签"><a class="markdownIt-Anchor" href="#查找指定class的标签"></a> 查找指定class的标签</h3><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004133909.png" alt="" /></p><p>为了获取其中所有绿色的内容，我们可以<code>soup.find_all('a',class_='sister')</code><br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004134113.png" alt="" /><br />返回的内容是<strong>一个含有三个元素的列表</strong>。</p><h2 id="css选择器"><a class="markdownIt-Anchor" href="#css选择器"></a> CSS选择器</h2><p>如果您对CSS有了解的话，您肯定对 id 和 class 选择器不陌生。<br />使用<code>soup.select()</code>方法就可以像CSS的规则一样进行选择。<br />此处不再赘述。<br />例如</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(soup.select(<span class="string">'a'</span>))</span><br><span class="line">print(soup.select(<span class="string">'.sister'</span>))  <span class="comment"># class是用 . 号</span></span><br><span class="line">print(soup.select(<span class="string">'#link1'</span>))   <span class="comment"># id是用 # 号</span></span><br></pre></td></tr></table></figure><h1 id="实战演练"><a class="markdownIt-Anchor" href="#实战演练"></a> 实战演练</h1><h2 id="爬取百度贴吧帖子中的图片并下载"><a class="markdownIt-Anchor" href="#爬取百度贴吧帖子中的图片并下载"></a> 爬取百度贴吧帖子中的图片并下载</h2><p>首先，我们先找一个<strong>百度贴吧帖子</strong>作为目标。<br />笔者选择了<strong>火影忍者</strong>吧的这一帖子作为目标 <a href="https://tieba.baidu.com/p/6970148254" target="_blank" rel="noopener">链接</a>。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004135044.png" alt="" /></p><h3 id="获取html文档"><a class="markdownIt-Anchor" href="#获取html文档"></a> 获取HTML文档</h3><p>先使用<code>requests</code>获取文档。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">html = requests.get(<span class="string">'https://tieba.baidu.com/p/6970148254'</span>)</span><br><span class="line">print(html.status_code) <span class="comment"># 返回200即为请求成功</span></span><br><span class="line">print(html.text)  <span class="comment"># html.text 即为我们想要的HTML文档</span></span><br></pre></td></tr></table></figure><h3 id="用beautifulsoup解析"><a class="markdownIt-Anchor" href="#用beautifulsoup解析"></a> 用BeautifulSoup解析</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line">soup = BeautifulSoup(html.text,<span class="string">'html.parser'</span>)</span><br></pre></td></tr></table></figure><h3 id="对网页元素进行选择"><a class="markdownIt-Anchor" href="#对网页元素进行选择"></a> 对网页元素进行选择</h3><p>为了方便对HTML文档的阅读，我们使用浏览器的F12工具进行阅读。这个工具只需在浏览器中按下F12键即可打开。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004135639.png" alt="" /></p><p>观察文档可知，第一张图片的标签为<code>&lt;img class=&quot;BDE_Image&quot; src=&quot;http://tiebapic.baidu.com/forum/w%3D580/sign=219b01688545d688a302b2ac94c37dab/f3e3241f95cad1c845e0347c683e6709c83d5144.jpg&quot; size=&quot;905080&quot; changedsize=&quot;true&quot; width=&quot;560&quot; height=&quot;817&quot;&gt;</code>。</p><blockquote><p>您可以把鼠标悬浮在图片上，然后按下<code>Ctrl+Shift+C</code>进行快速定位。</p></blockquote><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004135857.png" alt="" /><br />观察后面几张图片，发现<strong>共性</strong>为img标签，class为<strong>BDE_Image</strong>，而我们只需要获得src链接即可。</p><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="_v_images/20201004140033913_32281.png" alt="" /><br />橙色是共性，绿色是需要爬取的内容。</p><h3 id="查找标签-2"><a class="markdownIt-Anchor" href="#查找标签-2"></a> 查找标签</h3><p>由上面的分析易得，我们需要写的代码为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">images = soup.find_all(<span class="string">'img'</span>,class_=<span class="string">'BDE_Image'</span>) <span class="comment">#这将返回含有每个图片元素的一个列表</span></span><br><span class="line"><span class="keyword">for</span> img <span class="keyword">in</span> images:</span><br><span class="line">    print(img[<span class="string">'src'</span>])</span><br></pre></td></tr></table></figure><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="_v_images/20201004140632114_5447.png" alt="" /></p><p>可以看到我们获得了大量的链接。<br />接下来只需要下载这些链接的内容即可。</p><h3 id="下载图片"><a class="markdownIt-Anchor" href="#下载图片"></a> 下载图片</h3><p>此处先直接贴出代码再做解释。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">for</span> img <span class="keyword">in</span> images:</span><br><span class="line">    print(<span class="string">'*'</span>*<span class="number">100</span>)</span><br><span class="line">    <span class="keyword">with</span> open(str(int(time.time()))+<span class="string">'.jpg'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:  <span class="comment"># 使用with语句打开文件（文件不存在则会创建, 用时间戳命名文件）</span></span><br><span class="line">       f.write(requests.get(img[<span class="string">'src'</span>]).content)    <span class="comment"># 写入字节集</span></span><br><span class="line">       <span class="comment"># requests.get(img['src']) 是用requests访问目标链接 然后用 .content属性去获取二进制内容</span></span><br><span class="line">       time.sleep(<span class="number">4</span>)</span><br></pre></td></tr></table></figure><h3 id="完整代码"><a class="markdownIt-Anchor" href="#完整代码"></a> 完整代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">html = requests.get(<span class="string">'https://tieba.baidu.com/p/6970148254'</span>)</span><br><span class="line">print(html.status_code) <span class="comment"># 返回200即为请求成功</span></span><br><span class="line">print(html.text)  <span class="comment"># html.text 即为我们想要的HTML文档</span></span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line">soup = BeautifulSoup(html.text,<span class="string">'html.parser'</span>)</span><br><span class="line">images = soup.find_all(<span class="string">'img'</span>,class_=<span class="string">'BDE_Image'</span>) <span class="comment">#这将返回含有每个图片元素的一个列表</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">for</span> img <span class="keyword">in</span> images:</span><br><span class="line">    print(<span class="string">'*'</span>*<span class="number">100</span>)</span><br><span class="line">    <span class="keyword">with</span> open(str(int(time.time()))+<span class="string">'.jpg'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:  <span class="comment"># 使用with语句打开文件（文件不存在则会创建, 用时间戳命名文件）</span></span><br><span class="line">       f.write(requests.get(img[<span class="string">'src'</span>]).content)    <span class="comment"># 写入字节集</span></span><br><span class="line">       <span class="comment"># requests.get(img['src']) 是用requests访问目标链接 然后用 .content属性去获取二进制内容</span></span><br><span class="line">       time.sleep(<span class="number">4</span>)  <span class="comment"># 等待4秒 以防止来不及下载</span></span><br></pre></td></tr></table></figure><h2 id="爬取豆瓣影评"><a class="markdownIt-Anchor" href="#爬取豆瓣影评"></a> 爬取豆瓣影评</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先引用包</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> time</span><br></pre></td></tr></table></figure><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004193912.png" alt="" /><br />找到要爬取的目标，我选择了这个《我和我的家乡》的影评。<a href="https://movie.douban.com/subject/35051512/comments?limit=20&amp;status=P&amp;sort=new_score" target="_blank" rel="noopener">链接</a></p><h3 id="获取html文档-2"><a class="markdownIt-Anchor" href="#获取html文档-2"></a> 获取HTML文档</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">html = requests.get(<span class="string">'https://movie.douban.com/subject/35051512/comments?limit=20&amp;status=P&amp;sort=new_score'</span>)</span><br><span class="line">print(html.status_code) <span class="comment"># 返回200即为请求成功</span></span><br><span class="line">print(html.text)  <span class="comment"># html.text 即为我们想要的HTML文档</span></span><br></pre></td></tr></table></figure><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004194033.png" alt="" /><br />我们可以看到，直接进行GET请求，返回的状态号为418，并没有成功。<br />这可能是网站检测出非正常访问，所以我们要伪装成真实人物来访问。<br />这里就涉及一个<code>User-Agent</code>的概念了，简称<code>UA</code>。这里不解释<code>UA</code>是什么。只说明如何利用。<br />如何找到<code>UA</code>呢？下面介绍两个方法：</p><h4 id="方法一"><a class="markdownIt-Anchor" href="#方法一"></a> 方法一</h4><p>打开F12工具，刷新一下网页。选择Network页签，在左边的选项中随便点一个，在右边的Headers中找到user-agent字段。<br />即 <code>Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36</code></p><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004180427.png" alt="" /></p><h4 id="方法二"><a class="markdownIt-Anchor" href="#方法二"></a> 方法二</h4><p>打开浏览器，在地址栏输入<code>about://version</code>并回车。可以方便地找到<code>UA</code>字段。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004180711.png" alt="" /></p><h3 id="headers"><a class="markdownIt-Anchor" href="#headers"></a> headers</h3><p>创建一个字典headers，将刚刚找到的<code>UA</code>，作为字段<code>User-Agent</code>的值写入其中。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">headers = &#123;</span><br><span class="line">             <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36'</span>,</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure><p>接下来将之前的</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">html = requests.get(<span class="string">'https://movie.douban.com/subject/35051512/comments?limit=20&amp;status=P&amp;sort=new_score'</span>)</span><br></pre></td></tr></table></figure><p>修改为</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">html = requests.get(<span class="string">'https://movie.douban.com/subject/35051512/comments?limit=20&amp;status=P&amp;sort=new_score'</span>,headers=headers)</span><br></pre></td></tr></table></figure><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004194227.png" alt="" /></p><p>这个时候就可以发现能成功请求了。</p><h3 id="用beautifulsoup解析-2"><a class="markdownIt-Anchor" href="#用beautifulsoup解析-2"></a> 用BeautifulSoup解析</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">soup = BeautifulSoup(html.text,<span class="string">'html.parser'</span>)</span><br></pre></td></tr></table></figure><h3 id="对网页元素进行选择-2"><a class="markdownIt-Anchor" href="#对网页元素进行选择-2"></a> 对网页元素进行选择</h3><p>我们要爬取的目标是，该电影的影评，最好爬取到尽可能多的内容。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004194838.png" alt="" /></p><p>拟定对图上每一个用户的昵称、评分、时间、评论内容、赞成数进行爬取。</p><p>打开F12工具进行分析，我们发现每一个用户的评论和其相关信息都在一个<code>div</code>标签，<code>class</code>为<code>comment-item</code>的容器（共同点）中。<br /><strong>注：容器是为方便陈述自己拟定的非正式称谓。</strong></p><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004194326.png" alt="" /></p><h3 id="查找标签-3"><a class="markdownIt-Anchor" href="#查找标签-3"></a> 查找标签</h3><p>思路：我们可以先把页面上所有的<strong>容器</strong>选出来，再从每个容器中选取自己想要的信息。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">boxes = soup.find_all(<span class="string">'div'</span>,class_=<span class="string">'comment-item'</span>)</span><br></pre></td></tr></table></figure><p>这样就找到了所有的<strong>容器</strong>，并以列表的形式返回。<br />然后我们<strong>遍历每个容器</strong>，提取自己想要的信息。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> box <span class="keyword">in</span> boxes:</span><br><span class="line">   <span class="comment"># 在box中提取信息</span></span><br></pre></td></tr></table></figure><p>这个时候，每个容器中的内容应类似这样（部分内容被隐去）：</p><details green><summary> <p>容器内容</p> </summary>              <div class='content'>              <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"comment-item "</span> <span class="attr">data-cid</span>=<span class="string">"2455502478"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"comment-item "</span> <span class="attr">data-cid</span>=<span class="string">"2538318284"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"avatar"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">title</span>=<span class="string">"Username"</span> <span class="attr">href</span>=<span class="string">"https://www.douban.com/people/0000000/"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"https://img1.doubanio.com/icon/u0000000-17.jpg"</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"comment"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"comment-vote"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"votes vote-count"</span>&gt;</span>2217<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">input</span> <span class="attr">value</span>=<span class="string">"2538318284"</span> <span class="attr">type</span>=<span class="string">"hidden"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:;"</span> <span class="attr">data-id</span>=<span class="string">"2538318284"</span> <span class="attr">class</span>=<span class="string">"j a_show_login"</span> <span class="attr">onclick</span>=<span class="string">""</span>&gt;</span>有用<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- 删除短评 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"comment-info"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://www.douban.com/people/0000000/"</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span>Username<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span>&gt;</span>看过<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"allstar50 rating"</span> <span class="attr">title</span>=<span class="string">"力荐"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"comment-time "</span> <span class="attr">title</span>=<span class="string">"2020-09-20 20:16:27"</span>&gt;</span></span><br><span class="line">                    2020-09-20</span><br><span class="line">                <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">" comment-content"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">class="short"</span>&gt;</span>徐峥的才华确实被低估了。“乡村教师”这个题材的电影展现出他某个程度的细腻——他很擅长从一个小的切角去展开一个宏大叙题，这样的融合不会过于煽情，却分外让人感动。<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>              </div>            </details><p>然后我们再对<strong>每个容器</strong>进行分析：<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004195144.png" alt="" /></p><h4 id="赞成数"><a class="markdownIt-Anchor" href="#赞成数"></a> 赞成数</h4><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004195424.png" alt="" /></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">box.find(<span class="string">'span'</span>,class_=<span class="string">'votes'</span>)</span><br></pre></td></tr></table></figure><p><strong>注：我们观察到上面的类写的是 class=“votes vote-count”，这不是一个类的名字，而是两个类的名字，也就是说这个span既属于votes也属于vote-count。</strong></p><p>为了提取其中的<strong>正文</strong>，我们加上<code>.text</code>属性。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">box.find(<span class="string">'span'</span>,class_=<span class="string">'votes'</span>).text</span><br></pre></td></tr></table></figure><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004195541.png" alt="" /></p><h4 id="用户名"><a class="markdownIt-Anchor" href="#用户名"></a> 用户名</h4><p>那么如何提取用户名呢？用户名的class为空。和上面提取赞成数类似。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">box.find(<span class="string">'a'</span>,class_=<span class="string">''</span>).text</span><br></pre></td></tr></table></figure><p>但是不建议使用这个方法，似乎是会出现BUG。（这个条件太弱了，满足条件可能不止这一个）<br />所以我们可以采用连续查找的方式，先查找<code>span</code>,<code>class_=&quot;comment-info&quot;</code>，再在里面查找<code>a</code>标签。<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004195830.png" alt="" /></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">box.find(<span class="string">'span'</span>,class_=<span class="string">'comment-info'</span>).find(<span class="string">'a'</span>).text</span><br></pre></td></tr></table></figure><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004195944.png" alt="" /></p><h4 id="评分"><a class="markdownIt-Anchor" href="#评分"></a> 评分</h4><p>关于评分，我们可以在文档中观察到，没有直接的数字或文本来表示，它是用<strong>一个类名来表示</strong>的。<br />所以我们可以想办法获取到这个类名。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">box.find(<span class="string">'span'</span>,class_=<span class="string">'rating'</span>).get(<span class="string">'class'</span>)</span><br></pre></td></tr></table></figure><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004200220.png" alt="" /><br />在上面那个语句后加一个<code>[0]</code>来获取第一个元素，然后把<code>allstar</code>去掉。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">box.find(<span class="string">'span'</span>,class_=<span class="string">'rating'</span>).get(<span class="string">'class'</span>)[<span class="number">0</span>].replace(<span class="string">"allstar"</span>)</span><br></pre></td></tr></table></figure><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004200455.png" alt="" /></p><p>通过观察可知，30其实是三颗星。所以我们可以简单地换算一下。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int(box.find(<span class="string">'span'</span>,class_=<span class="string">'rating'</span>).get(<span class="string">'class'</span>)[<span class="number">0</span>].replace(<span class="string">"allstar"</span>,<span class="string">""</span>))//<span class="number">10</span></span><br></pre></td></tr></table></figure><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004200639.png" alt="" /></p><h4 id="评论内容"><a class="markdownIt-Anchor" href="#评论内容"></a> 评论内容</h4><p>这个也非常简单。<br />只需要：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">box.find(<span class="string">'span'</span>,class_=<span class="string">'short'</span>).text</span><br></pre></td></tr></table></figure><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004200810.png" alt="" /></p><h4 id="时间"><a class="markdownIt-Anchor" href="#时间"></a> 时间</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">box.find(<span class="string">'span'</span>,class_=<span class="string">'comment-time'</span>).text.strip()</span><br><span class="line"><span class="comment">#不使用strip()的话两边会有空格或换行, 用这个方法来去掉这些我们不要的东西。</span></span><br></pre></td></tr></table></figure><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004200953.png" alt="" /></p><hr /><p>也可以从属性中取得更详细的时间。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">box.find(<span class="string">'span'</span>,class_=<span class="string">'comment-time'</span>)[<span class="string">'title'</span>]</span><br></pre></td></tr></table></figure><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004201110.png" alt="" /></p><h3 id="完整代码-2"><a class="markdownIt-Anchor" href="#完整代码-2"></a> 完整代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">headers = &#123;</span><br><span class="line">             <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36'</span>,</span><br><span class="line">            &#125;</span><br><span class="line">html = requests.get(<span class="string">'https://movie.douban.com/subject/35051512/comments?limit=20&amp;status=P&amp;sort=new_score'</span>,headers=headers)</span><br><span class="line">print(html.status_code) <span class="comment"># 返回200即为请求成功</span></span><br><span class="line">print(html.text)  <span class="comment"># html.text 即为我们想要的HTML文档</span></span><br><span class="line">soup = BeautifulSoup(html.text,<span class="string">'html.parser'</span>)</span><br><span class="line">boxes = soup.find_all(<span class="string">'div'</span>,class_=<span class="string">'comment-item'</span>)</span><br><span class="line"><span class="keyword">for</span> box <span class="keyword">in</span> boxes:</span><br><span class="line">    print(<span class="string">"用户名"</span>,box.find(<span class="string">'span'</span>,class_=<span class="string">'comment-info'</span>).find(<span class="string">'a'</span>).text)</span><br><span class="line">    print(<span class="string">"赞成数"</span>,box.find(<span class="string">'span'</span>,class_=<span class="string">'votes'</span>).text)</span><br><span class="line">    print(<span class="string">"时间"</span>,box.find(<span class="string">'span'</span>,class_=<span class="string">'comment-time'</span>).text.strip())</span><br><span class="line">    print(<span class="string">"星数"</span>,int(box.find(<span class="string">'span'</span>,class_=<span class="string">'rating'</span>).get(<span class="string">'class'</span>)[<span class="number">0</span>].replace(<span class="string">"allstar"</span>,<span class="string">""</span>))//<span class="number">10</span>)</span><br><span class="line">    print(<span class="string">"评论内容"</span>,box.find(<span class="string">'span'</span>,class_=<span class="string">'short'</span>).text)</span><br><span class="line">    print(<span class="string">"-"</span>*<span class="number">10</span>) <span class="comment">#分隔符</span></span><br></pre></td></tr></table></figure><p>运行效果如下图所示：<br /><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://gitee.com/zoruasama/Zorua-Pic/raw/master/20201004202132.png" alt="" /></p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/zoruasama/zoruasama.github.io@latest/css/mindmap.css">]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; href=&quot;https://use.fontawesome.com/releases/v5.0.13/css/all.css&quot;&gt;
&lt;h1 id=&quot;总述&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#总述&quot;&gt;
      
    
    </summary>
    
    
      <category term="实训日记" scheme="https://zoruasama.gitee.io/categories/%E5%AE%9E%E8%AE%AD%E6%97%A5%E8%AE%B0/"/>
    
    
      <category term="Python" scheme="https://zoruasama.gitee.io/tags/Python/"/>
    
      <category term="实训" scheme="https://zoruasama.gitee.io/tags/%E5%AE%9E%E8%AE%AD/"/>
    
  </entry>
  
</feed>
